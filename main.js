/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => DailyNewsPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");

// node_modules/@google/generative-ai/dist/index.mjs
var HarmCategory;
(function(HarmCategory2) {
  HarmCategory2["HARM_CATEGORY_UNSPECIFIED"] = "HARM_CATEGORY_UNSPECIFIED";
  HarmCategory2["HARM_CATEGORY_HATE_SPEECH"] = "HARM_CATEGORY_HATE_SPEECH";
  HarmCategory2["HARM_CATEGORY_SEXUALLY_EXPLICIT"] = "HARM_CATEGORY_SEXUALLY_EXPLICIT";
  HarmCategory2["HARM_CATEGORY_HARASSMENT"] = "HARM_CATEGORY_HARASSMENT";
  HarmCategory2["HARM_CATEGORY_DANGEROUS_CONTENT"] = "HARM_CATEGORY_DANGEROUS_CONTENT";
})(HarmCategory || (HarmCategory = {}));
var HarmBlockThreshold;
(function(HarmBlockThreshold2) {
  HarmBlockThreshold2["HARM_BLOCK_THRESHOLD_UNSPECIFIED"] = "HARM_BLOCK_THRESHOLD_UNSPECIFIED";
  HarmBlockThreshold2["BLOCK_LOW_AND_ABOVE"] = "BLOCK_LOW_AND_ABOVE";
  HarmBlockThreshold2["BLOCK_MEDIUM_AND_ABOVE"] = "BLOCK_MEDIUM_AND_ABOVE";
  HarmBlockThreshold2["BLOCK_ONLY_HIGH"] = "BLOCK_ONLY_HIGH";
  HarmBlockThreshold2["BLOCK_NONE"] = "BLOCK_NONE";
})(HarmBlockThreshold || (HarmBlockThreshold = {}));
var HarmProbability;
(function(HarmProbability2) {
  HarmProbability2["HARM_PROBABILITY_UNSPECIFIED"] = "HARM_PROBABILITY_UNSPECIFIED";
  HarmProbability2["NEGLIGIBLE"] = "NEGLIGIBLE";
  HarmProbability2["LOW"] = "LOW";
  HarmProbability2["MEDIUM"] = "MEDIUM";
  HarmProbability2["HIGH"] = "HIGH";
})(HarmProbability || (HarmProbability = {}));
var BlockReason;
(function(BlockReason2) {
  BlockReason2["BLOCKED_REASON_UNSPECIFIED"] = "BLOCKED_REASON_UNSPECIFIED";
  BlockReason2["SAFETY"] = "SAFETY";
  BlockReason2["OTHER"] = "OTHER";
})(BlockReason || (BlockReason = {}));
var FinishReason;
(function(FinishReason2) {
  FinishReason2["FINISH_REASON_UNSPECIFIED"] = "FINISH_REASON_UNSPECIFIED";
  FinishReason2["STOP"] = "STOP";
  FinishReason2["MAX_TOKENS"] = "MAX_TOKENS";
  FinishReason2["SAFETY"] = "SAFETY";
  FinishReason2["RECITATION"] = "RECITATION";
  FinishReason2["OTHER"] = "OTHER";
})(FinishReason || (FinishReason = {}));
var TaskType;
(function(TaskType2) {
  TaskType2["TASK_TYPE_UNSPECIFIED"] = "TASK_TYPE_UNSPECIFIED";
  TaskType2["RETRIEVAL_QUERY"] = "RETRIEVAL_QUERY";
  TaskType2["RETRIEVAL_DOCUMENT"] = "RETRIEVAL_DOCUMENT";
  TaskType2["SEMANTIC_SIMILARITY"] = "SEMANTIC_SIMILARITY";
  TaskType2["CLASSIFICATION"] = "CLASSIFICATION";
  TaskType2["CLUSTERING"] = "CLUSTERING";
})(TaskType || (TaskType = {}));
var GoogleGenerativeAIError = class extends Error {
  constructor(message) {
    super(`[GoogleGenerativeAI Error]: ${message}`);
  }
};
var GoogleGenerativeAIResponseError = class extends GoogleGenerativeAIError {
  constructor(message, response) {
    super(message);
    this.response = response;
  }
};
var BASE_URL = "https://generativelanguage.googleapis.com";
var API_VERSION = "v1";
var PACKAGE_VERSION = "0.1.3";
var PACKAGE_LOG_HEADER = "genai-js";
var Task;
(function(Task2) {
  Task2["GENERATE_CONTENT"] = "generateContent";
  Task2["STREAM_GENERATE_CONTENT"] = "streamGenerateContent";
  Task2["COUNT_TOKENS"] = "countTokens";
  Task2["EMBED_CONTENT"] = "embedContent";
  Task2["BATCH_EMBED_CONTENTS"] = "batchEmbedContents";
})(Task || (Task = {}));
var RequestUrl = class {
  constructor(model, task, apiKey, stream) {
    this.model = model;
    this.task = task;
    this.apiKey = apiKey;
    this.stream = stream;
  }
  toString() {
    let url = `${BASE_URL}/${API_VERSION}/models/${this.model}:${this.task}`;
    if (this.stream) {
      url += "?alt=sse";
    }
    return url;
  }
};
function getClientHeaders() {
  return `${PACKAGE_LOG_HEADER}/${PACKAGE_VERSION}`;
}
async function makeRequest(url, body) {
  let response;
  try {
    response = await fetch(url.toString(), {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-goog-api-client": getClientHeaders(),
        "x-goog-api-key": url.apiKey
      },
      body
    });
    if (!response.ok) {
      let message = "";
      try {
        const json = await response.json();
        message = json.error.message;
        if (json.error.details) {
          message += ` ${JSON.stringify(json.error.details)}`;
        }
      } catch (e) {
      }
      throw new Error(`[${response.status} ${response.statusText}] ${message}`);
    }
  } catch (e) {
    const err = new GoogleGenerativeAIError(`Error fetching from ${url.toString()}: ${e.message}`);
    err.stack = e.stack;
    throw err;
  }
  return response;
}
function addHelpers(response) {
  response.text = () => {
    if (response.candidates && response.candidates.length > 0) {
      if (response.candidates.length > 1) {
        console.warn(`This response had ${response.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`);
      }
      if (hadBadFinishReason(response.candidates[0])) {
        throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(response)}`, response);
      }
      return getText(response);
    } else if (response.promptFeedback) {
      throw new GoogleGenerativeAIResponseError(`Text not available. ${formatBlockErrorMessage(response)}`, response);
    }
    return "";
  };
  return response;
}
function getText(response) {
  var _a, _b, _c, _d;
  if ((_d = (_c = (_b = (_a = response.candidates) === null || _a === void 0 ? void 0 : _a[0].content) === null || _b === void 0 ? void 0 : _b.parts) === null || _c === void 0 ? void 0 : _c[0]) === null || _d === void 0 ? void 0 : _d.text) {
    return response.candidates[0].content.parts[0].text;
  } else {
    return "";
  }
}
var badFinishReasons = [FinishReason.RECITATION, FinishReason.SAFETY];
function hadBadFinishReason(candidate) {
  return !!candidate.finishReason && badFinishReasons.includes(candidate.finishReason);
}
function formatBlockErrorMessage(response) {
  var _a, _b, _c;
  let message = "";
  if ((!response.candidates || response.candidates.length === 0) && response.promptFeedback) {
    message += "Response was blocked";
    if ((_a = response.promptFeedback) === null || _a === void 0 ? void 0 : _a.blockReason) {
      message += ` due to ${response.promptFeedback.blockReason}`;
    }
    if ((_b = response.promptFeedback) === null || _b === void 0 ? void 0 : _b.blockReasonMessage) {
      message += `: ${response.promptFeedback.blockReasonMessage}`;
    }
  } else if ((_c = response.candidates) === null || _c === void 0 ? void 0 : _c[0]) {
    const firstCandidate = response.candidates[0];
    if (hadBadFinishReason(firstCandidate)) {
      message += `Candidate was blocked due to ${firstCandidate.finishReason}`;
      if (firstCandidate.finishMessage) {
        message += `: ${firstCandidate.finishMessage}`;
      }
    }
  }
  return message;
}
function __await(v) {
  return this instanceof __await ? (this.v = v, this) : new __await(v);
}
function __asyncGenerator(thisArg, _arguments, generator) {
  if (!Symbol.asyncIterator)
    throw new TypeError("Symbol.asyncIterator is not defined.");
  var g = generator.apply(thisArg, _arguments || []), i, q = [];
  return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function() {
    return this;
  }, i;
  function verb(n) {
    if (g[n])
      i[n] = function(v) {
        return new Promise(function(a, b) {
          q.push([n, v, a, b]) > 1 || resume(n, v);
        });
      };
  }
  function resume(n, v) {
    try {
      step(g[n](v));
    } catch (e) {
      settle(q[0][3], e);
    }
  }
  function step(r) {
    r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);
  }
  function fulfill(value) {
    resume("next", value);
  }
  function reject(value) {
    resume("throw", value);
  }
  function settle(f, v) {
    if (f(v), q.shift(), q.length)
      resume(q[0][0], q[0][1]);
  }
}
var responseLineRE = /^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;
function processStream(response) {
  const inputStream = response.body.pipeThrough(new TextDecoderStream("utf8", { fatal: true }));
  const responseStream = getResponseStream(inputStream);
  const [stream1, stream2] = responseStream.tee();
  return {
    stream: generateResponseSequence(stream1),
    response: getResponsePromise(stream2)
  };
}
async function getResponsePromise(stream) {
  const allResponses = [];
  const reader = stream.getReader();
  while (true) {
    const { done, value } = await reader.read();
    if (done) {
      return addHelpers(aggregateResponses(allResponses));
    }
    allResponses.push(value);
  }
}
function generateResponseSequence(stream) {
  return __asyncGenerator(this, arguments, function* generateResponseSequence_1() {
    const reader = stream.getReader();
    while (true) {
      const { value, done } = yield __await(reader.read());
      if (done) {
        break;
      }
      yield yield __await(addHelpers(value));
    }
  });
}
function getResponseStream(inputStream) {
  const reader = inputStream.getReader();
  const stream = new ReadableStream({
    start(controller) {
      let currentText = "";
      return pump();
      function pump() {
        return reader.read().then(({ value, done }) => {
          if (done) {
            if (currentText.trim()) {
              controller.error(new GoogleGenerativeAIError("Failed to parse stream"));
              return;
            }
            controller.close();
            return;
          }
          currentText += value;
          let match = currentText.match(responseLineRE);
          let parsedResponse;
          while (match) {
            try {
              parsedResponse = JSON.parse(match[1]);
            } catch (e) {
              controller.error(new GoogleGenerativeAIError(`Error parsing JSON response: "${match[1]}"`));
              return;
            }
            controller.enqueue(parsedResponse);
            currentText = currentText.substring(match[0].length);
            match = currentText.match(responseLineRE);
          }
          return pump();
        });
      }
    }
  });
  return stream;
}
function aggregateResponses(responses) {
  const lastResponse = responses[responses.length - 1];
  const aggregatedResponse = {
    promptFeedback: lastResponse === null || lastResponse === void 0 ? void 0 : lastResponse.promptFeedback
  };
  for (const response of responses) {
    if (response.candidates) {
      for (const candidate of response.candidates) {
        const i = candidate.index;
        if (!aggregatedResponse.candidates) {
          aggregatedResponse.candidates = [];
        }
        if (!aggregatedResponse.candidates[i]) {
          aggregatedResponse.candidates[i] = {
            index: candidate.index
          };
        }
        aggregatedResponse.candidates[i].citationMetadata = candidate.citationMetadata;
        aggregatedResponse.candidates[i].finishReason = candidate.finishReason;
        aggregatedResponse.candidates[i].finishMessage = candidate.finishMessage;
        aggregatedResponse.candidates[i].safetyRatings = candidate.safetyRatings;
        if (candidate.content && candidate.content.parts) {
          if (!aggregatedResponse.candidates[i].content) {
            aggregatedResponse.candidates[i].content = {
              role: candidate.content.role || "user",
              parts: [{ text: "" }]
            };
          }
          for (const part of candidate.content.parts) {
            if (part.text) {
              aggregatedResponse.candidates[i].content.parts[0].text += part.text;
            }
          }
        }
      }
    }
  }
  return aggregatedResponse;
}
async function generateContentStream(apiKey, model, params) {
  const url = new RequestUrl(
    model,
    Task.STREAM_GENERATE_CONTENT,
    apiKey,
    /* stream */
    true
  );
  const response = await makeRequest(url, JSON.stringify(params));
  return processStream(response);
}
async function generateContent(apiKey, model, params) {
  const url = new RequestUrl(
    model,
    Task.GENERATE_CONTENT,
    apiKey,
    /* stream */
    false
  );
  const response = await makeRequest(url, JSON.stringify(params));
  const responseJson = await response.json();
  const enhancedResponse = addHelpers(responseJson);
  return {
    response: enhancedResponse
  };
}
function formatNewContent(request, role) {
  let newParts = [];
  if (typeof request === "string") {
    newParts = [{ text: request }];
  } else {
    for (const partOrString of request) {
      if (typeof partOrString === "string") {
        newParts.push({ text: partOrString });
      } else {
        newParts.push(partOrString);
      }
    }
  }
  return { role, parts: newParts };
}
function formatGenerateContentInput(params) {
  if (params.contents) {
    return params;
  } else {
    const content = formatNewContent(params, "user");
    return { contents: [content] };
  }
}
function formatEmbedContentInput(params) {
  if (typeof params === "string" || Array.isArray(params)) {
    const content = formatNewContent(params, "user");
    return { content };
  }
  return params;
}
var SILENT_ERROR = "SILENT_ERROR";
var ChatSession = class {
  constructor(apiKey, model, params) {
    this.model = model;
    this.params = params;
    this._history = [];
    this._sendPromise = Promise.resolve();
    this._apiKey = apiKey;
    if (params === null || params === void 0 ? void 0 : params.history) {
      this._history = params.history.map((content) => {
        if (!content.role) {
          throw new Error("Missing role for history item: " + JSON.stringify(content));
        }
        return formatNewContent(content.parts, content.role);
      });
    }
  }
  /**
   * Gets the chat history so far. Blocked prompts are not added to history.
   * Blocked candidates are not added to history, nor are the prompts that
   * generated them.
   */
  async getHistory() {
    await this._sendPromise;
    return this._history;
  }
  /**
   * Sends a chat message and receives a non-streaming
   * {@link GenerateContentResult}
   */
  async sendMessage(request) {
    var _a, _b;
    await this._sendPromise;
    const newContent = formatNewContent(request, "user");
    const generateContentRequest = {
      safetySettings: (_a = this.params) === null || _a === void 0 ? void 0 : _a.safetySettings,
      generationConfig: (_b = this.params) === null || _b === void 0 ? void 0 : _b.generationConfig,
      contents: [...this._history, newContent]
    };
    let finalResult;
    this._sendPromise = this._sendPromise.then(() => generateContent(this._apiKey, this.model, generateContentRequest)).then((result) => {
      var _a2;
      if (result.response.candidates && result.response.candidates.length > 0) {
        this._history.push(newContent);
        const responseContent = Object.assign({
          parts: [],
          // Response seems to come back without a role set.
          role: "model"
        }, (_a2 = result.response.candidates) === null || _a2 === void 0 ? void 0 : _a2[0].content);
        this._history.push(responseContent);
      } else {
        const blockErrorMessage = formatBlockErrorMessage(result.response);
        if (blockErrorMessage) {
          console.warn(`sendMessage() was unsuccessful. ${blockErrorMessage}. Inspect response object for details.`);
        }
      }
      finalResult = result;
    });
    await this._sendPromise;
    return finalResult;
  }
  /**
   * Sends a chat message and receives the response as a
   * {@link GenerateContentStreamResult} containing an iterable stream
   * and a response promise.
   */
  async sendMessageStream(request) {
    var _a, _b;
    await this._sendPromise;
    const newContent = formatNewContent(request, "user");
    const generateContentRequest = {
      safetySettings: (_a = this.params) === null || _a === void 0 ? void 0 : _a.safetySettings,
      generationConfig: (_b = this.params) === null || _b === void 0 ? void 0 : _b.generationConfig,
      contents: [...this._history, newContent]
    };
    const streamPromise = generateContentStream(this._apiKey, this.model, generateContentRequest);
    this._sendPromise = this._sendPromise.then(() => streamPromise).catch((_ignored) => {
      throw new Error(SILENT_ERROR);
    }).then((streamResult) => streamResult.response).then((response) => {
      if (response.candidates && response.candidates.length > 0) {
        this._history.push(newContent);
        const responseContent = Object.assign({}, response.candidates[0].content);
        if (!responseContent.role) {
          responseContent.role = "model";
        }
        this._history.push(responseContent);
      } else {
        const blockErrorMessage = formatBlockErrorMessage(response);
        if (blockErrorMessage) {
          console.warn(`sendMessageStream() was unsuccessful. ${blockErrorMessage}. Inspect response object for details.`);
        }
      }
    }).catch((e) => {
      if (e.message !== SILENT_ERROR) {
        console.error(e);
      }
    });
    return streamPromise;
  }
};
async function countTokens(apiKey, model, params) {
  const url = new RequestUrl(model, Task.COUNT_TOKENS, apiKey, false);
  const response = await makeRequest(url, JSON.stringify(Object.assign(Object.assign({}, params), { model })));
  return response.json();
}
async function embedContent(apiKey, model, params) {
  const url = new RequestUrl(model, Task.EMBED_CONTENT, apiKey, false);
  const response = await makeRequest(url, JSON.stringify(params));
  return response.json();
}
async function batchEmbedContents(apiKey, model, params) {
  const url = new RequestUrl(model, Task.BATCH_EMBED_CONTENTS, apiKey, false);
  const requestsWithModel = params.requests.map((request) => {
    return Object.assign(Object.assign({}, request), { model: `models/${model}` });
  });
  const response = await makeRequest(url, JSON.stringify({ requests: requestsWithModel }));
  return response.json();
}
var GenerativeModel = class {
  constructor(apiKey, modelParams) {
    var _a;
    this.apiKey = apiKey;
    if (modelParams.model.startsWith("models/")) {
      this.model = (_a = modelParams.model.split("models/")) === null || _a === void 0 ? void 0 : _a[1];
    } else {
      this.model = modelParams.model;
    }
    this.generationConfig = modelParams.generationConfig || {};
    this.safetySettings = modelParams.safetySettings || [];
  }
  /**
   * Makes a single non-streaming call to the model
   * and returns an object containing a single {@link GenerateContentResponse}.
   */
  async generateContent(request) {
    const formattedParams = formatGenerateContentInput(request);
    return generateContent(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings }, formattedParams));
  }
  /**
   * Makes a single streaming call to the model
   * and returns an object containing an iterable stream that iterates
   * over all chunks in the streaming response as well as
   * a promise that returns the final aggregated response.
   */
  async generateContentStream(request) {
    const formattedParams = formatGenerateContentInput(request);
    return generateContentStream(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings }, formattedParams));
  }
  /**
   * Gets a new {@link ChatSession} instance which can be used for
   * multi-turn chats.
   */
  startChat(startChatParams) {
    return new ChatSession(this.apiKey, this.model, startChatParams);
  }
  /**
   * Counts the tokens in the provided request.
   */
  async countTokens(request) {
    const formattedParams = formatGenerateContentInput(request);
    return countTokens(this.apiKey, this.model, formattedParams);
  }
  /**
   * Embeds the provided content.
   */
  async embedContent(request) {
    const formattedParams = formatEmbedContentInput(request);
    return embedContent(this.apiKey, this.model, formattedParams);
  }
  /**
   * Embeds an array of {@link EmbedContentRequest}s.
   */
  async batchEmbedContents(batchEmbedContentRequest) {
    return batchEmbedContents(this.apiKey, this.model, batchEmbedContentRequest);
  }
};
var GoogleGenerativeAI = class {
  constructor(apiKey) {
    this.apiKey = apiKey;
  }
  /**
   * Gets a {@link GenerativeModel} instance for the provided model name.
   */
  getGenerativeModel(modelParams) {
    if (!modelParams.model) {
      throw new GoogleGenerativeAIError(`Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })`);
    }
    return new GenerativeModel(this.apiKey, modelParams);
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  googleApiKey: "",
  searchEngineId: "",
  geminiApiKey: "",
  topics: ["Technology", "World News"],
  scheduleTime: "08:00",
  archiveFolder: "News Archive",
  news_number: 10,
  // Reduced to stay within API limits
  templatePath: "",
  maxRetries: 3,
  enableNotifications: true,
  sortByDate: true,
  includeMetadata: true,
  maxRetryDelay: 3e4,
  outputFormat: "detailed",
  removeAds: true,
  maxNewsPerTopic: 10,
  highlightKeywords: true,
  commonAdPatterns: [
    "Subscribe to read",
    "Sign up now",
    "Advertisement",
    "Click here to",
    "Special offer",
    "newsletters?\\b",
    "\\[\\d+\\]",
    "\xA9\\s*\\d{4}",
    "cookie",
    "subscribe",
    "sign up",
    "for more information",
    "privacy policy",
    "terms of service",
    "all rights reserved"
  ],
  minSnippetLength: 100,
  excludedDomains: [],
  preferredDomains: [],
  searchDateRange: "d2",
  contentRelevanceScore: 6,
  enableSourceRanking: true,
  searchExactPhrases: [],
  searchExcludeTerms: [],
  useAdvancedFiltering: true,
  conserveApiCalls: true,
  // Default to conserving API calls
  apiCallsPerDay: 100,
  // Default limit
  useEnhancedSearchQueries: true
  // Default to using enhanced queries
};
var QUALITY_NEWS_SOURCES = [
  "nytimes.com",
  "bbc.com",
  "reuters.com",
  "apnews.com",
  "economist.com",
  "wsj.com",
  "ft.com",
  "bloomberg.com",
  "theguardian.com",
  "npr.org",
  "washingtonpost.com",
  "aljazeera.com",
  "nature.com",
  "time.com",
  "wired.com",
  "theatlantic.com",
  "newyorker.com",
  "scientificamerican.com",
  "cnbc.com",
  "fortune.com",
  "techcrunch.com",
  "thenextweb.com",
  "arstechnica.com"
];
var DailyNewsSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Daily News Settings" });
    if (this.plugin.settings.conserveApiCalls) {
      const apiInfo = containerEl.createEl("div", {
        cls: "api-usage-info"
      });
      apiInfo.createEl("p", {
        text: `API Usage Today: ${this.plugin.apiCallsToday}/${this.plugin.settings.apiCallsPerDay} calls`
      });
    }
    const apiSection = containerEl.createEl("div");
    apiSection.createEl("h3", { text: "API Configuration" });
    new import_obsidian.Setting(apiSection).setName("Google API Key").setDesc("Your Google Custom Search API key").addText((text) => text.setPlaceholder("Enter API key").setValue(this.plugin.settings.googleApiKey).onChange(async (value) => {
      this.plugin.settings.googleApiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(apiSection).setName("Search Engine ID").setDesc("Your Google Custom Search Engine ID").addText((text) => text.setPlaceholder("Enter Search Engine ID").setValue(this.plugin.settings.searchEngineId).onChange(async (value) => {
      this.plugin.settings.searchEngineId = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(apiSection).setName("Gemini API Key").setDesc("Your Google Gemini API key").addText((text) => text.setPlaceholder("Enter Gemini API key").setValue(this.plugin.settings.geminiApiKey).onChange(async (value) => {
      this.plugin.settings.geminiApiKey = value;
      await this.plugin.saveSettings();
    }));
    const newsSection = containerEl.createEl("div");
    newsSection.createEl("h3", { text: "Basic News Preferences" });
    new import_obsidian.Setting(newsSection).setName("Schedule Time").setDesc("When to generate daily news (24-hour format)").addText((text) => text.setPlaceholder("HH:MM").setValue(this.plugin.settings.scheduleTime).onChange(async (value) => {
      this.plugin.settings.scheduleTime = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(newsSection).setName("Archive Folder").setDesc("Folder to store daily news notes").addText((text) => text.setPlaceholder("News Archive").setValue(this.plugin.settings.archiveFolder).onChange(async (value) => {
      this.plugin.settings.archiveFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(newsSection).setName("Topics").setDesc("News topics to follow (comma-separated)").addText((text) => text.setPlaceholder("Technology, World News").setValue(this.plugin.settings.topics.join(", ")).onChange(async (value) => {
      this.plugin.settings.topics = value.split(",").map((t) => t.trim());
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(newsSection).setName("Template File").setDesc("Custom template file path (optional)").addText((text) => text.setPlaceholder("templates/news-template.md").setValue(this.plugin.settings.templatePath).onChange(async (value) => {
      this.plugin.settings.templatePath = value;
      await this.plugin.saveSettings();
    }));
    const apiUsageSection = containerEl.createEl("div");
    apiUsageSection.createEl("h3", { text: "API Usage Management" });
    new import_obsidian.Setting(apiUsageSection).setName("Conserve API Calls").setDesc("Enable to limit API calls and prevent quota exhaustion").addToggle((toggle) => toggle.setValue(this.plugin.settings.conserveApiCalls).onChange(async (value) => {
      this.plugin.settings.conserveApiCalls = value;
      await this.plugin.saveSettings();
      this.display();
    }));
    if (this.plugin.settings.conserveApiCalls) {
      new import_obsidian.Setting(apiUsageSection).setName("Daily API Call Limit").setDesc("Maximum number of API calls to make per day").addText((text) => text.setPlaceholder("100").setValue(this.plugin.settings.apiCallsPerDay.toString()).onChange(async (value) => {
        const parsedValue = parseInt(value);
        this.plugin.settings.apiCallsPerDay = isNaN(parsedValue) ? 100 : parsedValue;
        await this.plugin.saveSettings();
      }));
      new import_obsidian.Setting(apiUsageSection).setName("Reset API Counter").setDesc("Reset today's API call counter").addButton((button) => button.setButtonText("Reset Counter").onClick(async () => {
        this.plugin.apiCallsToday = 0;
        this.plugin.updateStatusBar();
        this.display();
        new import_obsidian.Notice("API call counter reset to 0");
      }));
    }
    const searchQualitySection = containerEl.createEl("div");
    searchQualitySection.createEl("h3", { text: "Search Quality" });
    new import_obsidian.Setting(searchQualitySection).setName("Use Enhanced Search Queries").setDesc("Use topic-specific optimized search queries to find better news articles").addToggle((toggle) => toggle.setValue(this.plugin.settings.useEnhancedSearchQueries).onChange(async (value) => {
      this.plugin.settings.useEnhancedSearchQueries = value;
      await this.plugin.saveSettings();
    }));
    const searchSection = containerEl.createEl("div");
    searchSection.createEl("h3", { text: "Advanced Search Settings" });
    new import_obsidian.Setting(searchSection).setName("Search Date Range").setDesc("How far back to search (d1 = 1 day, d2 = 2 days, w1 = 1 week)").addText((text) => text.setPlaceholder("d2").setValue(this.plugin.settings.searchDateRange).onChange(async (value) => {
      this.plugin.settings.searchDateRange = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("News Results Per Topic").setDesc("Maximum number of news results to retrieve per topic (via pagination)").addText((text) => text.setPlaceholder("20").setValue(this.plugin.settings.news_number.toString()).onChange(async (value) => {
      const parsedValue = parseInt(value);
      this.plugin.settings.news_number = isNaN(parsedValue) ? 20 : parsedValue;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Max News Items Per Summary").setDesc("Maximum number of news items to include in the summary").addText((text) => text.setPlaceholder("8").setValue(this.plugin.settings.maxNewsPerTopic.toString()).onChange(async (value) => {
      const parsedValue = parseInt(value);
      this.plugin.settings.maxNewsPerTopic = isNaN(parsedValue) ? 10 : parsedValue;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Minimum Content Length").setDesc("Minimum length for news snippets to be considered").addText((text) => text.setPlaceholder("100").setValue(this.plugin.settings.minSnippetLength.toString()).onChange(async (value) => {
      const parsedValue = parseInt(value);
      this.plugin.settings.minSnippetLength = isNaN(parsedValue) ? 100 : parsedValue;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Preferred Domains").setDesc("Comma-separated list of preferred domains (e.g., nytimes.com, bbc.com)").addText((text) => text.setPlaceholder("nytimes.com, bbc.com").setValue(this.plugin.settings.preferredDomains.join(", ")).onChange(async (value) => {
      this.plugin.settings.preferredDomains = value.split(",").map((d) => d.trim());
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Excluded Domains").setDesc("Comma-separated list of domains to exclude").addText((text) => text.setPlaceholder("pinterest.com, facebook.com").setValue(this.plugin.settings.excludedDomains.join(", ")).onChange(async (value) => {
      this.plugin.settings.excludedDomains = value.split(",").map((d) => d.trim());
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Exact Phrases to Include").setDesc("Comma-separated list of exact phrases to include in search").addText((text) => text.setPlaceholder("latest developments, new research").setValue(this.plugin.settings.searchExactPhrases.join(", ")).onChange(async (value) => {
      this.plugin.settings.searchExactPhrases = value.split(",").map((p) => p.trim());
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Terms to Exclude").setDesc("Comma-separated list of terms to exclude from search").addText((text) => text.setPlaceholder("clickbait, rumor, opinion").setValue(this.plugin.settings.searchExcludeTerms.join(", ")).onChange(async (value) => {
      this.plugin.settings.searchExcludeTerms = value.split(",").map((t) => t.trim());
      await this.plugin.saveSettings();
    }));
    const qualitySection = containerEl.createEl("div");
    qualitySection.createEl("h3", { text: "Content Quality Settings" });
    new import_obsidian.Setting(qualitySection).setName("Enable Advanced Filtering").setDesc("Apply advanced filtering to improve news quality").addToggle((toggle) => toggle.setValue(this.plugin.settings.useAdvancedFiltering).onChange(async (value) => {
      this.plugin.settings.useAdvancedFiltering = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(qualitySection).setName("Enable Source Ranking").setDesc("Prioritize high-quality news sources").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableSourceRanking).onChange(async (value) => {
      this.plugin.settings.enableSourceRanking = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(qualitySection).setName("Minimum Relevance Score").setDesc("Minimum relevance score for news (1-10)").addSlider((slider) => slider.setLimits(1, 10, 1).setValue(this.plugin.settings.contentRelevanceScore).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.contentRelevanceScore = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(qualitySection).setName("Remove Ads and Promotions").setDesc("Clean promotional content from news").addToggle((toggle) => toggle.setValue(this.plugin.settings.removeAds).onChange(async (value) => {
      this.plugin.settings.removeAds = value;
      await this.plugin.saveSettings();
    }));
    const formatSection = containerEl.createEl("div");
    formatSection.createEl("h3", { text: "Output Format" });
    new import_obsidian.Setting(formatSection).setName("Output Style").setDesc("Choose between detailed or concise news format").addDropdown((dropdown) => dropdown.addOption("detailed", "Detailed").addOption("concise", "Concise").setValue(this.plugin.settings.outputFormat).onChange(async (value) => {
      this.plugin.settings.outputFormat = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(formatSection).setName("Highlight Keywords").setDesc("Highlight important terms in the summary").addToggle((toggle) => toggle.setValue(this.plugin.settings.highlightKeywords).onChange(async (value) => {
      this.plugin.settings.highlightKeywords = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(formatSection).setName("Sort News by Date").setDesc("Sort news items by published date").addToggle((toggle) => toggle.setValue(this.plugin.settings.sortByDate).onChange(async (value) => {
      this.plugin.settings.sortByDate = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(formatSection).setName("Include Metadata").setDesc("Include metadata in the generated news").addToggle((toggle) => toggle.setValue(this.plugin.settings.includeMetadata).onChange(async (value) => {
      this.plugin.settings.includeMetadata = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(formatSection).setName("Enable Notifications").setDesc("Show notifications when news is generated").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableNotifications).onChange(async (value) => {
      this.plugin.settings.enableNotifications = value;
      await this.plugin.saveSettings();
    }));
  }
};
var DailyNewsPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.statusBarItem = null;
    this.apiCallsToday = 0;
    this.lastApiCallDate = "";
  }
  async onunload() {
    console.log("Unloading Daily News Plugin");
    if (this.statusBarItem) {
      this.statusBarItem.remove();
    }
  }
  async onload() {
    await this.loadSettings();
    this.loadApiCallCount();
    this.addSettingTab(new DailyNewsSettingTab(this.app, this));
    this.registerInterval(
      window.setInterval(() => this.checkAndGenerateNews(), 6e4)
    );
    this.addCommand({
      id: "generate-news-now",
      name: "Generate News Now",
      callback: async () => {
        new import_obsidian.Notice("Generating news...");
        await this.generateDailyNews();
      }
    });
    this.statusBarItem = this.addStatusBarItem();
    this.updateStatusBar();
  }
  // API call tracking methods
  loadApiCallCount() {
    const today = new Date().toISOString().split("T")[0];
    if (this.lastApiCallDate !== today) {
      this.apiCallsToday = 0;
      this.lastApiCallDate = today;
    }
  }
  incrementApiCallCount() {
    const today = new Date().toISOString().split("T")[0];
    if (this.lastApiCallDate !== today) {
      this.apiCallsToday = 0;
      this.lastApiCallDate = today;
    }
    this.apiCallsToday++;
    this.updateStatusBar();
  }
  // Changed to public so it can be accessed from DailyNewsSettingTab
  updateStatusBar() {
    if (this.statusBarItem) {
      const apiStatus = this.settings.conserveApiCalls ? ` | API: ${this.apiCallsToday}/${this.settings.apiCallsPerDay}` : "";
      this.statusBarItem.setText(`\u{1F4F0} Daily News Ready${apiStatus}`);
    }
  }
  canMakeApiCall() {
    if (!this.settings.conserveApiCalls) {
      return true;
    }
    return this.apiCallsToday < this.settings.apiCallsPerDay;
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async fetchNews(topic) {
    if (!this.canMakeApiCall()) {
      console.log("API call limit reached for today. Skipping search for:", topic);
      new import_obsidian.Notice(`API call limit reached (${this.settings.apiCallsPerDay}/day). Try again tomorrow.`);
      return [];
    }
    let searchQuery = "";
    if (this.settings.useEnhancedSearchQueries) {
      switch (topic.toLowerCase()) {
        case "technology":
          searchQuery = `${topic} news "latest developments" OR "new research" OR "breakthrough" OR "innovation" OR "launch" -old -outdated`;
          break;
        case "world news":
          searchQuery = `${topic} "international relations" OR "global affairs" OR "foreign policy" OR "diplomatic" OR "geopolitical" -speculation -rumor`;
          break;
        case "business":
          searchQuery = `${topic} news "financial results" OR "market trends" OR "earnings" OR "economic data" OR "merger" -speculative`;
          break;
        case "science":
          searchQuery = `${topic} news "discovery" OR "research findings" OR "study results" OR "scientific breakthrough" -preliminary -unconfirmed`;
          break;
        case "health":
          searchQuery = `${topic} news "medical research" OR "health study" OR "clinical trial" OR "treatment breakthrough" -unverified`;
          break;
        default:
          searchQuery = `${topic} news "latest developments" OR "recent events" OR "significant developments" OR "important update"`;
      }
    } else {
      searchQuery = `${topic} news`;
    }
    if (this.settings.searchExactPhrases && this.settings.searchExactPhrases.length > 0) {
      for (const phrase of this.settings.searchExactPhrases) {
        if (phrase.trim()) {
          searchQuery += ` "${phrase.trim()}"`;
        }
      }
    }
    if (this.settings.searchExcludeTerms && this.settings.searchExcludeTerms.length > 0) {
      for (const term of this.settings.searchExcludeTerms) {
        if (term.trim()) {
          searchQuery += ` -${term.trim()}`;
        }
      }
    }
    console.log(`Using search query for ${topic}: ${searchQuery}`);
    const dateRangeParam = this.getOptimizedDateRange();
    const maxResultsPerRequest = 10;
    const totalResultsToFetch = Math.min(100, this.settings.news_number);
    const numRequests = Math.ceil(totalResultsToFetch / maxResultsPerRequest);
    let allNewsItems = [];
    if (this.settings.preferredDomains && this.settings.preferredDomains.length > 0) {
      const highQualityNewsItems = await this.makeSearchRequest(
        searchQuery,
        1,
        dateRangeParam,
        true,
        // prioritize preferred domains
        maxResultsPerRequest
      );
      if (highQualityNewsItems && highQualityNewsItems.length > 0) {
        allNewsItems = [...highQualityNewsItems];
      }
    }
    if (allNewsItems.length < totalResultsToFetch) {
      for (let i = 0; i < numRequests; i++) {
        if (!this.canMakeApiCall()) {
          break;
        }
        const startIndex = i * maxResultsPerRequest + 1;
        const newItems = await this.makeSearchRequest(
          searchQuery,
          startIndex,
          dateRangeParam,
          false,
          maxResultsPerRequest
        );
        if (!newItems || !Array.isArray(newItems)) {
          break;
        }
        for (const item of newItems) {
          if (!allNewsItems.some((existingItem) => existingItem.link === item.link)) {
            allNewsItems.push(item);
          }
        }
        if (allNewsItems.length >= totalResultsToFetch) {
          break;
        }
        if (i < numRequests - 1) {
          await new Promise((resolve) => setTimeout(resolve, 1e3));
        }
      }
    }
    let newsItems = allNewsItems.map((item) => {
      var _a, _b, _c, _d, _e, _f;
      const url = new URL(item.link);
      const domain = url.hostname.replace("www.", "");
      const source = ((_c = (_b = (_a = item.pagemap) == null ? void 0 : _a.metatags) == null ? void 0 : _b[0]) == null ? void 0 : _c.og_site_name) || domain;
      return {
        title: item.title,
        link: item.link,
        snippet: item.snippet,
        publishedTime: (_f = (_e = (_d = item.pagemap) == null ? void 0 : _d.metatags) == null ? void 0 : _e[0]) == null ? void 0 : _f.publishedTime,
        source,
        relevanceScore: this.calculateRelevanceScore(item, topic)
      };
    });
    if (this.settings.useAdvancedFiltering) {
      newsItems = this.applyAdvancedFiltering(newsItems);
    }
    if (newsItems.length === 0 && this.canMakeApiCall()) {
      const broaderQuery = `${topic} news latest`;
      const broaderItems = await this.makeSearchRequest(
        broaderQuery,
        1,
        "w1",
        // Expand to a week to get more results
        false,
        maxResultsPerRequest
      );
      if (broaderItems && broaderItems.length > 0) {
        newsItems = broaderItems.map((item) => {
          var _a, _b, _c, _d, _e, _f;
          const url = new URL(item.link);
          const domain = url.hostname.replace("www.", "");
          const source = ((_c = (_b = (_a = item.pagemap) == null ? void 0 : _a.metatags) == null ? void 0 : _b[0]) == null ? void 0 : _c.og_site_name) || domain;
          return {
            title: item.title,
            link: item.link,
            snippet: item.snippet,
            publishedTime: (_f = (_e = (_d = item.pagemap) == null ? void 0 : _d.metatags) == null ? void 0 : _e[0]) == null ? void 0 : _f.publishedTime,
            source,
            relevanceScore: this.calculateRelevanceScore(item, topic) * 0.8
            // Reduce score slightly for broader results
          };
        });
        newsItems = newsItems.filter((item) => {
          return (item.relevanceScore || 0) >= Math.max(3, this.settings.contentRelevanceScore - 2);
        });
      }
    }
    if (this.settings.enableSourceRanking) {
      newsItems.sort(
        (a, b) => (b.relevanceScore || 0) - (a.relevanceScore || 0)
      );
    } else if (this.settings.sortByDate) {
      newsItems.sort((a, b) => {
        if (!a.publishedTime)
          return 1;
        if (!b.publishedTime)
          return -1;
        return new Date(b.publishedTime).getTime() - new Date(a.publishedTime).getTime();
      });
    }
    return newsItems;
  }
  // Helper methods for news fetching
  async makeSearchRequest(query, startIndex, dateRestrict, prioritizePreferredDomains, numResults) {
    const params = new URLSearchParams({
      key: this.settings.googleApiKey,
      cx: this.settings.searchEngineId,
      q: query,
      num: numResults.toString(),
      dateRestrict,
      fields: "items(title,link,snippet,pagemap/metatags/publishedTime,pagemap/metatags/og_site_name)",
      sort: "date",
      start: startIndex.toString()
    });
    if (prioritizePreferredDomains && this.settings.preferredDomains && this.settings.preferredDomains.length > 0) {
      const sitesQuery = this.settings.preferredDomains.map((domain) => `site:${domain}`).join(" OR ");
      params.set("q", `${params.get("q")} (${sitesQuery})`);
    }
    this.incrementApiCallCount();
    const response = await this.retryOperation(async () => {
      const res = await fetch(
        `https://www.googleapis.com/customsearch/v1?${params.toString()}`
      );
      if (!res.ok) {
        try {
          const errorData = await res.json();
          console.error("API Error Details:", errorData);
          throw new Error(`HTTP error! status: ${res.status}, details: ${JSON.stringify(errorData)}`);
        } catch (parseError) {
          throw new Error(`HTTP error! status: ${res.status}, couldn't parse error details`);
        }
      }
      return res;
    });
    const data = await response.json();
    if (!data || !data.items || data.items.length === 0) {
      return [];
    }
    return data.items;
  }
  getOptimizedDateRange() {
    let dateRange = this.settings.searchDateRange;
    if (!dateRange.match(/^[dw]\d+$/)) {
      dateRange = "d2";
    }
    return dateRange;
  }
  // Enhanced relevance scoring
  calculateRelevanceScore(item, topic) {
    let score = 5;
    const url = new URL(item.link);
    const domain = url.hostname.replace("www.", "");
    if (QUALITY_NEWS_SOURCES.some((source) => domain.includes(source))) {
      score += 3;
    }
    if (/\/article\/|\/story\/|\/news\/|\/\d{4}\/\d{2}\/|[-]\d+\.html$/.test(item.link)) {
      score += 2;
    }
    if (url.pathname.length > 1 && url.pathname !== "/" && !url.pathname.endsWith("/")) {
      score += 1;
    }
    if (url.pathname === "/" || url.pathname === "" || url.pathname.length < 3) {
      score -= 4;
    }
    if (/\/category\/|\/categories\/|\/topics\/|\/sections\/|\/tag\/|\/tags\//.test(item.link)) {
      score -= 3;
    }
    if (item.snippet && item.snippet.length > 200) {
      score += 1;
    }
    if (item.title && item.title.toLowerCase().includes(topic.toLowerCase())) {
      score += 1;
    }
    if (item.snippet) {
      if (/\d+%|\d+ percent|\$\d+|\d+ million|\d+ billion/.test(item.snippet)) {
        score += 2;
      }
      if (/January|February|March|April|May|June|July|August|September|October|November|December \d{1,2}(st|nd|rd|th)?/.test(item.snippet)) {
        score += 1.5;
      }
      if (/"[^"]{10,}"/.test(item.snippet) || /'[^']{10,}'/.test(item.snippet)) {
        score += 1.5;
      }
      if (/reported|announced|revealed|published|released|stated|confirmed|said|according to/i.test(item.snippet)) {
        score += 1;
      }
      if (/provides news|latest news|breaking news|news and information|coverage of|news from|headlines from/i.test(item.snippet) && item.snippet.length < 120) {
        score -= 3;
      }
      if (/is a website|is the official|is an online|website of|homepage of|official site/i.test(item.snippet)) {
        score -= 4;
      }
    }
    if (item.title) {
      if (/you won't believe|shocking|amazing|mind-blowing|incredible|top \d+ ways/i.test(item.title)) {
        score -= 2;
      }
      if (/official website|homepage|welcome to/i.test(item.title)) {
        score -= 3;
      }
    }
    if (!item.snippet || item.snippet.length < this.settings.minSnippetLength) {
      score -= 3;
    }
    if (this.settings.preferredDomains && this.settings.preferredDomains.some((preferredDomain) => domain.includes(preferredDomain))) {
      score += 2;
    }
    if (this.settings.excludedDomains && this.settings.excludedDomains.some((excludedDomain) => domain.includes(excludedDomain))) {
      score -= 4;
    }
    return Math.max(1, Math.min(10, score));
  }
  // Enhanced filtering
  applyAdvancedFiltering(newsItems) {
    return newsItems.filter((item) => {
      const url = new URL(item.link);
      const domain = url.hostname.replace("www.", "");
      if (this.settings.excludedDomains && this.settings.excludedDomains.length > 0) {
        if (this.settings.excludedDomains.some((excluded) => domain.includes(excluded))) {
          return false;
        }
      }
      if (!item.snippet || item.snippet.length < this.settings.minSnippetLength) {
        return false;
      }
      if ((item.relevanceScore || 0) < this.settings.contentRelevanceScore) {
        return false;
      }
      if (item.title && /top \d+|best \d+|\d+ ways|\d+ things|best of|roundup/i.test(item.title)) {
        return false;
      }
      if (url.pathname === "/" || url.pathname === "" || url.pathname.length < 3) {
        return false;
      }
      if (/\/category\/|\/categories\/|\/topics\/|\/sections\/|\/tag\/|\/tags\//.test(item.link)) {
        return false;
      }
      if (item.snippet && /is a website|is the official|is an online|official site of|homepage of/i.test(item.snippet)) {
        return false;
      }
      return true;
    });
  }
  cleanNewsContent(text) {
    if (!this.settings.removeAds)
      return text;
    let cleaned = text;
    this.settings.commonAdPatterns.forEach((pattern) => {
      cleaned = cleaned.replace(new RegExp(pattern, "gi"), "");
    });
    cleaned = cleaned.replace(/https?:\/\/\S+/g, "");
    cleaned = cleaned.replace(/\S+@\S+\.\S+/g, "");
    const fillerPhrases = [
      "click here",
      "read more",
      "learn more",
      "find out more",
      "sign up",
      "subscribe",
      "follow us",
      "share this",
      "according to reports",
      "sources say"
    ];
    fillerPhrases.forEach((phrase) => {
      cleaned = cleaned.replace(new RegExp(phrase, "gi"), "");
    });
    cleaned = cleaned.replace(/\s+/g, " ").trim();
    cleaned = cleaned.replace(/(\n\s*){3,}/g, "\n\n");
    return cleaned;
  }
  // Fallback method for low-quality content
  getFallbackSummary(topic, newsItems) {
    const sampleUrls = newsItems.slice(0, 3).map((item) => {
      const domain = new URL(item.link).hostname.replace("www.", "");
      return `${domain} (${item.title ? item.title.substring(0, 30) + "..." : "No title"})`;
    }).join(", ");
    return `### No Substantial News Content Found

Unfortunately, the search didn't find substantive news articles for "${topic}" today. 

**What was found instead:**
- Generic website listings or landing pages
- Sites that describe themselves rather than providing specific news
- Content that lacks concrete details, quotes, or developments
${sampleUrls ? `- Sample sites checked: ${sampleUrls}` : ""}

**Recommendations to improve results:**
- Try again later when more recent news may be available
- Add specific keywords to your "${topic}" topic, like "${topic} breakthrough" or "${topic} latest research"
- Add high-quality news sources to your Preferred Domains settings
- Adjust the Search Date Range to look back further (e.g., "w1" for one week)

This plugin works best with specific, substantive news rather than general website directories or landing pages.
`;
  }
  // Enhanced prompts for AI summary generation
  getDetailedPrompt(newsText) {
    return `You are a professional news analyst creating a high-quality news briefing. Analyze and summarize these news articles:

${newsText}

CRITICAL GUIDELINES - READ CAREFULLY:
1. Focus ONLY on substantive news with concrete developments
2. Completely IGNORE any generic website listings, simple link compilations, or shallow content
3. EXCLUDE any content that merely mentions a website without actual news (e.g., "News from Site X")
4. NEVER include entries like "RIT highlights news from Rochester Institute of Technology" or "CNET provides product reviews"
5. PRIORITIZE news with specific data, quotes, figures, and developments
6. AVOID vague summaries and instead focus on specific facts and details
7. ANALYZE the implications and context of each significant story
8. INCLUDE only ONE verified, significant news item per bullet point
9. For each news item, include the SOURCE NAME and link in markdown format: [Source Name](URL)
10. Use exact dates rather than relative time references
11. Make each bullet point specific, concrete and informative - avoid generic placeholders
12. Exclude ANY item that only describes what a website does rather than actual news content

IMPORTANT: If the provided articles lack substantive content or are mostly website landing pages, DO NOT create placeholder entries.

WHEN CONTENT IS LIMITED:
1. If ANY substantive article exists with real news, focus entirely on that, even if it's just one item.
2. If only one topic has quality news, it's better to provide in-depth coverage of that topic than to force content for all topics.
3. Look for concrete facts, dates, statistics, and direct quotes - these indicate genuine news rather than website descriptions.

EXAMPLES OF BAD CONTENT TO EXCLUDE:
- "University News: [RIT](https://www.rit.edu/news) highlights news from Rochester Institute of Technology (RIT)."
- "Product Reviews & Tech Coverage: [CNET](https://www.cnet.com/) provides product reviews, tech news, and daily deals."
- "Breaking News: [CNN](https://www.cnn.com/) covers the latest news and headlines."
- "Daily Updates: [BBC](https://www.bbc.com/) delivers international news coverage."

EXAMPLES OF GOOD CONTENT TO INCLUDE:
- "**Quantum Computing Breakthrough**: Researchers at MIT demonstrated a 128-qubit quantum processor achieving quantum advantage in simulating complex molecules on February 25, 2025. [Nature](https://www.nature.com/articles/s41586-025-05742-z)"
- "**Global Trade Impact**: The EU-China trade deficit widened to \u20AC291 billion in 2024, a 24% increase from 2023, according to data released yesterday. [Financial Times](https://www.ft.com/content/3a7b5e9c)"

### Key Developments
[For each significant story - ONLY include items with actual news, NOT descriptions of websites]
- **Title with specific detail**: Concrete fact or development. Include exact figures, data points, and expert quotes when available. [Source](URL)

### Analysis & Context
[Provide context, implications, or background for the most significant story]

### Notable Quotes or Data
[Include a specific quote, statistic, or data point from the news, if available]
`;
  }
  getConcisePrompt(newsText) {
    return `You are a professional news editor creating a concise, high-quality news briefing. Analyze and summarize these news articles:

${newsText}

CRITICAL GUIDELINES - READ CAREFULLY:
1. Focus ONLY on substantive news with concrete developments
2. Completely IGNORE any generic website listings, simple link compilations, or shallow content
3. EXCLUDE any content that merely mentions a website without actual news (e.g., "News from Site X")
4. NEVER include entries like "RIT highlights news from Rochester Institute of Technology" or "CNET provides product reviews"
5. PRIORITIZE news with specific data, quotes, figures, and developments
6. AVOID vague summaries and instead focus on specific facts and details
7. For each news item, include the SOURCE NAME and link in markdown format: [Source Name](URL)
8. Use exact dates rather than relative time references
9. Make each bullet point specific, concrete and informative - avoid generic placeholders
10. Exclude ANY item that only describes what a website does rather than actual news content

IMPORTANT: If the provided articles lack substantive content or are mostly website landing pages, DO NOT create placeholder entries.

WHEN CONTENT IS LIMITED:
1. If ANY substantive article exists with real news, focus entirely on that, even if it's just one item.
2. It's better to provide one genuine news item than multiple generic placeholders.
3. For articles that look like landing pages (no real news content), completely exclude them.

EXAMPLES OF BAD CONTENT TO EXCLUDE:
- "University News: [RIT](https://www.rit.edu/news) highlights news from Rochester Institute of Technology (RIT)."
- "Product Reviews & Tech Coverage: [CNET](https://www.cnet.com/) provides product reviews, tech news, and daily deals."
- "Breaking News: [CNN](https://www.cnn.com/) covers the latest news and headlines."
- "Daily Updates: [BBC](https://www.bbc.com/) delivers international news coverage."

EXAMPLES OF GOOD CONTENT TO INCLUDE:
- "**Apple's AI Integration**: Apple announced integration of GPT-4o across iOS 19 starting next month, impacting 850M devices worldwide. [TechCrunch](https://techcrunch.com/article/apple-gpt4)"
- "**Climate Policy Shift**: The EU Parliament voted 402-157 to increase carbon reduction targets to 65% by 2035, up from the previous 55% goal. [Reuters](https://www.reuters.com/article/eu-climate-vote)"

### Key Updates
- **Specific Development 1**: Concrete details with data points [Source](URL)
- **Specific Development 2**: Concrete details with data points [Source](URL)
- **Specific Development 3**: Concrete details with data points [Source](URL)

### Noteworthy Quote or Data Point
[Most significant quote, metric or statistic with source and context]
`;
  }
  // Enhanced summary generation
  async generateSummary(newsItems) {
    var _a;
    if (!newsItems.length) {
      return "No recent news found for this topic.";
    }
    const processedItems = newsItems.slice(0, this.settings.maxNewsPerTopic).map((item) => ({
      ...item,
      snippet: this.cleanNewsContent(item.snippet)
    }));
    const hasQualityContent = processedItems.some(
      (item) => (item.relevanceScore || 0) >= 7 && item.snippet && item.snippet.length > 120 && !/is a website|is the official|homepage|official site/i.test(item.snippet)
    );
    if (!hasQualityContent && processedItems.length < 3) {
      const topicMatch = (_a = processedItems[0]) == null ? void 0 : _a.link.match(/[?&]q=([^&]+)/);
      const topic = topicMatch ? decodeURIComponent(topicMatch[1]).replace(/\+news.*$/, "") : "this topic";
      return this.getFallbackSummary(topic, processedItems);
    }
    const newsText = processedItems.map(
      (item) => `Title: ${item.title}
Source: ${item.source || "Unknown"}
Published: ${item.publishedTime || "Unknown"}
URL: ${item.link}
Content: ${item.snippet}
Relevance Score: ${item.relevanceScore}/10`
    ).join("\n\n");
    const promptTemplate = this.settings.outputFormat === "detailed" ? this.getDetailedPrompt(newsText) : this.getConcisePrompt(newsText);
    try {
      const genAI = new GoogleGenerativeAI(this.settings.geminiApiKey);
      const model = genAI.getGenerativeModel({ model: "gemini-2.0-flash" });
      const result = await this.retryOperation(
        () => model.generateContent(promptTemplate)
      );
      let summary = result.response.text();
      if (this.settings.highlightKeywords) {
        summary = this.highlightKeywords(summary);
      }
      return summary;
    } catch (error) {
      console.error("Failed to generate summary:", error);
      return `Failed to generate summary due to an error: ${error}

Raw news data:
${newsItems.slice(0, 3).map((item) => `- ${item.title} (${item.link})`).join("\n")}`;
    }
  }
  highlightKeywords(text) {
    const keywords = {
      positive: [
        "launch",
        "grow",
        "success",
        "improve",
        "increase",
        "breakthrough",
        "advance",
        "discovery",
        "achievement",
        "progress",
        "development",
        "innovation"
      ],
      negative: [
        "decline",
        "risk",
        "fail",
        "loss",
        "crisis",
        "downturn",
        "challenge",
        "threat",
        "deficit",
        "recession",
        "setback",
        "conflict"
      ],
      neutral: [
        "announce",
        "report",
        "state",
        "plan",
        "develop",
        "analyze",
        "release",
        "study",
        "research",
        "investigate",
        "examine",
        "evaluate"
      ],
      data: [
        "percent",
        "billion",
        "million",
        "trillion",
        "increase",
        "decrease",
        "growth",
        "reduction",
        "doubled",
        "tripled",
        "halved",
        "statistics"
      ]
    };
    let highlighted = text;
    Object.entries(keywords).forEach(([type, words]) => {
      words.forEach((word) => {
        const regex = new RegExp(`\\b${word}\\w*\\b`, "gi");
        highlighted = highlighted.replace(regex, `**$&**`);
      });
    });
    highlighted = highlighted.replace(/(\$\d+[\d,.]*)|((\d+[\d,.]*%)|(\d+[\d,.]* percent))/gi, "**$&**");
    return highlighted;
  }
  async retryOperation(operation, maxRetries = this.settings.maxRetries) {
    for (let i = 0; i < maxRetries; i++) {
      try {
        return await operation();
      } catch (error) {
        if (i === maxRetries - 1) {
          console.error(`All ${maxRetries} retry attempts failed`);
          throw error;
        }
        const delay = Math.min(1e3 * Math.pow(2, i), this.settings.maxRetryDelay);
        await new Promise((resolve) => setTimeout(resolve, delay));
      }
    }
    throw new Error("Max retries exceeded");
  }
  async checkAndGenerateNews() {
    this.loadApiCallCount();
    const now = new Date();
    const scheduledTime = this.settings.scheduleTime.split(":");
    const targetHour = parseInt(scheduledTime[0]);
    const targetMinute = parseInt(scheduledTime[1]);
    if (now.getHours() === targetHour && now.getMinutes() === targetMinute) {
      await this.generateDailyNews();
    }
  }
  async generateDailyNews() {
    const date = new Date().toISOString().split("T")[0];
    if (this.statusBarItem) {
      this.statusBarItem.setText("\u{1F4F0} Generating News...");
    }
    try {
      let content = await this.getTemplate() || `*Generated at ${new Date().toLocaleTimeString()}*

---

`;
      if (this.settings.conserveApiCalls) {
        content += `*API Usage: ${this.apiCallsToday}/${this.settings.apiCallsPerDay} calls today*

`;
      }
      if (this.settings.outputFormat === "detailed") {
        content += `## Table of Contents

`;
        this.settings.topics.forEach((topic) => {
          content += `- [${topic}](#${topic.toLowerCase().replace(/\s+/g, "%20")})
`;
        });
        content += `
---

`;
      }
      const availableApiCalls = this.settings.apiCallsPerDay - this.apiCallsToday;
      let topicsToProcess = [...this.settings.topics];
      if (this.settings.conserveApiCalls && availableApiCalls < this.settings.topics.length) {
        topicsToProcess = topicsToProcess.slice(0, availableApiCalls);
        content += `> **Note:** Due to API limits, only processing ${topicsToProcess.length} of ${this.settings.topics.length} topics today.

`;
      }
      for (const topic of topicsToProcess) {
        content += `## ${topic}

`;
        if (!this.canMakeApiCall()) {
          content += `*API call limit reached. Skipping this topic.*

`;
          continue;
        }
        const newsItems = await this.fetchNews(topic);
        if (newsItems.length) {
          const summary = await this.generateSummary(newsItems);
          content += summary + "\n\n";
        } else {
          content += `No recent news found for ${topic}

`;
        }
      }
      if (topicsToProcess.length < this.settings.topics.length) {
        content += `## Omitted Topics

`;
        content += `The following topics were omitted due to API call limits:

`;
        const omittedTopics = this.settings.topics.filter((topic) => !topicsToProcess.includes(topic));
        omittedTopics.forEach((topic) => {
          content += `- ${topic}
`;
        });
        content += `
`;
      }
      const fileName = `${this.settings.archiveFolder}/Daily News - ${date}.md`;
      await this.app.vault.create(fileName, content);
      if (this.settings.enableNotifications) {
        new import_obsidian.Notice("Daily news generated successfully");
      }
      if (this.statusBarItem) {
        this.updateStatusBar();
      }
    } catch (error) {
      console.error("Failed to generate news:", error);
      if (this.settings.enableNotifications) {
        new import_obsidian.Notice("Failed to generate news. Check console for details.");
      }
      if (this.statusBarItem) {
        this.statusBarItem.setText("\u{1F4F0} News Error!");
      }
    }
  }
  async getTemplate() {
    if (!this.settings.templatePath)
      return null;
    try {
      const templateFile = this.app.vault.getAbstractFileByPath(this.settings.templatePath);
      if (templateFile instanceof import_obsidian.TFile) {
        return await this.app.vault.read(templateFile);
      }
    } catch (error) {
      console.error("Failed to read template:", error);
    }
    return null;
  }
};
/*! Bundled license information:

@google/generative-ai/dist/index.mjs:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@google/generative-ai/dist/index.mjs:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJub2RlX21vZHVsZXMvQGdvb2dsZS9nZW5lcmF0aXZlLWFpL2Rpc3QvaW5kZXgubWpzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgTm90aWNlLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEdvb2dsZUdlbmVyYXRpdmVBSSB9IGZyb20gXCJAZ29vZ2xlL2dlbmVyYXRpdmUtYWlcIjtcblxuaW50ZXJmYWNlIERhaWx5TmV3c1NldHRpbmdzIHtcbiAgICBnb29nbGVBcGlLZXk6IHN0cmluZztcbiAgICBzZWFyY2hFbmdpbmVJZDogc3RyaW5nO1xuICAgIGdlbWluaUFwaUtleTogc3RyaW5nO1xuICAgIHRvcGljczogc3RyaW5nW107XG4gICAgc2NoZWR1bGVUaW1lOiBzdHJpbmc7XG4gICAgYXJjaGl2ZUZvbGRlcjogc3RyaW5nO1xuICAgIG5ld3NfbnVtYmVyOiBudW1iZXI7XG4gICAgdGVtcGxhdGVQYXRoOiBzdHJpbmc7XG4gICAgbWF4UmV0cmllczogbnVtYmVyO1xuICAgIGVuYWJsZU5vdGlmaWNhdGlvbnM6IGJvb2xlYW47XG4gICAgc29ydEJ5RGF0ZTogYm9vbGVhbjtcbiAgICBpbmNsdWRlTWV0YWRhdGE6IGJvb2xlYW47XG4gICAgbWF4UmV0cnlEZWxheTogbnVtYmVyO1xuICAgIG91dHB1dEZvcm1hdDogJ2RldGFpbGVkJyB8ICdjb25jaXNlJztcbiAgICByZW1vdmVBZHM6IGJvb2xlYW47XG4gICAgbWF4TmV3c1BlclRvcGljOiBudW1iZXI7XG4gICAgaGlnaGxpZ2h0S2V5d29yZHM6IGJvb2xlYW47XG4gICAgY29tbW9uQWRQYXR0ZXJuczogc3RyaW5nW107XG4gICAgbWluU25pcHBldExlbmd0aDogbnVtYmVyO1xuICAgIGV4Y2x1ZGVkRG9tYWluczogc3RyaW5nW107XG4gICAgcHJlZmVycmVkRG9tYWluczogc3RyaW5nW107XG4gICAgc2VhcmNoRGF0ZVJhbmdlOiBzdHJpbmc7XG4gICAgY29udGVudFJlbGV2YW5jZVNjb3JlOiBudW1iZXI7XG4gICAgZW5hYmxlU291cmNlUmFua2luZzogYm9vbGVhbjtcbiAgICBzZWFyY2hFeGFjdFBocmFzZXM6IHN0cmluZ1tdO1xuICAgIHNlYXJjaEV4Y2x1ZGVUZXJtczogc3RyaW5nW107XG4gICAgdXNlQWR2YW5jZWRGaWx0ZXJpbmc6IGJvb2xlYW47XG4gICAgY29uc2VydmVBcGlDYWxsczogYm9vbGVhbjsgLy8gT3B0aW9uIHRvIGNvbnNlcnZlIEFQSSBjYWxsc1xuICAgIGFwaUNhbGxzUGVyRGF5OiBudW1iZXI7IC8vIFNldHRpbmcgdG8gbGltaXQgQVBJIGNhbGxzIHBlciBkYXlcbiAgICB1c2VFbmhhbmNlZFNlYXJjaFF1ZXJpZXM6IGJvb2xlYW47IC8vIE5ldyBvcHRpb24gZm9yIGJldHRlciBzZWFyY2ggcXVlcmllc1xufVxuXG5pbnRlcmZhY2UgTmV3c0l0ZW0ge1xuICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgbGluazogc3RyaW5nO1xuICAgIHNuaXBwZXQ6IHN0cmluZztcbiAgICBwdWJsaXNoZWRUaW1lPzogc3RyaW5nO1xuICAgIHNvdXJjZT86IHN0cmluZztcbiAgICByZWxldmFuY2VTY29yZT86IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIFNlYXJjaEl0ZW0ge1xuICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgbGluazogc3RyaW5nO1xuICAgIHNuaXBwZXQ6IHN0cmluZztcbiAgICBwYWdlbWFwPzoge1xuICAgICAgICBtZXRhdGFncz86IEFycmF5PHtcbiAgICAgICAgICAgIHB1Ymxpc2hlZFRpbWU/OiBzdHJpbmc7XG4gICAgICAgICAgICBvZ19zaXRlX25hbWU/OiBzdHJpbmc7XG4gICAgICAgIH0+O1xuICAgIH07XG59XG5cbmludGVyZmFjZSBDdXN0b21TZWFyY2hSZXNwb25zZSB7XG4gICAgaXRlbXM/OiBTZWFyY2hJdGVtW107XG4gICAgZXJyb3I/OiB7XG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICAgICAgc3RhdHVzOiBzdHJpbmc7XG4gICAgfTtcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogRGFpbHlOZXdzU2V0dGluZ3MgPSB7XG4gICAgZ29vZ2xlQXBpS2V5OiAnJyxcbiAgICBzZWFyY2hFbmdpbmVJZDogJycsXG4gICAgZ2VtaW5pQXBpS2V5OiAnJyxcbiAgICB0b3BpY3M6IFsnVGVjaG5vbG9neScsICdXb3JsZCBOZXdzJ10sXG4gICAgc2NoZWR1bGVUaW1lOiAnMDg6MDAnLFxuICAgIGFyY2hpdmVGb2xkZXI6ICdOZXdzIEFyY2hpdmUnLFxuICAgIG5ld3NfbnVtYmVyOiAxMCwgLy8gUmVkdWNlZCB0byBzdGF5IHdpdGhpbiBBUEkgbGltaXRzXG4gICAgdGVtcGxhdGVQYXRoOiAnJyxcbiAgICBtYXhSZXRyaWVzOiAzLFxuICAgIGVuYWJsZU5vdGlmaWNhdGlvbnM6IHRydWUsXG4gICAgc29ydEJ5RGF0ZTogdHJ1ZSxcbiAgICBpbmNsdWRlTWV0YWRhdGE6IHRydWUsXG4gICAgbWF4UmV0cnlEZWxheTogMzAwMDAsXG4gICAgb3V0cHV0Rm9ybWF0OiAnZGV0YWlsZWQnLFxuICAgIHJlbW92ZUFkczogdHJ1ZSxcbiAgICBtYXhOZXdzUGVyVG9waWM6IDEwLFxuICAgIGhpZ2hsaWdodEtleXdvcmRzOiB0cnVlLFxuICAgIGNvbW1vbkFkUGF0dGVybnM6IFtcbiAgICAgICAgJ1N1YnNjcmliZSB0byByZWFkJyxcbiAgICAgICAgJ1NpZ24gdXAgbm93JyxcbiAgICAgICAgJ0FkdmVydGlzZW1lbnQnLFxuICAgICAgICAnQ2xpY2sgaGVyZSB0bycsXG4gICAgICAgICdTcGVjaWFsIG9mZmVyJyxcbiAgICAgICAgJ25ld3NsZXR0ZXJzP1xcXFxiJyxcbiAgICAgICAgJ1xcXFxbXFxcXGQrXFxcXF0nLFxuICAgICAgICAnXHUwMEE5XFxcXHMqXFxcXGR7NH0nLFxuICAgICAgICAnY29va2llJyxcbiAgICAgICAgJ3N1YnNjcmliZScsXG4gICAgICAgICdzaWduIHVwJyxcbiAgICAgICAgJ2ZvciBtb3JlIGluZm9ybWF0aW9uJyxcbiAgICAgICAgJ3ByaXZhY3kgcG9saWN5JyxcbiAgICAgICAgJ3Rlcm1zIG9mIHNlcnZpY2UnLFxuICAgICAgICAnYWxsIHJpZ2h0cyByZXNlcnZlZCdcbiAgICBdLFxuICAgIG1pblNuaXBwZXRMZW5ndGg6IDEwMCxcbiAgICBleGNsdWRlZERvbWFpbnM6IFtdLFxuICAgIHByZWZlcnJlZERvbWFpbnM6IFtdLFxuICAgIHNlYXJjaERhdGVSYW5nZTogJ2QyJyxcbiAgICBjb250ZW50UmVsZXZhbmNlU2NvcmU6IDYsXG4gICAgZW5hYmxlU291cmNlUmFua2luZzogdHJ1ZSxcbiAgICBzZWFyY2hFeGFjdFBocmFzZXM6IFtdLFxuICAgIHNlYXJjaEV4Y2x1ZGVUZXJtczogW10sXG4gICAgdXNlQWR2YW5jZWRGaWx0ZXJpbmc6IHRydWUsXG4gICAgY29uc2VydmVBcGlDYWxsczogdHJ1ZSwgLy8gRGVmYXVsdCB0byBjb25zZXJ2aW5nIEFQSSBjYWxsc1xuICAgIGFwaUNhbGxzUGVyRGF5OiAxMDAsIC8vIERlZmF1bHQgbGltaXRcbiAgICB1c2VFbmhhbmNlZFNlYXJjaFF1ZXJpZXM6IHRydWUgLy8gRGVmYXVsdCB0byB1c2luZyBlbmhhbmNlZCBxdWVyaWVzXG59XG5cbi8vIFRvcCBuZXdzIHNvdXJjZXMgYnkgcXVhbGl0eS9yZWxpYWJpbGl0eVxuY29uc3QgUVVBTElUWV9ORVdTX1NPVVJDRVMgPSBbXG4gICAgJ255dGltZXMuY29tJywgJ2JiYy5jb20nLCAncmV1dGVycy5jb20nLCAnYXBuZXdzLmNvbScsICdlY29ub21pc3QuY29tJyxcbiAgICAnd3NqLmNvbScsICdmdC5jb20nLCAnYmxvb21iZXJnLmNvbScsICd0aGVndWFyZGlhbi5jb20nLCAnbnByLm9yZycsXG4gICAgJ3dhc2hpbmd0b25wb3N0LmNvbScsICdhbGphemVlcmEuY29tJywgJ25hdHVyZS5jb20nLCAndGltZS5jb20nLCAnd2lyZWQuY29tJyxcbiAgICAndGhlYXRsYW50aWMuY29tJywgJ25ld3lvcmtlci5jb20nLCAnc2NpZW50aWZpY2FtZXJpY2FuLmNvbScsICdjbmJjLmNvbScsXG4gICAgJ2ZvcnR1bmUuY29tJywgJ3RlY2hjcnVuY2guY29tJywgJ3RoZW5leHR3ZWIuY29tJywgJ2Fyc3RlY2huaWNhLmNvbSdcbl07XG5cbi8vIERlZmluZSB0aGUgRGFpbHlOZXdzU2V0dGluZ1RhYiBjbGFzcyBiZWZvcmUgaXQncyB1c2VkXG5jbGFzcyBEYWlseU5ld3NTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBEYWlseU5ld3NQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBEYWlseU5ld3NQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7Y29udGFpbmVyRWx9ID0gdGhpcztcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywge3RleHQ6ICdEYWlseSBOZXdzIFNldHRpbmdzJ30pO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIEFQSSB1c2FnZSBpbmZvIGF0IHRoZSB0b3BcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnNlcnZlQXBpQ2FsbHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGFwaUluZm8gPSBjb250YWluZXJFbC5jcmVhdGVFbCgnZGl2Jywge1xuICAgICAgICAgICAgICAgIGNsczogJ2FwaS11c2FnZS1pbmZvJyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYXBpSW5mby5jcmVhdGVFbCgncCcsIHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBgQVBJIFVzYWdlIFRvZGF5OiAke3RoaXMucGx1Z2luLmFwaUNhbGxzVG9kYXl9LyR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuYXBpQ2FsbHNQZXJEYXl9IGNhbGxzYFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBUEkgY29uZmlndXJhdGlvbiBzZWN0aW9uXG4gICAgICAgIGNvbnN0IGFwaVNlY3Rpb24gPSBjb250YWluZXJFbC5jcmVhdGVFbCgnZGl2Jyk7XG4gICAgICAgIGFwaVNlY3Rpb24uY3JlYXRlRWwoJ2gzJywge3RleHQ6ICdBUEkgQ29uZmlndXJhdGlvbid9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhhcGlTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0dvb2dsZSBBUEkgS2V5JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdZb3VyIEdvb2dsZSBDdXN0b20gU2VhcmNoIEFQSSBrZXknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciBBUEkga2V5JylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ29vZ2xlQXBpS2V5KVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ29vZ2xlQXBpS2V5ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhhcGlTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1NlYXJjaCBFbmdpbmUgSUQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1lvdXIgR29vZ2xlIEN1c3RvbSBTZWFyY2ggRW5naW5lIElEJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRW50ZXIgU2VhcmNoIEVuZ2luZSBJRCcpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNlYXJjaEVuZ2luZUlkKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VhcmNoRW5naW5lSWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGFwaVNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnR2VtaW5pIEFQSSBLZXknKVxuICAgICAgICAgICAgLnNldERlc2MoJ1lvdXIgR29vZ2xlIEdlbWluaSBBUEkga2V5JylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRW50ZXIgR2VtaW5pIEFQSSBrZXknKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW1pbmlBcGlLZXkpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW1pbmlBcGlLZXkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIEJhc2ljIG5ld3MgcHJlZmVyZW5jZXMgc2VjdGlvblxuICAgICAgICBjb25zdCBuZXdzU2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgbmV3c1NlY3Rpb24uY3JlYXRlRWwoJ2gzJywge3RleHQ6ICdCYXNpYyBOZXdzIFByZWZlcmVuY2VzJ30pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKG5ld3NTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1NjaGVkdWxlIFRpbWUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1doZW4gdG8gZ2VuZXJhdGUgZGFpbHkgbmV3cyAoMjQtaG91ciBmb3JtYXQpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignSEg6TU0nKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zY2hlZHVsZVRpbWUpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zY2hlZHVsZVRpbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhuZXdzU2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdBcmNoaXZlIEZvbGRlcicpXG4gICAgICAgICAgICAuc2V0RGVzYygnRm9sZGVyIHRvIHN0b3JlIGRhaWx5IG5ld3Mgbm90ZXMnKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdOZXdzIEFyY2hpdmUnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcmNoaXZlRm9sZGVyKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXJjaGl2ZUZvbGRlciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcobmV3c1NlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnVG9waWNzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdOZXdzIHRvcGljcyB0byBmb2xsb3cgKGNvbW1hLXNlcGFyYXRlZCknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdUZWNobm9sb2d5LCBXb3JsZCBOZXdzJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudG9waWNzLmpvaW4oJywgJykpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50b3BpY3MgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcCh0ID0+IHQudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKG5ld3NTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1RlbXBsYXRlIEZpbGUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0N1c3RvbSB0ZW1wbGF0ZSBmaWxlIHBhdGggKG9wdGlvbmFsKScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3RlbXBsYXRlcy9uZXdzLXRlbXBsYXRlLm1kJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVQYXRoKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVQYXRoID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAvLyBBUEkgVXNhZ2UgTWFuYWdlbWVudCBzZWN0aW9uXG4gICAgICAgIGNvbnN0IGFwaVVzYWdlU2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgYXBpVXNhZ2VTZWN0aW9uLmNyZWF0ZUVsKCdoMycsIHt0ZXh0OiAnQVBJIFVzYWdlIE1hbmFnZW1lbnQnfSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhhcGlVc2FnZVNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnQ29uc2VydmUgQVBJIENhbGxzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdFbmFibGUgdG8gbGltaXQgQVBJIGNhbGxzIGFuZCBwcmV2ZW50IHF1b3RhIGV4aGF1c3Rpb24nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnNlcnZlQXBpQ2FsbHMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb25zZXJ2ZUFwaUNhbGxzID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgLy8gUmVmcmVzaCB0byBzaG93L2hpZGUgdGhlIEFQSSBjYWxscyBzZXR0aW5nXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuY29uc2VydmVBcGlDYWxscykge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcoYXBpVXNhZ2VTZWN0aW9uKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdEYWlseSBBUEkgQ2FsbCBMaW1pdCcpXG4gICAgICAgICAgICAgICAgLnNldERlc2MoJ01heGltdW0gbnVtYmVyIG9mIEFQSSBjYWxscyB0byBtYWtlIHBlciBkYXknKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzEwMCcpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcGlDYWxsc1BlckRheS50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWRWYWx1ZSA9IHBhcnNlSW50KHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmFwaUNhbGxzUGVyRGF5ID0gaXNOYU4ocGFyc2VkVmFsdWUpID8gMTAwIDogcGFyc2VkVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGFwaVVzYWdlU2VjdGlvbilcbiAgICAgICAgICAgICAgICAuc2V0TmFtZSgnUmVzZXQgQVBJIENvdW50ZXInKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKCdSZXNldCB0b2RheVxcJ3MgQVBJIGNhbGwgY291bnRlcicpXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdSZXNldCBDb3VudGVyJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBpQ2FsbHNUb2RheSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnQVBJIGNhbGwgY291bnRlciByZXNldCB0byAwJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNlYXJjaCBRdWFsaXR5IHNlY3Rpb24gKG5ldylcbiAgICAgICAgY29uc3Qgc2VhcmNoUXVhbGl0eVNlY3Rpb24gPSBjb250YWluZXJFbC5jcmVhdGVFbCgnZGl2Jyk7XG4gICAgICAgIHNlYXJjaFF1YWxpdHlTZWN0aW9uLmNyZWF0ZUVsKCdoMycsIHt0ZXh0OiAnU2VhcmNoIFF1YWxpdHknfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoc2VhcmNoUXVhbGl0eVNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnVXNlIEVuaGFuY2VkIFNlYXJjaCBRdWVyaWVzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdVc2UgdG9waWMtc3BlY2lmaWMgb3B0aW1pemVkIHNlYXJjaCBxdWVyaWVzIHRvIGZpbmQgYmV0dGVyIG5ld3MgYXJ0aWNsZXMnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZUVuaGFuY2VkU2VhcmNoUXVlcmllcylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZUVuaGFuY2VkU2VhcmNoUXVlcmllcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZHZhbmNlZCBzZWFyY2ggc2V0dGluZ3NcbiAgICAgICAgY29uc3Qgc2VhcmNoU2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgc2VhcmNoU2VjdGlvbi5jcmVhdGVFbCgnaDMnLCB7dGV4dDogJ0FkdmFuY2VkIFNlYXJjaCBTZXR0aW5ncyd9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhzZWFyY2hTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1NlYXJjaCBEYXRlIFJhbmdlJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdIb3cgZmFyIGJhY2sgdG8gc2VhcmNoIChkMSA9IDEgZGF5LCBkMiA9IDIgZGF5cywgdzEgPSAxIHdlZWspJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignZDInKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWFyY2hEYXRlUmFuZ2UpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWFyY2hEYXRlUmFuZ2UgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnTmV3cyBSZXN1bHRzIFBlciBUb3BpYycpXG4gICAgICAgICAgICAuc2V0RGVzYygnTWF4aW11bSBudW1iZXIgb2YgbmV3cyByZXN1bHRzIHRvIHJldHJpZXZlIHBlciB0b3BpYyAodmlhIHBhZ2luYXRpb24pJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignMjAnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5uZXdzX251bWJlci50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkVmFsdWUgPSBwYXJzZUludCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm5ld3NfbnVtYmVyID0gaXNOYU4ocGFyc2VkVmFsdWUpID8gMjAgOiBwYXJzZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnTWF4IE5ld3MgSXRlbXMgUGVyIFN1bW1hcnknKVxuICAgICAgICAgICAgLnNldERlc2MoJ01heGltdW0gbnVtYmVyIG9mIG5ld3MgaXRlbXMgdG8gaW5jbHVkZSBpbiB0aGUgc3VtbWFyeScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzgnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhOZXdzUGVyVG9waWMudG9TdHJpbmcoKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZFZhbHVlID0gcGFyc2VJbnQodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhOZXdzUGVyVG9waWMgPSBpc05hTihwYXJzZWRWYWx1ZSkgPyAxMCA6IHBhcnNlZFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoc2VhcmNoU2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdNaW5pbXVtIENvbnRlbnQgTGVuZ3RoJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdNaW5pbXVtIGxlbmd0aCBmb3IgbmV3cyBzbmlwcGV0cyB0byBiZSBjb25zaWRlcmVkJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignMTAwJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubWluU25pcHBldExlbmd0aC50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkVmFsdWUgPSBwYXJzZUludCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1pblNuaXBwZXRMZW5ndGggPSBpc05hTihwYXJzZWRWYWx1ZSkgPyAxMDAgOiBwYXJzZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnUHJlZmVycmVkIERvbWFpbnMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0NvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIHByZWZlcnJlZCBkb21haW5zIChlLmcuLCBueXRpbWVzLmNvbSwgYmJjLmNvbSknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdueXRpbWVzLmNvbSwgYmJjLmNvbScpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByZWZlcnJlZERvbWFpbnMuam9pbignLCAnKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByZWZlcnJlZERvbWFpbnMgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcChkID0+IGQudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnRXhjbHVkZWQgRG9tYWlucycpXG4gICAgICAgICAgICAuc2V0RGVzYygnQ29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgZG9tYWlucyB0byBleGNsdWRlJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigncGludGVyZXN0LmNvbSwgZmFjZWJvb2suY29tJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZWREb21haW5zLmpvaW4oJywgJykpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlZERvbWFpbnMgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcChkID0+IGQudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnRXhhY3QgUGhyYXNlcyB0byBJbmNsdWRlJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdDb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBleGFjdCBwaHJhc2VzIHRvIGluY2x1ZGUgaW4gc2VhcmNoJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignbGF0ZXN0IGRldmVsb3BtZW50cywgbmV3IHJlc2VhcmNoJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VhcmNoRXhhY3RQaHJhc2VzLmpvaW4oJywgJykpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWFyY2hFeGFjdFBocmFzZXMgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcChwID0+IHAudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnVGVybXMgdG8gRXhjbHVkZScpXG4gICAgICAgICAgICAuc2V0RGVzYygnQ29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgdGVybXMgdG8gZXhjbHVkZSBmcm9tIHNlYXJjaCcpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2NsaWNrYmFpdCwgcnVtb3IsIG9waW5pb24nKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWFyY2hFeGNsdWRlVGVybXMuam9pbignLCAnKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlYXJjaEV4Y2x1ZGVUZXJtcyA9IHZhbHVlLnNwbGl0KCcsJykubWFwKHQgPT4gdC50cmltKCkpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gQ29udGVudCBxdWFsaXR5IHNldHRpbmdzXG4gICAgICAgIGNvbnN0IHF1YWxpdHlTZWN0aW9uID0gY29udGFpbmVyRWwuY3JlYXRlRWwoJ2RpdicpO1xuICAgICAgICBxdWFsaXR5U2VjdGlvbi5jcmVhdGVFbCgnaDMnLCB7dGV4dDogJ0NvbnRlbnQgUXVhbGl0eSBTZXR0aW5ncyd9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhxdWFsaXR5U2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdFbmFibGUgQWR2YW5jZWQgRmlsdGVyaW5nJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdBcHBseSBhZHZhbmNlZCBmaWx0ZXJpbmcgdG8gaW1wcm92ZSBuZXdzIHF1YWxpdHknKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZUFkdmFuY2VkRmlsdGVyaW5nKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlQWR2YW5jZWRGaWx0ZXJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHF1YWxpdHlTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0VuYWJsZSBTb3VyY2UgUmFua2luZycpXG4gICAgICAgICAgICAuc2V0RGVzYygnUHJpb3JpdGl6ZSBoaWdoLXF1YWxpdHkgbmV3cyBzb3VyY2VzJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVTb3VyY2VSYW5raW5nKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlU291cmNlUmFua2luZyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcocXVhbGl0eVNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnTWluaW11bSBSZWxldmFuY2UgU2NvcmUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ01pbmltdW0gcmVsZXZhbmNlIHNjb3JlIGZvciBuZXdzICgxLTEwKScpXG4gICAgICAgICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcbiAgICAgICAgICAgICAgICAuc2V0TGltaXRzKDEsIDEwLCAxKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50UmVsZXZhbmNlU2NvcmUpXG4gICAgICAgICAgICAgICAgLnNldER5bmFtaWNUb29sdGlwKClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRSZWxldmFuY2VTY29yZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcocXVhbGl0eVNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVtb3ZlIEFkcyBhbmQgUHJvbW90aW9ucycpXG4gICAgICAgICAgICAuc2V0RGVzYygnQ2xlYW4gcHJvbW90aW9uYWwgY29udGVudCBmcm9tIG5ld3MnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZUFkcylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZUFkcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gRm9ybWF0IHNlY3Rpb25cbiAgICAgICAgY29uc3QgZm9ybWF0U2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgZm9ybWF0U2VjdGlvbi5jcmVhdGVFbCgnaDMnLCB7dGV4dDogJ091dHB1dCBGb3JtYXQnfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoZm9ybWF0U2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdPdXRwdXQgU3R5bGUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0Nob29zZSBiZXR3ZWVuIGRldGFpbGVkIG9yIGNvbmNpc2UgbmV3cyBmb3JtYXQnKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignZGV0YWlsZWQnLCAnRGV0YWlsZWQnKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2NvbmNpc2UnLCAnQ29uY2lzZScpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm91dHB1dEZvcm1hdClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiAnZGV0YWlsZWQnIHwgJ2NvbmNpc2UnKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm91dHB1dEZvcm1hdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoZm9ybWF0U2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdIaWdobGlnaHQgS2V5d29yZHMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0hpZ2hsaWdodCBpbXBvcnRhbnQgdGVybXMgaW4gdGhlIHN1bW1hcnknKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZ2hsaWdodEtleXdvcmRzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlnaGxpZ2h0S2V5d29yZHMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGZvcm1hdFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnU29ydCBOZXdzIGJ5IERhdGUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1NvcnQgbmV3cyBpdGVtcyBieSBwdWJsaXNoZWQgZGF0ZScpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydEJ5RGF0ZSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNvcnRCeURhdGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGZvcm1hdFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnSW5jbHVkZSBNZXRhZGF0YScpXG4gICAgICAgICAgICAuc2V0RGVzYygnSW5jbHVkZSBtZXRhZGF0YSBpbiB0aGUgZ2VuZXJhdGVkIG5ld3MnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVNZXRhZGF0YSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVNZXRhZGF0YSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoZm9ybWF0U2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdFbmFibGUgTm90aWZpY2F0aW9ucycpXG4gICAgICAgICAgICAuc2V0RGVzYygnU2hvdyBub3RpZmljYXRpb25zIHdoZW4gbmV3cyBpcyBnZW5lcmF0ZWQnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU5vdGlmaWNhdGlvbnMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVOb3RpZmljYXRpb25zID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERhaWx5TmV3c1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IERhaWx5TmV3c1NldHRpbmdzO1xuICAgIHN0YXR1c0Jhckl0ZW06IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgYXBpQ2FsbHNUb2RheTogbnVtYmVyID0gMDtcbiAgICBsYXN0QXBpQ2FsbERhdGU6IHN0cmluZyA9ICcnO1xuXG4gICAgYXN5bmMgb251bmxvYWQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdVbmxvYWRpbmcgRGFpbHkgTmV3cyBQbHVnaW4nKTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdHVzQmFySXRlbSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIExvYWQgQVBJIGNhbGwgY291bnRcbiAgICAgICAgdGhpcy5sb2FkQXBpQ2FsbENvdW50KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgc2V0dGluZ3MgdGFiXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgRGFpbHlOZXdzU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIC8vIFNjaGVkdWxlIGRhaWx5IG5ld3MgZ2VuZXJhdGlvblxuICAgICAgICB0aGlzLnJlZ2lzdGVySW50ZXJ2YWwoXG4gICAgICAgICAgICB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy5jaGVja0FuZEdlbmVyYXRlTmV3cygpLCA2MDAwMClcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBBZGQgbWFudWFsIHRyaWdnZXIgY29tbWFuZFxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdnZW5lcmF0ZS1uZXdzLW5vdycsXG4gICAgICAgICAgICBuYW1lOiAnR2VuZXJhdGUgTmV3cyBOb3cnLFxuICAgICAgICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdHZW5lcmF0aW5nIG5ld3MuLi4nKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmdlbmVyYXRlRGFpbHlOZXdzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFkZCBzdGF0dXMgYmFyIGl0ZW1cbiAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtID0gdGhpcy5hZGRTdGF0dXNCYXJJdGVtKCk7XG4gICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgfVxuXG4gICAgLy8gQVBJIGNhbGwgdHJhY2tpbmcgbWV0aG9kc1xuICAgIHByaXZhdGUgbG9hZEFwaUNhbGxDb3VudCgpIHtcbiAgICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlc2V0IGNvdW50ZXIgaWYgaXQncyBhIG5ldyBkYXlcbiAgICAgICAgaWYgKHRoaXMubGFzdEFwaUNhbGxEYXRlICE9PSB0b2RheSkge1xuICAgICAgICAgICAgdGhpcy5hcGlDYWxsc1RvZGF5ID0gMDtcbiAgICAgICAgICAgIHRoaXMubGFzdEFwaUNhbGxEYXRlID0gdG9kYXk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBpbmNyZW1lbnRBcGlDYWxsQ291bnQoKSB7XG4gICAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgICAgIFxuICAgICAgICAvLyBSZXNldCBjb3VudGVyIGlmIGl0J3MgYSBuZXcgZGF5XG4gICAgICAgIGlmICh0aGlzLmxhc3RBcGlDYWxsRGF0ZSAhPT0gdG9kYXkpIHtcbiAgICAgICAgICAgIHRoaXMuYXBpQ2FsbHNUb2RheSA9IDA7XG4gICAgICAgICAgICB0aGlzLmxhc3RBcGlDYWxsRGF0ZSA9IHRvZGF5O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aGlzLmFwaUNhbGxzVG9kYXkrKztcbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2hhbmdlZCB0byBwdWJsaWMgc28gaXQgY2FuIGJlIGFjY2Vzc2VkIGZyb20gRGFpbHlOZXdzU2V0dGluZ1RhYlxuICAgIHB1YmxpYyB1cGRhdGVTdGF0dXNCYXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXR1c0Jhckl0ZW0pIHtcbiAgICAgICAgICAgIGNvbnN0IGFwaVN0YXR1cyA9IHRoaXMuc2V0dGluZ3MuY29uc2VydmVBcGlDYWxscyA/IFxuICAgICAgICAgICAgICAgIGAgfCBBUEk6ICR7dGhpcy5hcGlDYWxsc1RvZGF5fS8ke3RoaXMuc2V0dGluZ3MuYXBpQ2FsbHNQZXJEYXl9YCA6ICcnO1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLnNldFRleHQoYFx1RDgzRFx1RENGMCBEYWlseSBOZXdzIFJlYWR5JHthcGlTdGF0dXN9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBjYW5NYWtlQXBpQ2FsbCgpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmNvbnNlcnZlQXBpQ2FsbHMpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5hcGlDYWxsc1RvZGF5IDwgdGhpcy5zZXR0aW5ncy5hcGlDYWxsc1BlckRheTtcbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBhc3luYyBmZXRjaE5ld3ModG9waWM6IHN0cmluZyk6IFByb21pc2U8TmV3c0l0ZW1bXT4ge1xuICAgICAgICAvLyBDaGVjayBpZiB3ZSBjYW4gbWFrZSBBUEkgY2FsbHNcbiAgICAgICAgaWYgKCF0aGlzLmNhbk1ha2VBcGlDYWxsKCkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBUEkgY2FsbCBsaW1pdCByZWFjaGVkIGZvciB0b2RheS4gU2tpcHBpbmcgc2VhcmNoIGZvcjonLCB0b3BpYyk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBBUEkgY2FsbCBsaW1pdCByZWFjaGVkICgke3RoaXMuc2V0dGluZ3MuYXBpQ2FsbHNQZXJEYXl9L2RheSkuIFRyeSBhZ2FpbiB0b21vcnJvdy5gKTtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgYSBtb3JlIHNwZWNpZmljIHNlYXJjaCBxdWVyeSB3aXRoIGJldHRlciBrZXl3b3Jkc1xuICAgICAgICBsZXQgc2VhcmNoUXVlcnkgPSAnJztcbiAgICAgICAgXG4gICAgICAgIC8vIENob29zZSBiZXR3ZWVuIGVuaGFuY2VkIG9yIGJhc2ljIHF1ZXJpZXNcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MudXNlRW5oYW5jZWRTZWFyY2hRdWVyaWVzKSB7XG4gICAgICAgICAgICAvLyBFbmhhbmNlZCB0b3BpYy1zcGVjaWZpYyBzZWFyY2ggcXVlcmllc1xuICAgICAgICAgICAgc3dpdGNoKHRvcGljLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlICd0ZWNobm9sb2d5JzpcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoUXVlcnkgPSBgJHt0b3BpY30gbmV3cyBcImxhdGVzdCBkZXZlbG9wbWVudHNcIiBPUiBcIm5ldyByZXNlYXJjaFwiIE9SIFwiYnJlYWt0aHJvdWdoXCIgT1IgXCJpbm5vdmF0aW9uXCIgT1IgXCJsYXVuY2hcIiAtb2xkIC1vdXRkYXRlZGA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3dvcmxkIG5ld3MnOlxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hRdWVyeSA9IGAke3RvcGljfSBcImludGVybmF0aW9uYWwgcmVsYXRpb25zXCIgT1IgXCJnbG9iYWwgYWZmYWlyc1wiIE9SIFwiZm9yZWlnbiBwb2xpY3lcIiBPUiBcImRpcGxvbWF0aWNcIiBPUiBcImdlb3BvbGl0aWNhbFwiIC1zcGVjdWxhdGlvbiAtcnVtb3JgO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdidXNpbmVzcyc6XG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaFF1ZXJ5ID0gYCR7dG9waWN9IG5ld3MgXCJmaW5hbmNpYWwgcmVzdWx0c1wiIE9SIFwibWFya2V0IHRyZW5kc1wiIE9SIFwiZWFybmluZ3NcIiBPUiBcImVjb25vbWljIGRhdGFcIiBPUiBcIm1lcmdlclwiIC1zcGVjdWxhdGl2ZWA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3NjaWVuY2UnOlxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hRdWVyeSA9IGAke3RvcGljfSBuZXdzIFwiZGlzY292ZXJ5XCIgT1IgXCJyZXNlYXJjaCBmaW5kaW5nc1wiIE9SIFwic3R1ZHkgcmVzdWx0c1wiIE9SIFwic2NpZW50aWZpYyBicmVha3Rocm91Z2hcIiAtcHJlbGltaW5hcnkgLXVuY29uZmlybWVkYDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnaGVhbHRoJzpcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoUXVlcnkgPSBgJHt0b3BpY30gbmV3cyBcIm1lZGljYWwgcmVzZWFyY2hcIiBPUiBcImhlYWx0aCBzdHVkeVwiIE9SIFwiY2xpbmljYWwgdHJpYWxcIiBPUiBcInRyZWF0bWVudCBicmVha3Rocm91Z2hcIiAtdW52ZXJpZmllZGA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaFF1ZXJ5ID0gYCR7dG9waWN9IG5ld3MgXCJsYXRlc3QgZGV2ZWxvcG1lbnRzXCIgT1IgXCJyZWNlbnQgZXZlbnRzXCIgT1IgXCJzaWduaWZpY2FudCBkZXZlbG9wbWVudHNcIiBPUiBcImltcG9ydGFudCB1cGRhdGVcImA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBCYXNpYyBzZWFyY2ggcXVlcnlcbiAgICAgICAgICAgIHNlYXJjaFF1ZXJ5ID0gYCR7dG9waWN9IG5ld3NgO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgZXhhY3QgcGhyYXNlcyBpZiBzcGVjaWZpZWRcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3Muc2VhcmNoRXhhY3RQaHJhc2VzICYmIHRoaXMuc2V0dGluZ3Muc2VhcmNoRXhhY3RQaHJhc2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGhyYXNlIG9mIHRoaXMuc2V0dGluZ3Muc2VhcmNoRXhhY3RQaHJhc2VzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBocmFzZS50cmltKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoUXVlcnkgKz0gYCBcIiR7cGhyYXNlLnRyaW0oKX1cImA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgZXhjbHVkZWQgdGVybXMgaWYgc3BlY2lmaWVkXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnNlYXJjaEV4Y2x1ZGVUZXJtcyAmJiB0aGlzLnNldHRpbmdzLnNlYXJjaEV4Y2x1ZGVUZXJtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHRlcm0gb2YgdGhpcy5zZXR0aW5ncy5zZWFyY2hFeGNsdWRlVGVybXMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGVybS50cmltKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoUXVlcnkgKz0gYCAtJHt0ZXJtLnRyaW0oKX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUubG9nKGBVc2luZyBzZWFyY2ggcXVlcnkgZm9yICR7dG9waWN9OiAke3NlYXJjaFF1ZXJ5fWApO1xuXG4gICAgICAgIC8vIEdldCBkYXRlIHJhbmdlIHBhcmFtZXRlclxuICAgICAgICBjb25zdCBkYXRlUmFuZ2VQYXJhbSA9IHRoaXMuZ2V0T3B0aW1pemVkRGF0ZVJhbmdlKCk7XG5cbiAgICAgICAgLy8gQnVpbGQgc2VhcmNoIHBhcmFtZXRlcnNcbiAgICAgICAgY29uc3QgbWF4UmVzdWx0c1BlclJlcXVlc3QgPSAxMDsgLy8gR29vZ2xlIEFQSSBcdTZCQ0ZcdTZCMjFcdTY3MDBcdTU5MUFcdThGRDRcdTU2REUxMFx1Njc2MVxuICAgICAgICBcbiAgICAgICAgLy8gMS4gXHU0RkVFXHU2NTM5XHU4RkQ5XHU5MUNDXHVGRjFBXHU3OUZCXHU5NjY0XHU0RkREXHU1Qjg4XHU2QTIxXHU1RjBGXHU1MjI0XHU2NUFEXHVGRjBDXHU3NkY0XHU2M0E1XHU0RjdGXHU3NTI4XHU3NTI4XHU2MjM3XHU4QkJFXHU3RjZFXHU3Njg0XHU2NTcwXHU5MUNGXG4gICAgICAgIGNvbnN0IHRvdGFsUmVzdWx0c1RvRmV0Y2ggPSBNYXRoLm1pbigxMDAsIHRoaXMuc2V0dGluZ3MubmV3c19udW1iZXIpOyAvLyBcdTY3MDBcdTU5MUFcdTgzQjdcdTUzRDYxMDBcdTY3NjFcbiAgICAgICAgXG4gICAgICAgIC8vIDIuIFx1OEJBMVx1N0I5N1x1OTcwMFx1ODk4MVx1OEJGN1x1NkM0Mlx1NzY4NFx1NkIyMVx1NjU3MFxuICAgICAgICBjb25zdCBudW1SZXF1ZXN0cyA9IE1hdGguY2VpbCh0b3RhbFJlc3VsdHNUb0ZldGNoIC8gbWF4UmVzdWx0c1BlclJlcXVlc3QpO1xuICAgICAgICBcbiAgICAgICAgLy8gY29uc29sZS5sb2coYFdpbGwgZmV0Y2ggdXAgdG8gJHt0b3RhbFJlc3VsdHNUb0ZldGNofSByZXN1bHRzIGluICR7bnVtUmVxdWVzdHN9IHJlcXVlc3RzIGZvciAke3RvcGljfWApO1xuXG4gICAgICAgIGxldCBhbGxOZXdzSXRlbXM6IFNlYXJjaEl0ZW1bXSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gMy4gXHU1MTQ4XHU4M0I3XHU1M0Q2XHU0RjE4XHU4RDI4XHU2NzY1XHU2RTkwXHU3Njg0XHU3RUQzXHU2NzlDXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnByZWZlcnJlZERvbWFpbnMgJiYgdGhpcy5zZXR0aW5ncy5wcmVmZXJyZWREb21haW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIE1ha2UgYSB0YXJnZXRlZCByZXF1ZXN0IGZvciBoaWdoLXF1YWxpdHkgc291cmNlcyBmaXJzdFxuICAgICAgICAgICAgY29uc3QgaGlnaFF1YWxpdHlOZXdzSXRlbXMgPSBhd2FpdCB0aGlzLm1ha2VTZWFyY2hSZXF1ZXN0KFxuICAgICAgICAgICAgICAgIHNlYXJjaFF1ZXJ5LCBcbiAgICAgICAgICAgICAgICAxLCBcbiAgICAgICAgICAgICAgICBkYXRlUmFuZ2VQYXJhbSwgXG4gICAgICAgICAgICAgICAgdHJ1ZSwgLy8gcHJpb3JpdGl6ZSBwcmVmZXJyZWQgZG9tYWluc1xuICAgICAgICAgICAgICAgIG1heFJlc3VsdHNQZXJSZXF1ZXN0XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoaGlnaFF1YWxpdHlOZXdzSXRlbXMgJiYgaGlnaFF1YWxpdHlOZXdzSXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGFsbE5ld3NJdGVtcyA9IFsuLi5oaWdoUXVhbGl0eU5ld3NJdGVtc107XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYEZvdW5kICR7aGlnaFF1YWxpdHlOZXdzSXRlbXMubGVuZ3RofSBoaWdoLXF1YWxpdHkgaXRlbXMgZm9yICR7dG9waWN9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIDQuIFx1NTk4Mlx1Njc5Q1x1OEZEOFx1OTcwMFx1ODk4MVx1NjZGNFx1NTkxQVx1N0VEM1x1Njc5Q1x1RkYwQ1x1N0VFN1x1N0VFRFx1NTIwNlx1OTg3NVx1ODNCN1x1NTNENlxuICAgICAgICBpZiAoYWxsTmV3c0l0ZW1zLmxlbmd0aCA8IHRvdGFsUmVzdWx0c1RvRmV0Y2gpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbnVtUmVxdWVzdHM7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYW5NYWtlQXBpQ2FsbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBBUEkgY2FsbCBsaW1pdCByZWFjaGVkLiBTdG9wcGluZyBhZnRlciAke2l9IHJlcXVlc3RzIGZvciB0b3BpYzpgLCB0b3BpYyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gaSAqIG1heFJlc3VsdHNQZXJSZXF1ZXN0ICsgMTtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgTWFraW5nIHJlcXVlc3QgJHtpICsgMX0vJHtudW1SZXF1ZXN0c30gZm9yICR7dG9waWN9LCBzdGFydGluZyBhdCBpbmRleCAke3N0YXJ0SW5kZXh9YCk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3SXRlbXMgPSBhd2FpdCB0aGlzLm1ha2VTZWFyY2hSZXF1ZXN0KFxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hRdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgc3RhcnRJbmRleCxcbiAgICAgICAgICAgICAgICAgICAgZGF0ZVJhbmdlUGFyYW0sXG4gICAgICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBtYXhSZXN1bHRzUGVyUmVxdWVzdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gNS4gXHU0RkVFXHU2NTM5XHU4RkQ5XHU5MUNDXHVGRjFBXHU1M0VBXHU2NzA5XHU1RjUzXHU1QjhDXHU1MTY4XHU2Q0ExXHU2NzA5XHU3RUQzXHU2NzlDXHU2NUY2XHU2MjREXHU0RTJEXHU2NUFEXG4gICAgICAgICAgICAgICAgaWYgKCFuZXdJdGVtcyB8fCAhQXJyYXkuaXNBcnJheShuZXdJdGVtcykpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYE5vIHZhbGlkIGl0ZW1zIHJldHVybmVkIGZvciByZXF1ZXN0ICR7aSArIDF9YCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgUmVxdWVzdCAke2kgKyAxfSByZXR1cm5lZCAke25ld0l0ZW1zLmxlbmd0aH0gaXRlbXNgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyA2LiBcdTZERkJcdTUyQTBcdTY1QjBcdTdFRDNcdTY3OUNcdTY1RjZcdTUzQkJcdTkxQ0RcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgbmV3SXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhbGxOZXdzSXRlbXMuc29tZShleGlzdGluZ0l0ZW0gPT4gZXhpc3RpbmdJdGVtLmxpbmsgPT09IGl0ZW0ubGluaykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbE5ld3NJdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYEFkZGVkIG5ldyBpdGVtOiAke2l0ZW0udGl0bGV9YCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gNy4gXHU0RkVFXHU2NTM5XHU4RkQ5XHU5MUNDXHVGRjFBXHU0RjdGXHU3NTI4XHU1QjlFXHU5NjQ1XHU3NkVFXHU2ODA3XHU2NTcwXHU5MUNGXHU1MjI0XHU2NUFEXG4gICAgICAgICAgICAgICAgaWYgKGFsbE5ld3NJdGVtcy5sZW5ndGggPj0gdG90YWxSZXN1bHRzVG9GZXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgUmVhY2hlZCB0YXJnZXQgbnVtYmVyIG9mIGl0ZW1zICgke3RvdGFsUmVzdWx0c1RvRmV0Y2h9KSBmb3IgJHt0b3BpY31gKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFx1NTcyOFx1OEJGN1x1NkM0Mlx1NEU0Qlx1OTVGNFx1NkRGQlx1NTJBMFx1NUVGNlx1OEZERlxuICAgICAgICAgICAgICAgIGlmIChpIDwgbnVtUmVxdWVzdHMgLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBjb25zb2xlLmxvZyhgRm91bmQgdG90YWwgb2YgJHthbGxOZXdzSXRlbXMubGVuZ3RofSBpdGVtcyBmb3IgJHt0b3BpY31gKTtcblxuICAgICAgICAvLyBNYXAgc2VhcmNoIGl0ZW1zIHRvIG5ld3MgaXRlbXMgd2l0aCByaWNoIG1ldGFkYXRhXG4gICAgICAgIGxldCBuZXdzSXRlbXMgPSBhbGxOZXdzSXRlbXMubWFwKChpdGVtOiBTZWFyY2hJdGVtKTogTmV3c0l0ZW0gPT4ge1xuICAgICAgICAgICAgLy8gRXh0cmFjdCBkb21haW4gZnJvbSBVUkxcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoaXRlbS5saW5rKTtcbiAgICAgICAgICAgIGNvbnN0IGRvbWFpbiA9IHVybC5ob3N0bmFtZS5yZXBsYWNlKCd3d3cuJywgJycpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBFeHRyYWN0IHNvdXJjZSBuYW1lIGZyb20gbWV0YWRhdGEgb3IgVVJMXG4gICAgICAgICAgICBjb25zdCBzb3VyY2UgPSBpdGVtLnBhZ2VtYXA/Lm1ldGF0YWdzPy5bMF0/Lm9nX3NpdGVfbmFtZSB8fCBkb21haW47XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGl0bGU6IGl0ZW0udGl0bGUsXG4gICAgICAgICAgICAgICAgbGluazogaXRlbS5saW5rLFxuICAgICAgICAgICAgICAgIHNuaXBwZXQ6IGl0ZW0uc25pcHBldCxcbiAgICAgICAgICAgICAgICBwdWJsaXNoZWRUaW1lOiBpdGVtLnBhZ2VtYXA/Lm1ldGF0YWdzPy5bMF0/LnB1Ymxpc2hlZFRpbWUsXG4gICAgICAgICAgICAgICAgc291cmNlOiBzb3VyY2UsXG4gICAgICAgICAgICAgICAgcmVsZXZhbmNlU2NvcmU6IHRoaXMuY2FsY3VsYXRlUmVsZXZhbmNlU2NvcmUoaXRlbSwgdG9waWMpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBcHBseSBlbmhhbmNlZCBmaWx0ZXJpbmdcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MudXNlQWR2YW5jZWRGaWx0ZXJpbmcpIHtcbiAgICAgICAgICAgIG5ld3NJdGVtcyA9IHRoaXMuYXBwbHlBZHZhbmNlZEZpbHRlcmluZyhuZXdzSXRlbXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgbm8gaXRlbXMgYWZ0ZXIgZmlsdGVyaW5nLCB0cnkgYSBicm9hZGVyIHNlYXJjaFxuICAgICAgICBpZiAobmV3c0l0ZW1zLmxlbmd0aCA9PT0gMCAmJiB0aGlzLmNhbk1ha2VBcGlDYWxsKCkpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBObyBpdGVtcyBhZnRlciBmaWx0ZXJpbmcgZm9yICR7dG9waWN9LiBUcnlpbmcgYnJvYWRlciBzZWFyY2guLi5gKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQnJvYWRlciBzZWFyY2ggd2l0aCBmZXdlciBjb25zdHJhaW50c1xuICAgICAgICAgICAgY29uc3QgYnJvYWRlclF1ZXJ5ID0gYCR7dG9waWN9IG5ld3MgbGF0ZXN0YDtcbiAgICAgICAgICAgIGNvbnN0IGJyb2FkZXJJdGVtcyA9IGF3YWl0IHRoaXMubWFrZVNlYXJjaFJlcXVlc3QoXG4gICAgICAgICAgICAgICAgYnJvYWRlclF1ZXJ5LFxuICAgICAgICAgICAgICAgIDEsXG4gICAgICAgICAgICAgICAgJ3cxJywgLy8gRXhwYW5kIHRvIGEgd2VlayB0byBnZXQgbW9yZSByZXN1bHRzXG4gICAgICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICAgICAgbWF4UmVzdWx0c1BlclJlcXVlc3RcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChicm9hZGVySXRlbXMgJiYgYnJvYWRlckl0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgRm91bmQgJHticm9hZGVySXRlbXMubGVuZ3RofSBpdGVtcyB3aXRoIGJyb2FkZXIgc2VhcmNoIGZvciAke3RvcGljfWApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIG5ld3NJdGVtcyA9IGJyb2FkZXJJdGVtcy5tYXAoKGl0ZW06IFNlYXJjaEl0ZW0pOiBOZXdzSXRlbSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoaXRlbS5saW5rKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZG9tYWluID0gdXJsLmhvc3RuYW1lLnJlcGxhY2UoJ3d3dy4nLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZSA9IGl0ZW0ucGFnZW1hcD8ubWV0YXRhZ3M/LlswXT8ub2dfc2l0ZV9uYW1lIHx8IGRvbWFpbjtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogaXRlbS50aXRsZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpbms6IGl0ZW0ubGluayxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNuaXBwZXQ6IGl0ZW0uc25pcHBldCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHB1Ymxpc2hlZFRpbWU6IGl0ZW0ucGFnZW1hcD8ubWV0YXRhZ3M/LlswXT8ucHVibGlzaGVkVGltZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogc291cmNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVsZXZhbmNlU2NvcmU6IHRoaXMuY2FsY3VsYXRlUmVsZXZhbmNlU2NvcmUoaXRlbSwgdG9waWMpICogMC44IC8vIFJlZHVjZSBzY29yZSBzbGlnaHRseSBmb3IgYnJvYWRlciByZXN1bHRzXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gTGVzcyBhZ2dyZXNzaXZlIGZpbHRlcmluZyBmb3IgYnJvYWRlciBzZWFyY2hcbiAgICAgICAgICAgICAgICBuZXdzSXRlbXMgPSBuZXdzSXRlbXMuZmlsdGVyKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IGZpbHRlciBvdXQgdmVyeSBsb3cgcmVsZXZhbmNlIGl0ZW1zXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAoaXRlbS5yZWxldmFuY2VTY29yZSB8fCAwKSA+PSBNYXRoLm1heCgzLCB0aGlzLnNldHRpbmdzLmNvbnRlbnRSZWxldmFuY2VTY29yZSAtIDIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gU29ydCBieSByZWxldmFuY2Ugb3IgZGF0ZVxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVTb3VyY2VSYW5raW5nKSB7XG4gICAgICAgICAgICAvLyBTb3J0IGJ5IHJlbGV2YW5jZSBzY29yZSBmaXJzdFxuICAgICAgICAgICAgbmV3c0l0ZW1zLnNvcnQoKGE6IE5ld3NJdGVtLCBiOiBOZXdzSXRlbSkgPT4gXG4gICAgICAgICAgICAgICAgKGIucmVsZXZhbmNlU2NvcmUgfHwgMCkgLSAoYS5yZWxldmFuY2VTY29yZSB8fCAwKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNldHRpbmdzLnNvcnRCeURhdGUpIHtcbiAgICAgICAgICAgIC8vIFNvcnQgYnkgcHVibGlzaGVkIGRhdGVcbiAgICAgICAgICAgIG5ld3NJdGVtcy5zb3J0KChhOiBOZXdzSXRlbSwgYjogTmV3c0l0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWEucHVibGlzaGVkVGltZSkgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgaWYgKCFiLnB1Ymxpc2hlZFRpbWUpIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoYi5wdWJsaXNoZWRUaW1lKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShhLnB1Ymxpc2hlZFRpbWUpLmdldFRpbWUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ld3NJdGVtcztcbiAgICB9XG5cbiAgICAvLyBIZWxwZXIgbWV0aG9kcyBmb3IgbmV3cyBmZXRjaGluZ1xuICAgIHByaXZhdGUgYXN5bmMgbWFrZVNlYXJjaFJlcXVlc3QoXG4gICAgICAgIHF1ZXJ5OiBzdHJpbmcsIFxuICAgICAgICBzdGFydEluZGV4OiBudW1iZXIsIFxuICAgICAgICBkYXRlUmVzdHJpY3Q6IHN0cmluZyxcbiAgICAgICAgcHJpb3JpdGl6ZVByZWZlcnJlZERvbWFpbnM6IGJvb2xlYW4sXG4gICAgICAgIG51bVJlc3VsdHM6IG51bWJlclxuICAgICk6IFByb21pc2U8U2VhcmNoSXRlbVtdPiB7XG4gICAgICAgIC8vIEJhc2UgcGFyYW1ldGVycyBmb3IgdGhlIHNlYXJjaCByZXF1ZXN0XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICAgICAga2V5OiB0aGlzLnNldHRpbmdzLmdvb2dsZUFwaUtleSxcbiAgICAgICAgICAgIGN4OiB0aGlzLnNldHRpbmdzLnNlYXJjaEVuZ2luZUlkLFxuICAgICAgICAgICAgcTogcXVlcnksXG4gICAgICAgICAgICBudW06IG51bVJlc3VsdHMudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIGRhdGVSZXN0cmljdDogZGF0ZVJlc3RyaWN0LFxuICAgICAgICAgICAgZmllbGRzOiAnaXRlbXModGl0bGUsbGluayxzbmlwcGV0LHBhZ2VtYXAvbWV0YXRhZ3MvcHVibGlzaGVkVGltZSxwYWdlbWFwL21ldGF0YWdzL29nX3NpdGVfbmFtZSknLFxuICAgICAgICAgICAgc29ydDogJ2RhdGUnLFxuICAgICAgICAgICAgc3RhcnQ6IHN0YXJ0SW5kZXgudG9TdHJpbmcoKVxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBzaXRlOiBvcGVyYXRvciBmb3IgcHJlZmVycmVkIGRvbWFpbnMgaWYgc3BlY2lmaWVkXG4gICAgICAgIGlmIChwcmlvcml0aXplUHJlZmVycmVkRG9tYWlucyAmJiB0aGlzLnNldHRpbmdzLnByZWZlcnJlZERvbWFpbnMgJiYgdGhpcy5zZXR0aW5ncy5wcmVmZXJyZWREb21haW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHNpdGVzUXVlcnkgPSB0aGlzLnNldHRpbmdzLnByZWZlcnJlZERvbWFpbnMubWFwKGRvbWFpbiA9PiBgc2l0ZToke2RvbWFpbn1gKS5qb2luKCcgT1IgJyk7XG4gICAgICAgICAgICBwYXJhbXMuc2V0KCdxJywgYCR7cGFyYW1zLmdldCgncScpfSAoJHtzaXRlc1F1ZXJ5fSlgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gY29uc29sZS5sb2coYE1ha2luZyBBUEkgcmVxdWVzdCB3aXRoIHF1ZXJ5OiAke3BhcmFtcy5nZXQoJ3EnKX1gKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEluY3JlbWVudCBBUEkgY2FsbCBjb3VudGVyXG4gICAgICAgIHRoaXMuaW5jcmVtZW50QXBpQ2FsbENvdW50KCk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMucmV0cnlPcGVyYXRpb24oYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goXG4gICAgICAgICAgICAgICAgYGh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL2N1c3RvbXNlYXJjaC92MT8ke3BhcmFtcy50b1N0cmluZygpfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoIXJlcy5vaykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvciBEZXRhaWxzOicsIGVycm9yRGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Jlcy5zdGF0dXN9LCBkZXRhaWxzOiAke0pTT04uc3RyaW5naWZ5KGVycm9yRGF0YSl9YCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgZXJyb3IhIHN0YXR1czogJHtyZXMuc3RhdHVzfSwgY291bGRuJ3QgcGFyc2UgZXJyb3IgZGV0YWlsc2ApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IGRhdGE6IEN1c3RvbVNlYXJjaFJlc3BvbnNlID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFkYXRhIHx8ICFkYXRhLml0ZW1zIHx8IGRhdGEuaXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgTm8gcmVzdWx0cyBmb3VuZCBmb3IgcXVlcnk6ICR7cGFyYW1zLmdldCgncScpfWApO1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZGF0YS5pdGVtcztcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldE9wdGltaXplZERhdGVSYW5nZSgpOiBzdHJpbmcge1xuICAgICAgICAvLyBTdGFydCB3aXRoIHRoZSB1c2VyLWNvbmZpZ3VyZWQgZGF0ZSByYW5nZVxuICAgICAgICBsZXQgZGF0ZVJhbmdlID0gdGhpcy5zZXR0aW5ncy5zZWFyY2hEYXRlUmFuZ2U7XG4gICAgICAgIFxuICAgICAgICAvLyBJZiBubyB2YWxpZCBkYXRlIHJhbmdlIGlzIHNwZWNpZmllZCwgZGVmYXVsdCB0byB0aGUgcGFzdCAyIGRheXNcbiAgICAgICAgaWYgKCFkYXRlUmFuZ2UubWF0Y2goL15bZHddXFxkKyQvKSkge1xuICAgICAgICAgICAgZGF0ZVJhbmdlID0gJ2QyJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGRhdGVSYW5nZTtcbiAgICB9XG5cbiAgICAvLyBFbmhhbmNlZCByZWxldmFuY2Ugc2NvcmluZ1xuICAgIHByaXZhdGUgY2FsY3VsYXRlUmVsZXZhbmNlU2NvcmUoaXRlbTogU2VhcmNoSXRlbSwgdG9waWM6IHN0cmluZyk6IG51bWJlciB7XG4gICAgICAgIGxldCBzY29yZSA9IDU7IC8vIEJhc2Ugc2NvcmVcbiAgICAgICAgXG4gICAgICAgIC8vIEV4dHJhY3QgZG9tYWluIGFuZCBjaGVjayBpZiBpdCdzIGEgcXVhbGl0eSBzb3VyY2VcbiAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChpdGVtLmxpbmspO1xuICAgICAgICBjb25zdCBkb21haW4gPSB1cmwuaG9zdG5hbWUucmVwbGFjZSgnd3d3LicsICcnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIE1ham9yIGJvb3N0IGZvciBoaWdoLXF1YWxpdHkgc291cmNlc1xuICAgICAgICBpZiAoUVVBTElUWV9ORVdTX1NPVVJDRVMuc29tZShzb3VyY2UgPT4gZG9tYWluLmluY2x1ZGVzKHNvdXJjZSkpKSB7XG4gICAgICAgICAgICBzY29yZSArPSAzO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBmb3IgYXJ0aWNsZS1saWtlIFVSTCBwYXR0ZXJucyAoaGlnaGVyIHF1YWxpdHkgdGhhbiBpbmRleC9jYXRlZ29yeSBwYWdlcylcbiAgICAgICAgaWYgKC9cXC9hcnRpY2xlXFwvfFxcL3N0b3J5XFwvfFxcL25ld3NcXC98XFwvXFxkezR9XFwvXFxkezJ9XFwvfFstXVxcZCtcXC5odG1sJC8udGVzdChpdGVtLmxpbmspKSB7XG4gICAgICAgICAgICBzY29yZSArPSAyO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgVVJMIHBhdHRlcm4gc3VnZ2VzdHMgaXQncyBhbiBhY3R1YWwgYXJ0aWNsZSBhbmQgbm90IGEgaG9tZXBhZ2VcbiAgICAgICAgaWYgKHVybC5wYXRobmFtZS5sZW5ndGggPiAxICYmIHVybC5wYXRobmFtZSAhPT0gXCIvXCIgJiYgIXVybC5wYXRobmFtZS5lbmRzV2l0aChcIi9cIikpIHtcbiAgICAgICAgICAgIHNjb3JlICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFN0cm9uZ2x5IHBlbmFsaXplIG5vbi1hcnRpY2xlIFVSTHNcbiAgICAgICAgaWYgKHVybC5wYXRobmFtZSA9PT0gXCIvXCIgfHwgdXJsLnBhdGhuYW1lID09PSBcIlwiIHx8IHVybC5wYXRobmFtZS5sZW5ndGggPCAzKSB7XG4gICAgICAgICAgICBzY29yZSAtPSA0OyAvLyBIb21lcGFnZSBvciB2ZXJ5IHNob3J0IFVSTCAtIGxpa2VseSBub3QgYW4gYXJ0aWNsZVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBQZW5hbGl6ZSBjYXRlZ29yeSBwYWdlc1xuICAgICAgICBpZiAoL1xcL2NhdGVnb3J5XFwvfFxcL2NhdGVnb3JpZXNcXC98XFwvdG9waWNzXFwvfFxcL3NlY3Rpb25zXFwvfFxcL3RhZ1xcL3xcXC90YWdzXFwvLy50ZXN0KGl0ZW0ubGluaykpIHtcbiAgICAgICAgICAgIHNjb3JlIC09IDM7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFNuaXBwZXQgbGVuZ3RoIChsb25nZXIgb2Z0ZW4gbWVhbnMgbW9yZSBzdWJzdGFudGlhbClcbiAgICAgICAgaWYgKGl0ZW0uc25pcHBldCAmJiBpdGVtLnNuaXBwZXQubGVuZ3RoID4gMjAwKSB7XG4gICAgICAgICAgICBzY29yZSArPSAxO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBUaXRsZSBjb250YWlucyB0b3BpYyBrZXl3b3Jkc1xuICAgICAgICBpZiAoaXRlbS50aXRsZSAmJiBpdGVtLnRpdGxlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModG9waWMudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgICAgICAgIHNjb3JlICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGZvciBtZWFuaW5nZnVsIGNvbnRlbnQgaW5kaWNhdG9ycyAtIGRhdGEsIHF1b3Rlcywgc3BlY2lmaWNpdHlcbiAgICAgICAgaWYgKGl0ZW0uc25pcHBldCkge1xuICAgICAgICAgICAgLy8gQ29udGFpbnMgY29uY3JldGUgZGF0YSBwb2ludHMgKG51bWJlcnMgb2Z0ZW4gaW5kaWNhdGUgc3Vic3RhbmNlKVxuICAgICAgICAgICAgaWYgKC9cXGQrJXxcXGQrIHBlcmNlbnR8XFwkXFxkK3xcXGQrIG1pbGxpb258XFxkKyBiaWxsaW9uLy50ZXN0KGl0ZW0uc25pcHBldCkpIHtcbiAgICAgICAgICAgICAgICBzY29yZSArPSAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDb250YWlucyBzcGVjaWZpYyBkYXRlcyAob2Z0ZW4gaW5kaWNhdGVzIHJlYWwgbmV3cylcbiAgICAgICAgICAgIGlmICgvSmFudWFyeXxGZWJydWFyeXxNYXJjaHxBcHJpbHxNYXl8SnVuZXxKdWx5fEF1Z3VzdHxTZXB0ZW1iZXJ8T2N0b2JlcnxOb3ZlbWJlcnxEZWNlbWJlciBcXGR7MSwyfShzdHxuZHxyZHx0aCk/Ly50ZXN0KGl0ZW0uc25pcHBldCkpIHtcbiAgICAgICAgICAgICAgICBzY29yZSArPSAxLjU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENvbnRhaW5zIHF1b3RlcyAob2Z0ZW4gaW5kaWNhdGVzIGFjdHVhbCByZXBvcnRpbmcpXG4gICAgICAgICAgICBpZiAoL1wiW15cIl17MTAsfVwiLy50ZXN0KGl0ZW0uc25pcHBldCkgfHwgLydbXiddezEwLH0nLy50ZXN0KGl0ZW0uc25pcHBldCkpIHtcbiAgICAgICAgICAgICAgICBzY29yZSArPSAxLjU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENvbnRhaW5zIHJlcG9ydGluZyB2ZXJicyBpbmRpY2F0aW5nIG9yaWdpbmFsIGNvbnRlbnRcbiAgICAgICAgICAgIGlmICgvcmVwb3J0ZWR8YW5ub3VuY2VkfHJldmVhbGVkfHB1Ymxpc2hlZHxyZWxlYXNlZHxzdGF0ZWR8Y29uZmlybWVkfHNhaWR8YWNjb3JkaW5nIHRvL2kudGVzdChpdGVtLnNuaXBwZXQpKSB7XG4gICAgICAgICAgICAgICAgc2NvcmUgKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ29udGFpbnMgdmVyeSBnZW5lcmFsIGRlc2NyaXB0aW9ucyAobGlrZWx5IHNpdGUgZGVzY3JpcHRpb25zLCBub3QgYXJ0aWNsZXMpXG4gICAgICAgICAgICBpZiAoL3Byb3ZpZGVzIG5ld3N8bGF0ZXN0IG5ld3N8YnJlYWtpbmcgbmV3c3xuZXdzIGFuZCBpbmZvcm1hdGlvbnxjb3ZlcmFnZSBvZnxuZXdzIGZyb218aGVhZGxpbmVzIGZyb20vaS50ZXN0KGl0ZW0uc25pcHBldCkgJiYgaXRlbS5zbmlwcGV0Lmxlbmd0aCA8IDEyMCkge1xuICAgICAgICAgICAgICAgIHNjb3JlIC09IDM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIERldGVjdHMgd2Vic2l0ZSBkZXNjcmlwdGlvbnMgcmF0aGVyIHRoYW4gYWN0dWFsIG5ld3NcbiAgICAgICAgICAgIGlmICgvaXMgYSB3ZWJzaXRlfGlzIHRoZSBvZmZpY2lhbHxpcyBhbiBvbmxpbmV8d2Vic2l0ZSBvZnxob21lcGFnZSBvZnxvZmZpY2lhbCBzaXRlL2kudGVzdChpdGVtLnNuaXBwZXQpKSB7XG4gICAgICAgICAgICAgICAgc2NvcmUgLT0gNDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVGl0bGUgaW5kaWNhdG9yc1xuICAgICAgICBpZiAoaXRlbS50aXRsZSkge1xuICAgICAgICAgICAgLy8gVGl0bGUgc2VlbXMgY2xpY2tiYWl0eVxuICAgICAgICAgICAgaWYgKC95b3Ugd29uJ3QgYmVsaWV2ZXxzaG9ja2luZ3xhbWF6aW5nfG1pbmQtYmxvd2luZ3xpbmNyZWRpYmxlfHRvcCBcXGQrIHdheXMvaS50ZXN0KGl0ZW0udGl0bGUpKSB7XG4gICAgICAgICAgICAgICAgc2NvcmUgLT0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gVGl0bGUgaW5kaWNhdGVzIGl0J3MganVzdCBhIHdlYnNpdGUgZGVzY3JpcHRpb25cbiAgICAgICAgICAgIGlmICgvb2ZmaWNpYWwgd2Vic2l0ZXxob21lcGFnZXx3ZWxjb21lIHRvL2kudGVzdChpdGVtLnRpdGxlKSkge1xuICAgICAgICAgICAgICAgIHNjb3JlIC09IDM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFZlcnkgc2hvcnQgc25pcHBldFxuICAgICAgICBpZiAoIWl0ZW0uc25pcHBldCB8fCBpdGVtLnNuaXBwZXQubGVuZ3RoIDwgdGhpcy5zZXR0aW5ncy5taW5TbmlwcGV0TGVuZ3RoKSB7XG4gICAgICAgICAgICBzY29yZSAtPSAzO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBJcyBmcm9tIHByZWZlcnJlZCBkb21haW5zIGxpc3QgKGFkZGl0aW9uYWwgYm9vc3QpXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnByZWZlcnJlZERvbWFpbnMgJiYgXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLnByZWZlcnJlZERvbWFpbnMuc29tZShwcmVmZXJyZWREb21haW4gPT4gZG9tYWluLmluY2x1ZGVzKHByZWZlcnJlZERvbWFpbikpKSB7XG4gICAgICAgICAgICBzY29yZSArPSAyO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBJcyBmcm9tIGV4cGxpY2l0bHkgZXhjbHVkZWQgZG9tYWluc1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5leGNsdWRlZERvbWFpbnMgJiYgXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmV4Y2x1ZGVkRG9tYWlucy5zb21lKGV4Y2x1ZGVkRG9tYWluID0+IGRvbWFpbi5pbmNsdWRlcyhleGNsdWRlZERvbWFpbikpKSB7XG4gICAgICAgICAgICBzY29yZSAtPSA0O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDbGFtcCBzY29yZSBiZXR3ZWVuIDEtMTBcbiAgICAgICAgcmV0dXJuIE1hdGgubWF4KDEsIE1hdGgubWluKDEwLCBzY29yZSkpO1xuICAgIH1cblxuICAgIC8vIEVuaGFuY2VkIGZpbHRlcmluZ1xuICAgIHByaXZhdGUgYXBwbHlBZHZhbmNlZEZpbHRlcmluZyhuZXdzSXRlbXM6IE5ld3NJdGVtW10pOiBOZXdzSXRlbVtdIHtcbiAgICAgICAgcmV0dXJuIG5ld3NJdGVtcy5maWx0ZXIoaXRlbSA9PiB7XG4gICAgICAgICAgICAvLyBHZXQgVVJMIGZvciBwYXRoIGFuYWx5c2lzXG4gICAgICAgICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGl0ZW0ubGluayk7XG4gICAgICAgICAgICBjb25zdCBkb21haW4gPSB1cmwuaG9zdG5hbWUucmVwbGFjZSgnd3d3LicsICcnKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gMS4gQ2hlY2sgZm9yIGV4Y2x1ZGVkIGRvbWFpbnNcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmV4Y2x1ZGVkRG9tYWlucyAmJiB0aGlzLnNldHRpbmdzLmV4Y2x1ZGVkRG9tYWlucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZXhjbHVkZWREb21haW5zLnNvbWUoZXhjbHVkZWQgPT4gZG9tYWluLmluY2x1ZGVzKGV4Y2x1ZGVkKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gMi4gQ2hlY2sgZm9yIG1pbmltdW0gc25pcHBldCBsZW5ndGhcbiAgICAgICAgICAgIGlmICghaXRlbS5zbmlwcGV0IHx8IGl0ZW0uc25pcHBldC5sZW5ndGggPCB0aGlzLnNldHRpbmdzLm1pblNuaXBwZXRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIDMuIENoZWNrIGZvciBtaW5pbXVtIHJlbGV2YW5jZSBzY29yZVxuICAgICAgICAgICAgaWYgKChpdGVtLnJlbGV2YW5jZVNjb3JlIHx8IDApIDwgdGhpcy5zZXR0aW5ncy5jb250ZW50UmVsZXZhbmNlU2NvcmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIDQuIEZpbHRlciBvdXQgb2J2aW91cyBsaXN0IGFydGljbGVzLCBwcm9kdWN0IHJvdW5kdXBzLCBldGMuXG4gICAgICAgICAgICBpZiAoaXRlbS50aXRsZSAmJiAvdG9wIFxcZCt8YmVzdCBcXGQrfFxcZCsgd2F5c3xcXGQrIHRoaW5nc3xiZXN0IG9mfHJvdW5kdXAvaS50ZXN0KGl0ZW0udGl0bGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyA1LiBSZWplY3QgaG9tZXBhZ2UgVVJMcyB0aGF0IGFyZSBsaWtlbHkgbm90IHNwZWNpZmljIGFydGljbGVzXG4gICAgICAgICAgICBpZiAodXJsLnBhdGhuYW1lID09PSBcIi9cIiB8fCB1cmwucGF0aG5hbWUgPT09IFwiXCIgfHwgdXJsLnBhdGhuYW1lLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgRmlsdGVyaW5nIG91dCBob21lcGFnZSBVUkw6ICR7aXRlbS5saW5rfWApO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gNi4gUmVqZWN0IGNhdGVnb3J5L3RhZyBwYWdlc1xuICAgICAgICAgICAgaWYgKC9cXC9jYXRlZ29yeVxcL3xcXC9jYXRlZ29yaWVzXFwvfFxcL3RvcGljc1xcL3xcXC9zZWN0aW9uc1xcL3xcXC90YWdcXC98XFwvdGFnc1xcLy8udGVzdChpdGVtLmxpbmspKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYEZpbHRlcmluZyBvdXQgY2F0ZWdvcnkvdGFnIHBhZ2U6ICR7aXRlbS5saW5rfWApO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gNy4gUmVqZWN0IGNvbnRlbnQgdGhhdCBsb29rcyBsaWtlIHdlYnNpdGUgZGVzY3JpcHRpb25zXG4gICAgICAgICAgICBpZiAoaXRlbS5zbmlwcGV0ICYmIC9pcyBhIHdlYnNpdGV8aXMgdGhlIG9mZmljaWFsfGlzIGFuIG9ubGluZXxvZmZpY2lhbCBzaXRlIG9mfGhvbWVwYWdlIG9mL2kudGVzdChpdGVtLnNuaXBwZXQpKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYEZpbHRlcmluZyBvdXQgd2Vic2l0ZSBkZXNjcmlwdGlvbjogJHtpdGVtLnRpdGxlfWApO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgY2xlYW5OZXdzQ29udGVudCh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3MucmVtb3ZlQWRzKSByZXR1cm4gdGV4dDtcbiAgICAgICAgXG4gICAgICAgIGxldCBjbGVhbmVkID0gdGV4dDtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBhZCBwYXR0ZXJuc1xuICAgICAgICB0aGlzLnNldHRpbmdzLmNvbW1vbkFkUGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICAgICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnJlcGxhY2UobmV3IFJlZ0V4cChwYXR0ZXJuLCAnZ2knKSwgJycpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBVUkxzIGluIHRoZSBtaWRkbGUgb2YgdGV4dFxuICAgICAgICBjbGVhbmVkID0gY2xlYW5lZC5yZXBsYWNlKC9odHRwcz86XFwvXFwvXFxTKy9nLCAnJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBSZW1vdmUgZW1haWwgYWRkcmVzc2VzXG4gICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnJlcGxhY2UoL1xcUytAXFxTK1xcLlxcUysvZywgJycpO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVtb3ZlIGNvbW1vbiBmaWxsZXIgcGhyYXNlc1xuICAgICAgICBjb25zdCBmaWxsZXJQaHJhc2VzID0gW1xuICAgICAgICAgICAgJ2NsaWNrIGhlcmUnLCAncmVhZCBtb3JlJywgJ2xlYXJuIG1vcmUnLCAnZmluZCBvdXQgbW9yZScsXG4gICAgICAgICAgICAnc2lnbiB1cCcsICdzdWJzY3JpYmUnLCAnZm9sbG93IHVzJywgJ3NoYXJlIHRoaXMnLFxuICAgICAgICAgICAgJ2FjY29yZGluZyB0byByZXBvcnRzJywgJ3NvdXJjZXMgc2F5J1xuICAgICAgICBdO1xuICAgICAgICBcbiAgICAgICAgZmlsbGVyUGhyYXNlcy5mb3JFYWNoKHBocmFzZSA9PiB7XG4gICAgICAgICAgICBjbGVhbmVkID0gY2xlYW5lZC5yZXBsYWNlKG5ldyBSZWdFeHAocGhyYXNlLCAnZ2knKSwgJycpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBleGNlc3Mgd2hpdGVzcGFjZVxuICAgICAgICBjbGVhbmVkID0gY2xlYW5lZC5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpO1xuICAgICAgICBjbGVhbmVkID0gY2xlYW5lZC5yZXBsYWNlKC8oXFxuXFxzKil7Myx9L2csICdcXG5cXG4nKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBjbGVhbmVkO1xuICAgIH1cblxuICAgIC8vIEZhbGxiYWNrIG1ldGhvZCBmb3IgbG93LXF1YWxpdHkgY29udGVudFxuICAgIHByaXZhdGUgZ2V0RmFsbGJhY2tTdW1tYXJ5KHRvcGljOiBzdHJpbmcsIG5ld3NJdGVtczogTmV3c0l0ZW1bXSk6IHN0cmluZyB7XG4gICAgICAgIC8vIEdldCBqdXN0IGEgYnJpZWYgc25pcHBldCBvZiB3aGF0IHdlIGZvdW5kIHRvIGhlbHAgdGhlIHVzZXIgdW5kZXJzdGFuZCB0aGUgaXNzdWVcbiAgICAgICAgY29uc3Qgc2FtcGxlVXJscyA9IG5ld3NJdGVtcy5zbGljZSgwLCAzKS5tYXAoaXRlbSA9PiB7XG4gICAgICAgICAgICBjb25zdCBkb21haW4gPSBuZXcgVVJMKGl0ZW0ubGluaykuaG9zdG5hbWUucmVwbGFjZSgnd3d3LicsICcnKTtcbiAgICAgICAgICAgIHJldHVybiBgJHtkb21haW59ICgke2l0ZW0udGl0bGUgPyBpdGVtLnRpdGxlLnN1YnN0cmluZygwLCAzMCkgKyAnLi4uJyA6ICdObyB0aXRsZSd9KWA7XG4gICAgICAgIH0pLmpvaW4oJywgJyk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gYCMjIyBObyBTdWJzdGFudGlhbCBOZXdzIENvbnRlbnQgRm91bmRcblxuVW5mb3J0dW5hdGVseSwgdGhlIHNlYXJjaCBkaWRuJ3QgZmluZCBzdWJzdGFudGl2ZSBuZXdzIGFydGljbGVzIGZvciBcIiR7dG9waWN9XCIgdG9kYXkuIFxuXG4qKldoYXQgd2FzIGZvdW5kIGluc3RlYWQ6Kipcbi0gR2VuZXJpYyB3ZWJzaXRlIGxpc3RpbmdzIG9yIGxhbmRpbmcgcGFnZXNcbi0gU2l0ZXMgdGhhdCBkZXNjcmliZSB0aGVtc2VsdmVzIHJhdGhlciB0aGFuIHByb3ZpZGluZyBzcGVjaWZpYyBuZXdzXG4tIENvbnRlbnQgdGhhdCBsYWNrcyBjb25jcmV0ZSBkZXRhaWxzLCBxdW90ZXMsIG9yIGRldmVsb3BtZW50c1xuJHtzYW1wbGVVcmxzID8gYC0gU2FtcGxlIHNpdGVzIGNoZWNrZWQ6ICR7c2FtcGxlVXJsc31gIDogJyd9XG5cbioqUmVjb21tZW5kYXRpb25zIHRvIGltcHJvdmUgcmVzdWx0czoqKlxuLSBUcnkgYWdhaW4gbGF0ZXIgd2hlbiBtb3JlIHJlY2VudCBuZXdzIG1heSBiZSBhdmFpbGFibGVcbi0gQWRkIHNwZWNpZmljIGtleXdvcmRzIHRvIHlvdXIgXCIke3RvcGljfVwiIHRvcGljLCBsaWtlIFwiJHt0b3BpY30gYnJlYWt0aHJvdWdoXCIgb3IgXCIke3RvcGljfSBsYXRlc3QgcmVzZWFyY2hcIlxuLSBBZGQgaGlnaC1xdWFsaXR5IG5ld3Mgc291cmNlcyB0byB5b3VyIFByZWZlcnJlZCBEb21haW5zIHNldHRpbmdzXG4tIEFkanVzdCB0aGUgU2VhcmNoIERhdGUgUmFuZ2UgdG8gbG9vayBiYWNrIGZ1cnRoZXIgKGUuZy4sIFwidzFcIiBmb3Igb25lIHdlZWspXG5cblRoaXMgcGx1Z2luIHdvcmtzIGJlc3Qgd2l0aCBzcGVjaWZpYywgc3Vic3RhbnRpdmUgbmV3cyByYXRoZXIgdGhhbiBnZW5lcmFsIHdlYnNpdGUgZGlyZWN0b3JpZXMgb3IgbGFuZGluZyBwYWdlcy5cbmA7XG4gICAgfVxuXG4gICAgLy8gRW5oYW5jZWQgcHJvbXB0cyBmb3IgQUkgc3VtbWFyeSBnZW5lcmF0aW9uXG4gICAgcHJpdmF0ZSBnZXREZXRhaWxlZFByb21wdChuZXdzVGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGBZb3UgYXJlIGEgcHJvZmVzc2lvbmFsIG5ld3MgYW5hbHlzdCBjcmVhdGluZyBhIGhpZ2gtcXVhbGl0eSBuZXdzIGJyaWVmaW5nLiBBbmFseXplIGFuZCBzdW1tYXJpemUgdGhlc2UgbmV3cyBhcnRpY2xlczpcblxuJHtuZXdzVGV4dH1cblxuQ1JJVElDQUwgR1VJREVMSU5FUyAtIFJFQUQgQ0FSRUZVTExZOlxuMS4gRm9jdXMgT05MWSBvbiBzdWJzdGFudGl2ZSBuZXdzIHdpdGggY29uY3JldGUgZGV2ZWxvcG1lbnRzXG4yLiBDb21wbGV0ZWx5IElHTk9SRSBhbnkgZ2VuZXJpYyB3ZWJzaXRlIGxpc3RpbmdzLCBzaW1wbGUgbGluayBjb21waWxhdGlvbnMsIG9yIHNoYWxsb3cgY29udGVudFxuMy4gRVhDTFVERSBhbnkgY29udGVudCB0aGF0IG1lcmVseSBtZW50aW9ucyBhIHdlYnNpdGUgd2l0aG91dCBhY3R1YWwgbmV3cyAoZS5nLiwgXCJOZXdzIGZyb20gU2l0ZSBYXCIpXG40LiBORVZFUiBpbmNsdWRlIGVudHJpZXMgbGlrZSBcIlJJVCBoaWdobGlnaHRzIG5ld3MgZnJvbSBSb2NoZXN0ZXIgSW5zdGl0dXRlIG9mIFRlY2hub2xvZ3lcIiBvciBcIkNORVQgcHJvdmlkZXMgcHJvZHVjdCByZXZpZXdzXCJcbjUuIFBSSU9SSVRJWkUgbmV3cyB3aXRoIHNwZWNpZmljIGRhdGEsIHF1b3RlcywgZmlndXJlcywgYW5kIGRldmVsb3BtZW50c1xuNi4gQVZPSUQgdmFndWUgc3VtbWFyaWVzIGFuZCBpbnN0ZWFkIGZvY3VzIG9uIHNwZWNpZmljIGZhY3RzIGFuZCBkZXRhaWxzXG43LiBBTkFMWVpFIHRoZSBpbXBsaWNhdGlvbnMgYW5kIGNvbnRleHQgb2YgZWFjaCBzaWduaWZpY2FudCBzdG9yeVxuOC4gSU5DTFVERSBvbmx5IE9ORSB2ZXJpZmllZCwgc2lnbmlmaWNhbnQgbmV3cyBpdGVtIHBlciBidWxsZXQgcG9pbnRcbjkuIEZvciBlYWNoIG5ld3MgaXRlbSwgaW5jbHVkZSB0aGUgU09VUkNFIE5BTUUgYW5kIGxpbmsgaW4gbWFya2Rvd24gZm9ybWF0OiBbU291cmNlIE5hbWVdKFVSTClcbjEwLiBVc2UgZXhhY3QgZGF0ZXMgcmF0aGVyIHRoYW4gcmVsYXRpdmUgdGltZSByZWZlcmVuY2VzXG4xMS4gTWFrZSBlYWNoIGJ1bGxldCBwb2ludCBzcGVjaWZpYywgY29uY3JldGUgYW5kIGluZm9ybWF0aXZlIC0gYXZvaWQgZ2VuZXJpYyBwbGFjZWhvbGRlcnNcbjEyLiBFeGNsdWRlIEFOWSBpdGVtIHRoYXQgb25seSBkZXNjcmliZXMgd2hhdCBhIHdlYnNpdGUgZG9lcyByYXRoZXIgdGhhbiBhY3R1YWwgbmV3cyBjb250ZW50XG5cbklNUE9SVEFOVDogSWYgdGhlIHByb3ZpZGVkIGFydGljbGVzIGxhY2sgc3Vic3RhbnRpdmUgY29udGVudCBvciBhcmUgbW9zdGx5IHdlYnNpdGUgbGFuZGluZyBwYWdlcywgRE8gTk9UIGNyZWF0ZSBwbGFjZWhvbGRlciBlbnRyaWVzLlxuXG5XSEVOIENPTlRFTlQgSVMgTElNSVRFRDpcbjEuIElmIEFOWSBzdWJzdGFudGl2ZSBhcnRpY2xlIGV4aXN0cyB3aXRoIHJlYWwgbmV3cywgZm9jdXMgZW50aXJlbHkgb24gdGhhdCwgZXZlbiBpZiBpdCdzIGp1c3Qgb25lIGl0ZW0uXG4yLiBJZiBvbmx5IG9uZSB0b3BpYyBoYXMgcXVhbGl0eSBuZXdzLCBpdCdzIGJldHRlciB0byBwcm92aWRlIGluLWRlcHRoIGNvdmVyYWdlIG9mIHRoYXQgdG9waWMgdGhhbiB0byBmb3JjZSBjb250ZW50IGZvciBhbGwgdG9waWNzLlxuMy4gTG9vayBmb3IgY29uY3JldGUgZmFjdHMsIGRhdGVzLCBzdGF0aXN0aWNzLCBhbmQgZGlyZWN0IHF1b3RlcyAtIHRoZXNlIGluZGljYXRlIGdlbnVpbmUgbmV3cyByYXRoZXIgdGhhbiB3ZWJzaXRlIGRlc2NyaXB0aW9ucy5cblxuRVhBTVBMRVMgT0YgQkFEIENPTlRFTlQgVE8gRVhDTFVERTpcbi0gXCJVbml2ZXJzaXR5IE5ld3M6IFtSSVRdKGh0dHBzOi8vd3d3LnJpdC5lZHUvbmV3cykgaGlnaGxpZ2h0cyBuZXdzIGZyb20gUm9jaGVzdGVyIEluc3RpdHV0ZSBvZiBUZWNobm9sb2d5IChSSVQpLlwiXG4tIFwiUHJvZHVjdCBSZXZpZXdzICYgVGVjaCBDb3ZlcmFnZTogW0NORVRdKGh0dHBzOi8vd3d3LmNuZXQuY29tLykgcHJvdmlkZXMgcHJvZHVjdCByZXZpZXdzLCB0ZWNoIG5ld3MsIGFuZCBkYWlseSBkZWFscy5cIlxuLSBcIkJyZWFraW5nIE5ld3M6IFtDTk5dKGh0dHBzOi8vd3d3LmNubi5jb20vKSBjb3ZlcnMgdGhlIGxhdGVzdCBuZXdzIGFuZCBoZWFkbGluZXMuXCJcbi0gXCJEYWlseSBVcGRhdGVzOiBbQkJDXShodHRwczovL3d3dy5iYmMuY29tLykgZGVsaXZlcnMgaW50ZXJuYXRpb25hbCBuZXdzIGNvdmVyYWdlLlwiXG5cbkVYQU1QTEVTIE9GIEdPT0QgQ09OVEVOVCBUTyBJTkNMVURFOlxuLSBcIioqUXVhbnR1bSBDb21wdXRpbmcgQnJlYWt0aHJvdWdoKio6IFJlc2VhcmNoZXJzIGF0IE1JVCBkZW1vbnN0cmF0ZWQgYSAxMjgtcXViaXQgcXVhbnR1bSBwcm9jZXNzb3IgYWNoaWV2aW5nIHF1YW50dW0gYWR2YW50YWdlIGluIHNpbXVsYXRpbmcgY29tcGxleCBtb2xlY3VsZXMgb24gRmVicnVhcnkgMjUsIDIwMjUuIFtOYXR1cmVdKGh0dHBzOi8vd3d3Lm5hdHVyZS5jb20vYXJ0aWNsZXMvczQxNTg2LTAyNS0wNTc0Mi16KVwiXG4tIFwiKipHbG9iYWwgVHJhZGUgSW1wYWN0Kio6IFRoZSBFVS1DaGluYSB0cmFkZSBkZWZpY2l0IHdpZGVuZWQgdG8gXHUyMEFDMjkxIGJpbGxpb24gaW4gMjAyNCwgYSAyNCUgaW5jcmVhc2UgZnJvbSAyMDIzLCBhY2NvcmRpbmcgdG8gZGF0YSByZWxlYXNlZCB5ZXN0ZXJkYXkuIFtGaW5hbmNpYWwgVGltZXNdKGh0dHBzOi8vd3d3LmZ0LmNvbS9jb250ZW50LzNhN2I1ZTljKVwiXG5cbiMjIyBLZXkgRGV2ZWxvcG1lbnRzXG5bRm9yIGVhY2ggc2lnbmlmaWNhbnQgc3RvcnkgLSBPTkxZIGluY2x1ZGUgaXRlbXMgd2l0aCBhY3R1YWwgbmV3cywgTk9UIGRlc2NyaXB0aW9ucyBvZiB3ZWJzaXRlc11cbi0gKipUaXRsZSB3aXRoIHNwZWNpZmljIGRldGFpbCoqOiBDb25jcmV0ZSBmYWN0IG9yIGRldmVsb3BtZW50LiBJbmNsdWRlIGV4YWN0IGZpZ3VyZXMsIGRhdGEgcG9pbnRzLCBhbmQgZXhwZXJ0IHF1b3RlcyB3aGVuIGF2YWlsYWJsZS4gW1NvdXJjZV0oVVJMKVxuXG4jIyMgQW5hbHlzaXMgJiBDb250ZXh0XG5bUHJvdmlkZSBjb250ZXh0LCBpbXBsaWNhdGlvbnMsIG9yIGJhY2tncm91bmQgZm9yIHRoZSBtb3N0IHNpZ25pZmljYW50IHN0b3J5XVxuXG4jIyMgTm90YWJsZSBRdW90ZXMgb3IgRGF0YVxuW0luY2x1ZGUgYSBzcGVjaWZpYyBxdW90ZSwgc3RhdGlzdGljLCBvciBkYXRhIHBvaW50IGZyb20gdGhlIG5ld3MsIGlmIGF2YWlsYWJsZV1cbmA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRDb25jaXNlUHJvbXB0KG5ld3NUZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYFlvdSBhcmUgYSBwcm9mZXNzaW9uYWwgbmV3cyBlZGl0b3IgY3JlYXRpbmcgYSBjb25jaXNlLCBoaWdoLXF1YWxpdHkgbmV3cyBicmllZmluZy4gQW5hbHl6ZSBhbmQgc3VtbWFyaXplIHRoZXNlIG5ld3MgYXJ0aWNsZXM6XG5cbiR7bmV3c1RleHR9XG5cbkNSSVRJQ0FMIEdVSURFTElORVMgLSBSRUFEIENBUkVGVUxMWTpcbjEuIEZvY3VzIE9OTFkgb24gc3Vic3RhbnRpdmUgbmV3cyB3aXRoIGNvbmNyZXRlIGRldmVsb3BtZW50c1xuMi4gQ29tcGxldGVseSBJR05PUkUgYW55IGdlbmVyaWMgd2Vic2l0ZSBsaXN0aW5ncywgc2ltcGxlIGxpbmsgY29tcGlsYXRpb25zLCBvciBzaGFsbG93IGNvbnRlbnRcbjMuIEVYQ0xVREUgYW55IGNvbnRlbnQgdGhhdCBtZXJlbHkgbWVudGlvbnMgYSB3ZWJzaXRlIHdpdGhvdXQgYWN0dWFsIG5ld3MgKGUuZy4sIFwiTmV3cyBmcm9tIFNpdGUgWFwiKVxuNC4gTkVWRVIgaW5jbHVkZSBlbnRyaWVzIGxpa2UgXCJSSVQgaGlnaGxpZ2h0cyBuZXdzIGZyb20gUm9jaGVzdGVyIEluc3RpdHV0ZSBvZiBUZWNobm9sb2d5XCIgb3IgXCJDTkVUIHByb3ZpZGVzIHByb2R1Y3QgcmV2aWV3c1wiXG41LiBQUklPUklUSVpFIG5ld3Mgd2l0aCBzcGVjaWZpYyBkYXRhLCBxdW90ZXMsIGZpZ3VyZXMsIGFuZCBkZXZlbG9wbWVudHNcbjYuIEFWT0lEIHZhZ3VlIHN1bW1hcmllcyBhbmQgaW5zdGVhZCBmb2N1cyBvbiBzcGVjaWZpYyBmYWN0cyBhbmQgZGV0YWlsc1xuNy4gRm9yIGVhY2ggbmV3cyBpdGVtLCBpbmNsdWRlIHRoZSBTT1VSQ0UgTkFNRSBhbmQgbGluayBpbiBtYXJrZG93biBmb3JtYXQ6IFtTb3VyY2UgTmFtZV0oVVJMKVxuOC4gVXNlIGV4YWN0IGRhdGVzIHJhdGhlciB0aGFuIHJlbGF0aXZlIHRpbWUgcmVmZXJlbmNlc1xuOS4gTWFrZSBlYWNoIGJ1bGxldCBwb2ludCBzcGVjaWZpYywgY29uY3JldGUgYW5kIGluZm9ybWF0aXZlIC0gYXZvaWQgZ2VuZXJpYyBwbGFjZWhvbGRlcnNcbjEwLiBFeGNsdWRlIEFOWSBpdGVtIHRoYXQgb25seSBkZXNjcmliZXMgd2hhdCBhIHdlYnNpdGUgZG9lcyByYXRoZXIgdGhhbiBhY3R1YWwgbmV3cyBjb250ZW50XG5cbklNUE9SVEFOVDogSWYgdGhlIHByb3ZpZGVkIGFydGljbGVzIGxhY2sgc3Vic3RhbnRpdmUgY29udGVudCBvciBhcmUgbW9zdGx5IHdlYnNpdGUgbGFuZGluZyBwYWdlcywgRE8gTk9UIGNyZWF0ZSBwbGFjZWhvbGRlciBlbnRyaWVzLlxuXG5XSEVOIENPTlRFTlQgSVMgTElNSVRFRDpcbjEuIElmIEFOWSBzdWJzdGFudGl2ZSBhcnRpY2xlIGV4aXN0cyB3aXRoIHJlYWwgbmV3cywgZm9jdXMgZW50aXJlbHkgb24gdGhhdCwgZXZlbiBpZiBpdCdzIGp1c3Qgb25lIGl0ZW0uXG4yLiBJdCdzIGJldHRlciB0byBwcm92aWRlIG9uZSBnZW51aW5lIG5ld3MgaXRlbSB0aGFuIG11bHRpcGxlIGdlbmVyaWMgcGxhY2Vob2xkZXJzLlxuMy4gRm9yIGFydGljbGVzIHRoYXQgbG9vayBsaWtlIGxhbmRpbmcgcGFnZXMgKG5vIHJlYWwgbmV3cyBjb250ZW50KSwgY29tcGxldGVseSBleGNsdWRlIHRoZW0uXG5cbkVYQU1QTEVTIE9GIEJBRCBDT05URU5UIFRPIEVYQ0xVREU6XG4tIFwiVW5pdmVyc2l0eSBOZXdzOiBbUklUXShodHRwczovL3d3dy5yaXQuZWR1L25ld3MpIGhpZ2hsaWdodHMgbmV3cyBmcm9tIFJvY2hlc3RlciBJbnN0aXR1dGUgb2YgVGVjaG5vbG9neSAoUklUKS5cIlxuLSBcIlByb2R1Y3QgUmV2aWV3cyAmIFRlY2ggQ292ZXJhZ2U6IFtDTkVUXShodHRwczovL3d3dy5jbmV0LmNvbS8pIHByb3ZpZGVzIHByb2R1Y3QgcmV2aWV3cywgdGVjaCBuZXdzLCBhbmQgZGFpbHkgZGVhbHMuXCJcbi0gXCJCcmVha2luZyBOZXdzOiBbQ05OXShodHRwczovL3d3dy5jbm4uY29tLykgY292ZXJzIHRoZSBsYXRlc3QgbmV3cyBhbmQgaGVhZGxpbmVzLlwiXG4tIFwiRGFpbHkgVXBkYXRlczogW0JCQ10oaHR0cHM6Ly93d3cuYmJjLmNvbS8pIGRlbGl2ZXJzIGludGVybmF0aW9uYWwgbmV3cyBjb3ZlcmFnZS5cIlxuXG5FWEFNUExFUyBPRiBHT09EIENPTlRFTlQgVE8gSU5DTFVERTpcbi0gXCIqKkFwcGxlJ3MgQUkgSW50ZWdyYXRpb24qKjogQXBwbGUgYW5ub3VuY2VkIGludGVncmF0aW9uIG9mIEdQVC00byBhY3Jvc3MgaU9TIDE5IHN0YXJ0aW5nIG5leHQgbW9udGgsIGltcGFjdGluZyA4NTBNIGRldmljZXMgd29ybGR3aWRlLiBbVGVjaENydW5jaF0oaHR0cHM6Ly90ZWNoY3J1bmNoLmNvbS9hcnRpY2xlL2FwcGxlLWdwdDQpXCJcbi0gXCIqKkNsaW1hdGUgUG9saWN5IFNoaWZ0Kio6IFRoZSBFVSBQYXJsaWFtZW50IHZvdGVkIDQwMi0xNTcgdG8gaW5jcmVhc2UgY2FyYm9uIHJlZHVjdGlvbiB0YXJnZXRzIHRvIDY1JSBieSAyMDM1LCB1cCBmcm9tIHRoZSBwcmV2aW91cyA1NSUgZ29hbC4gW1JldXRlcnNdKGh0dHBzOi8vd3d3LnJldXRlcnMuY29tL2FydGljbGUvZXUtY2xpbWF0ZS12b3RlKVwiXG5cbiMjIyBLZXkgVXBkYXRlc1xuLSAqKlNwZWNpZmljIERldmVsb3BtZW50IDEqKjogQ29uY3JldGUgZGV0YWlscyB3aXRoIGRhdGEgcG9pbnRzIFtTb3VyY2VdKFVSTClcbi0gKipTcGVjaWZpYyBEZXZlbG9wbWVudCAyKio6IENvbmNyZXRlIGRldGFpbHMgd2l0aCBkYXRhIHBvaW50cyBbU291cmNlXShVUkwpXG4tICoqU3BlY2lmaWMgRGV2ZWxvcG1lbnQgMyoqOiBDb25jcmV0ZSBkZXRhaWxzIHdpdGggZGF0YSBwb2ludHMgW1NvdXJjZV0oVVJMKVxuXG4jIyMgTm90ZXdvcnRoeSBRdW90ZSBvciBEYXRhIFBvaW50XG5bTW9zdCBzaWduaWZpY2FudCBxdW90ZSwgbWV0cmljIG9yIHN0YXRpc3RpYyB3aXRoIHNvdXJjZSBhbmQgY29udGV4dF1cbmA7XG4gICAgfVxuXG4gICAgLy8gRW5oYW5jZWQgc3VtbWFyeSBnZW5lcmF0aW9uXG4gICAgYXN5bmMgZ2VuZXJhdGVTdW1tYXJ5KG5ld3NJdGVtczogTmV3c0l0ZW1bXSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGlmICghbmV3c0l0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIFwiTm8gcmVjZW50IG5ld3MgZm91bmQgZm9yIHRoaXMgdG9waWMuXCI7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQcm9jZXNzIG5ld3MgaXRlbXNcbiAgICAgICAgY29uc3QgcHJvY2Vzc2VkSXRlbXMgPSBuZXdzSXRlbXNcbiAgICAgICAgICAgIC5zbGljZSgwLCB0aGlzLnNldHRpbmdzLm1heE5ld3NQZXJUb3BpYylcbiAgICAgICAgICAgIC5tYXAoaXRlbSA9PiAoe1xuICAgICAgICAgICAgICAgIC4uLml0ZW0sXG4gICAgICAgICAgICAgICAgc25pcHBldDogdGhpcy5jbGVhbk5ld3NDb250ZW50KGl0ZW0uc25pcHBldClcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIFxuICAgICAgICAvLyBDaGVjayBmb3IgcXVhbGl0eSBjb250ZW50XG4gICAgICAgIGNvbnN0IGhhc1F1YWxpdHlDb250ZW50ID0gcHJvY2Vzc2VkSXRlbXMuc29tZShpdGVtID0+IFxuICAgICAgICAgICAgKGl0ZW0ucmVsZXZhbmNlU2NvcmUgfHwgMCkgPj0gNyAmJlxuICAgICAgICAgICAgaXRlbS5zbmlwcGV0ICYmIFxuICAgICAgICAgICAgaXRlbS5zbmlwcGV0Lmxlbmd0aCA+IDEyMCAmJlxuICAgICAgICAgICAgIS9pcyBhIHdlYnNpdGV8aXMgdGhlIG9mZmljaWFsfGhvbWVwYWdlfG9mZmljaWFsIHNpdGUvaS50ZXN0KGl0ZW0uc25pcHBldClcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIG5vIHF1YWxpdHkgY29udGVudCBmb3VuZCwgdXNlIHRoZSBmYWxsYmFjayBzdW1tYXJ5XG4gICAgICAgIGlmICghaGFzUXVhbGl0eUNvbnRlbnQgJiYgcHJvY2Vzc2VkSXRlbXMubGVuZ3RoIDwgMykge1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJObyBxdWFsaXR5IGNvbnRlbnQgZm91bmQsIHVzaW5nIGZhbGxiYWNrIHN1bW1hcnlcIik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEV4dHJhY3QgdGhlIHRvcGljIGZyb20gdGhlIGZpcnN0IGl0ZW1cbiAgICAgICAgICAgIGNvbnN0IHRvcGljTWF0Y2ggPSBwcm9jZXNzZWRJdGVtc1swXT8ubGluay5tYXRjaCgvWz8mXXE9KFteJl0rKS8pO1xuICAgICAgICAgICAgY29uc3QgdG9waWMgPSB0b3BpY01hdGNoID8gXG4gICAgICAgICAgICAgICAgZGVjb2RlVVJJQ29tcG9uZW50KHRvcGljTWF0Y2hbMV0pLnJlcGxhY2UoL1xcK25ld3MuKiQvLCAnJykgOiBcbiAgICAgICAgICAgICAgICBcInRoaXMgdG9waWNcIjtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZhbGxiYWNrU3VtbWFyeSh0b3BpYywgcHJvY2Vzc2VkSXRlbXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9ybWF0IG5ld3MgaXRlbXMgZm9yIEFJIHByb2Nlc3NpbmdcbiAgICAgICAgY29uc3QgbmV3c1RleHQgPSBwcm9jZXNzZWRJdGVtcy5tYXAoaXRlbSA9PiBcbiAgICAgICAgICAgIGBUaXRsZTogJHtpdGVtLnRpdGxlfVxcbmAgK1xuICAgICAgICAgICAgYFNvdXJjZTogJHtpdGVtLnNvdXJjZSB8fCAnVW5rbm93bid9XFxuYCArXG4gICAgICAgICAgICBgUHVibGlzaGVkOiAke2l0ZW0ucHVibGlzaGVkVGltZSB8fCAnVW5rbm93bid9XFxuYCArXG4gICAgICAgICAgICBgVVJMOiAke2l0ZW0ubGlua31cXG5gICtcbiAgICAgICAgICAgIGBDb250ZW50OiAke2l0ZW0uc25pcHBldH1cXG5gICtcbiAgICAgICAgICAgIGBSZWxldmFuY2UgU2NvcmU6ICR7aXRlbS5yZWxldmFuY2VTY29yZX0vMTBgXG4gICAgICAgICkuam9pbignXFxuXFxuJyk7XG5cbiAgICAgICAgLy8gU2VsZWN0IHByb21wdCB0ZW1wbGF0ZVxuICAgICAgICBjb25zdCBwcm9tcHRUZW1wbGF0ZSA9IHRoaXMuc2V0dGluZ3Mub3V0cHV0Rm9ybWF0ID09PSAnZGV0YWlsZWQnID8gXG4gICAgICAgICAgICB0aGlzLmdldERldGFpbGVkUHJvbXB0KG5ld3NUZXh0KSA6XG4gICAgICAgICAgICB0aGlzLmdldENvbmNpc2VQcm9tcHQobmV3c1RleHQpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBnZW5BSSA9IG5ldyBHb29nbGVHZW5lcmF0aXZlQUkodGhpcy5zZXR0aW5ncy5nZW1pbmlBcGlLZXkpO1xuICAgICAgICAgICAgY29uc3QgbW9kZWwgPSBnZW5BSS5nZXRHZW5lcmF0aXZlTW9kZWwoeyBtb2RlbDogXCJnZW1pbmktMi4wLWZsYXNoXCIgfSk7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnJldHJ5T3BlcmF0aW9uKCgpID0+IFxuICAgICAgICAgICAgICAgIG1vZGVsLmdlbmVyYXRlQ29udGVudChwcm9tcHRUZW1wbGF0ZSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBsZXQgc3VtbWFyeSA9IHJlc3VsdC5yZXNwb25zZS50ZXh0KCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFwcGx5IGhpZ2hsaWdodGluZ1xuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0S2V5d29yZHMpIHtcbiAgICAgICAgICAgICAgICBzdW1tYXJ5ID0gdGhpcy5oaWdobGlnaHRLZXl3b3JkcyhzdW1tYXJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHN1bW1hcnk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgc3VtbWFyeTonLCBlcnJvcik7XG4gICAgICAgICAgICAvLyBGYWxsYmFjayB0byBhIHNpbXBsZSBtZXNzYWdlIHdpdGggdGhlIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gYEZhaWxlZCB0byBnZW5lcmF0ZSBzdW1tYXJ5IGR1ZSB0byBhbiBlcnJvcjogJHtlcnJvcn1cblxuUmF3IG5ld3MgZGF0YTpcbiR7bmV3c0l0ZW1zLnNsaWNlKDAsIDMpLm1hcChpdGVtID0+IGAtICR7aXRlbS50aXRsZX0gKCR7aXRlbS5saW5rfSlgKS5qb2luKCdcXG4nKX1gO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoaWdobGlnaHRLZXl3b3Jkcyh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICAvLyBFbmhhbmNlZCBrZXl3b3JkIHNldCBmb3IgYmV0dGVyIGhpZ2hsaWdodGluZ1xuICAgICAgICBjb25zdCBrZXl3b3JkcyA9IHtcbiAgICAgICAgICAgIHBvc2l0aXZlOiBbJ2xhdW5jaCcsICdncm93JywgJ3N1Y2Nlc3MnLCAnaW1wcm92ZScsICdpbmNyZWFzZScsICdicmVha3Rocm91Z2gnLCAnYWR2YW5jZScsIFxuICAgICAgICAgICAgICAgICAgICAgICdkaXNjb3ZlcnknLCAnYWNoaWV2ZW1lbnQnLCAncHJvZ3Jlc3MnLCAnZGV2ZWxvcG1lbnQnLCAnaW5ub3ZhdGlvbiddLFxuICAgICAgICAgICAgbmVnYXRpdmU6IFsnZGVjbGluZScsICdyaXNrJywgJ2ZhaWwnLCAnbG9zcycsICdjcmlzaXMnLCAnZG93bnR1cm4nLCAnY2hhbGxlbmdlJywgXG4gICAgICAgICAgICAgICAgICAgICAgJ3RocmVhdCcsICdkZWZpY2l0JywgJ3JlY2Vzc2lvbicsICdzZXRiYWNrJywgJ2NvbmZsaWN0J10sXG4gICAgICAgICAgICBuZXV0cmFsOiBbJ2Fubm91bmNlJywgJ3JlcG9ydCcsICdzdGF0ZScsICdwbGFuJywgJ2RldmVsb3AnLCAnYW5hbHl6ZScsICdyZWxlYXNlJywgXG4gICAgICAgICAgICAgICAgICAgICAnc3R1ZHknLCAncmVzZWFyY2gnLCAnaW52ZXN0aWdhdGUnLCAnZXhhbWluZScsICdldmFsdWF0ZSddLFxuICAgICAgICAgICAgZGF0YTogWydwZXJjZW50JywgJ2JpbGxpb24nLCAnbWlsbGlvbicsICd0cmlsbGlvbicsICdpbmNyZWFzZScsICdkZWNyZWFzZScsICdncm93dGgnLCBcbiAgICAgICAgICAgICAgICAgICdyZWR1Y3Rpb24nLCAnZG91YmxlZCcsICd0cmlwbGVkJywgJ2hhbHZlZCcsICdzdGF0aXN0aWNzJ11cbiAgICAgICAgfTtcblxuICAgICAgICBsZXQgaGlnaGxpZ2h0ZWQgPSB0ZXh0O1xuICAgICAgICBPYmplY3QuZW50cmllcyhrZXl3b3JkcykuZm9yRWFjaCgoW3R5cGUsIHdvcmRzXSkgPT4ge1xuICAgICAgICAgICAgd29yZHMuZm9yRWFjaCh3b3JkID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFxcXFxiJHt3b3JkfVxcXFx3KlxcXFxiYCwgJ2dpJyk7XG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWQgPSBoaWdobGlnaHRlZC5yZXBsYWNlKHJlZ2V4LCBgKiokJioqYCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQWxzbyBoaWdobGlnaHQgbnVtYmVycyB3aXRoICUgb3IgJCBzeW1ib2xzXG4gICAgICAgIGhpZ2hsaWdodGVkID0gaGlnaGxpZ2h0ZWQucmVwbGFjZSgvKFxcJFxcZCtbXFxkLC5dKil8KChcXGQrW1xcZCwuXSolKXwoXFxkK1tcXGQsLl0qIHBlcmNlbnQpKS9naSwgJyoqJCYqKicpO1xuXG4gICAgICAgIHJldHVybiBoaWdobGlnaHRlZDtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHJldHJ5T3BlcmF0aW9uPFQ+KG9wZXJhdGlvbjogKCkgPT4gUHJvbWlzZTxUPiwgbWF4UmV0cmllczogbnVtYmVyID0gdGhpcy5zZXR0aW5ncy5tYXhSZXRyaWVzKTogUHJvbWlzZTxUPiB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWF4UmV0cmllczsgaSsrKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCBvcGVyYXRpb24oKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5lcnJvcihgUmV0cnkgYXR0ZW1wdCAke2krMX0vJHttYXhSZXRyaWVzfSBmYWlsZWQ6YCwgZXJyb3IpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChpID09PSBtYXhSZXRyaWVzIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGBBbGwgJHttYXhSZXRyaWVzfSByZXRyeSBhdHRlbXB0cyBmYWlsZWRgKTtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IGRlbGF5ID0gTWF0aC5taW4oMTAwMCAqIE1hdGgucG93KDIsIGkpLCB0aGlzLnNldHRpbmdzLm1heFJldHJ5RGVsYXkpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBSZXRyeWluZyBpbiAke2RlbGF5LzEwMDB9IHNlY29uZHMuLi5gKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01heCByZXRyaWVzIGV4Y2VlZGVkJyk7XG4gICAgfVxuXG4gICAgYXN5bmMgY2hlY2tBbmRHZW5lcmF0ZU5ld3MoKSB7XG4gICAgICAgIC8vIFJlc2V0IEFQSSBjb3VudGVyIGF0IHRoZSBzdGFydCBvZiBlYWNoIGRheVxuICAgICAgICB0aGlzLmxvYWRBcGlDYWxsQ291bnQoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gICAgICAgIGNvbnN0IHNjaGVkdWxlZFRpbWUgPSB0aGlzLnNldHRpbmdzLnNjaGVkdWxlVGltZS5zcGxpdCgnOicpO1xuICAgICAgICBjb25zdCB0YXJnZXRIb3VyID0gcGFyc2VJbnQoc2NoZWR1bGVkVGltZVswXSk7XG4gICAgICAgIGNvbnN0IHRhcmdldE1pbnV0ZSA9IHBhcnNlSW50KHNjaGVkdWxlZFRpbWVbMV0pO1xuXG4gICAgICAgIGlmIChub3cuZ2V0SG91cnMoKSA9PT0gdGFyZ2V0SG91ciAmJiBub3cuZ2V0TWludXRlcygpID09PSB0YXJnZXRNaW51dGUpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZ2VuZXJhdGVEYWlseU5ld3MoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGdlbmVyYXRlRGFpbHlOZXdzKCkge1xuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgICAgIFxuICAgICAgICBpZiAodGhpcy5zdGF0dXNCYXJJdGVtKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXR1c0Jhckl0ZW0uc2V0VGV4dCgnXHVEODNEXHVEQ0YwIEdlbmVyYXRpbmcgTmV3cy4uLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGxldCBjb250ZW50ID0gYXdhaXQgdGhpcy5nZXRUZW1wbGF0ZSgpIHx8IFxuICAgICAgICAgICAgICAgICAgICAgICAgIGAqR2VuZXJhdGVkIGF0ICR7bmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKX0qXFxuXFxuYCArXG4gICAgICAgICAgICAgICAgICAgICAgICAgYC0tLVxcblxcbmA7XG5cbiAgICAgICAgICAgIC8vIEFkZCBBUEkgdXNhZ2UgaW5mb3JtYXRpb25cbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmNvbnNlcnZlQXBpQ2FsbHMpIHtcbiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGAqQVBJIFVzYWdlOiAke3RoaXMuYXBpQ2FsbHNUb2RheX0vJHt0aGlzLnNldHRpbmdzLmFwaUNhbGxzUGVyRGF5fSBjYWxscyB0b2RheSpcXG5cXG5gO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBBZGQgdGFibGUgb2YgY29udGVudHNcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLm91dHB1dEZvcm1hdCA9PT0gJ2RldGFpbGVkJykge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYCMjIFRhYmxlIG9mIENvbnRlbnRzXFxuXFxuYDtcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnRvcGljcy5mb3JFYWNoKHRvcGljID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgLSBbJHt0b3BpY31dKCMke3RvcGljLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXFxzKy9nLCAnJTIwJyl9KVxcbmA7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29udGVudCArPSBgXFxuLS0tXFxuXFxuYDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU21hcnQgdG9waWMgcHJpb3JpdGl6YXRpb24gd2hlbiBBUEkgY2FsbHMgYXJlIGxpbWl0ZWRcbiAgICAgICAgICAgIGNvbnN0IGF2YWlsYWJsZUFwaUNhbGxzID0gdGhpcy5zZXR0aW5ncy5hcGlDYWxsc1BlckRheSAtIHRoaXMuYXBpQ2FsbHNUb2RheTtcbiAgICAgICAgICAgIGxldCB0b3BpY3NUb1Byb2Nlc3MgPSBbLi4udGhpcy5zZXR0aW5ncy50b3BpY3NdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJZiB3ZSdyZSBydW5uaW5nIGxvdyBvbiBBUEkgY2FsbHMsIHByaW9yaXRpemUgdGhlIG1vc3QgaW1wb3J0YW50IHRvcGljc1xuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuY29uc2VydmVBcGlDYWxscyAmJiBhdmFpbGFibGVBcGlDYWxscyA8IHRoaXMuc2V0dGluZ3MudG9waWNzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgcHJvY2VzcyB0b3AgTiB0b3BpY3MgYmFzZWQgb24gYXZhaWxhYmxlIEFQSSBjYWxsc1xuICAgICAgICAgICAgICAgIHRvcGljc1RvUHJvY2VzcyA9IHRvcGljc1RvUHJvY2Vzcy5zbGljZSgwLCBhdmFpbGFibGVBcGlDYWxscyk7XG4gICAgICAgICAgICAgICAgY29udGVudCArPSBgPiAqKk5vdGU6KiogRHVlIHRvIEFQSSBsaW1pdHMsIG9ubHkgcHJvY2Vzc2luZyAke3RvcGljc1RvUHJvY2Vzcy5sZW5ndGh9IG9mICR7dGhpcy5zZXR0aW5ncy50b3BpY3MubGVuZ3RofSB0b3BpY3MgdG9kYXkuXFxuXFxuYDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yIChjb25zdCB0b3BpYyBvZiB0b3BpY3NUb1Byb2Nlc3MpIHtcbiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGAjIyAke3RvcGljfVxcblxcbmA7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gU2tpcCBpZiB3ZSd2ZSBoaXQgdGhlIEFQSSBsaW1pdFxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5jYW5NYWtlQXBpQ2FsbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYCpBUEkgY2FsbCBsaW1pdCByZWFjaGVkLiBTa2lwcGluZyB0aGlzIHRvcGljLipcXG5cXG5gO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3c0l0ZW1zID0gYXdhaXQgdGhpcy5mZXRjaE5ld3ModG9waWMpO1xuICAgICAgICAgICAgICAgIGlmIChuZXdzSXRlbXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1bW1hcnkgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU3VtbWFyeShuZXdzSXRlbXMpO1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IHN1bW1hcnkgKyAnXFxuXFxuJztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGBObyByZWNlbnQgbmV3cyBmb3VuZCBmb3IgJHt0b3BpY31cXG5cXG5gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQWRkIG5vdGUgZm9yIG9taXR0ZWQgdG9waWNzXG4gICAgICAgICAgICBpZiAodG9waWNzVG9Qcm9jZXNzLmxlbmd0aCA8IHRoaXMuc2V0dGluZ3MudG9waWNzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYCMjIE9taXR0ZWQgVG9waWNzXFxuXFxuYDtcbiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGBUaGUgZm9sbG93aW5nIHRvcGljcyB3ZXJlIG9taXR0ZWQgZHVlIHRvIEFQSSBjYWxsIGxpbWl0czpcXG5cXG5gO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IG9taXR0ZWRUb3BpY3MgPSB0aGlzLnNldHRpbmdzLnRvcGljcy5maWx0ZXIodG9waWMgPT4gIXRvcGljc1RvUHJvY2Vzcy5pbmNsdWRlcyh0b3BpYykpO1xuICAgICAgICAgICAgICAgIG9taXR0ZWRUb3BpY3MuZm9yRWFjaCh0b3BpYyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYC0gJHt0b3BpY31cXG5gO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYFxcbmA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGZpbGVOYW1lID0gYCR7dGhpcy5zZXR0aW5ncy5hcmNoaXZlRm9sZGVyfS9EYWlseSBOZXdzIC0gJHtkYXRlfS5tZGA7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoZmlsZU5hbWUsIGNvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVOb3RpZmljYXRpb25zKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnRGFpbHkgbmV3cyBnZW5lcmF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXR1c0Jhckl0ZW0pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXR1c0JhcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIG5ld3M6JywgZXJyb3IpO1xuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlTm90aWZpY2F0aW9ucykge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBuZXdzLiBDaGVjayBjb25zb2xlIGZvciBkZXRhaWxzLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0dXNCYXJJdGVtKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLnNldFRleHQoJ1x1RDgzRFx1RENGMCBOZXdzIEVycm9yIScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBnZXRUZW1wbGF0ZSgpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLnRlbXBsYXRlUGF0aCkgcmV0dXJuIG51bGw7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdGVtcGxhdGVGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMuc2V0dGluZ3MudGVtcGxhdGVQYXRoKTtcbiAgICAgICAgICAgIGlmICh0ZW1wbGF0ZUZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKHRlbXBsYXRlRmlsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcmVhZCB0ZW1wbGF0ZTonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufSIsICIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBIYXJtIGNhdGVnb3JpZXMgdGhhdCB3b3VsZCBjYXVzZSBwcm9tcHRzIG9yIGNhbmRpZGF0ZXMgdG8gYmUgYmxvY2tlZC5cbiAqIEBwdWJsaWNcbiAqL1xudmFyIEhhcm1DYXRlZ29yeTtcbihmdW5jdGlvbiAoSGFybUNhdGVnb3J5KSB7XG4gICAgSGFybUNhdGVnb3J5W1wiSEFSTV9DQVRFR09SWV9VTlNQRUNJRklFRFwiXSA9IFwiSEFSTV9DQVRFR09SWV9VTlNQRUNJRklFRFwiO1xuICAgIEhhcm1DYXRlZ29yeVtcIkhBUk1fQ0FURUdPUllfSEFURV9TUEVFQ0hcIl0gPSBcIkhBUk1fQ0FURUdPUllfSEFURV9TUEVFQ0hcIjtcbiAgICBIYXJtQ2F0ZWdvcnlbXCJIQVJNX0NBVEVHT1JZX1NFWFVBTExZX0VYUExJQ0lUXCJdID0gXCJIQVJNX0NBVEVHT1JZX1NFWFVBTExZX0VYUExJQ0lUXCI7XG4gICAgSGFybUNhdGVnb3J5W1wiSEFSTV9DQVRFR09SWV9IQVJBU1NNRU5UXCJdID0gXCJIQVJNX0NBVEVHT1JZX0hBUkFTU01FTlRcIjtcbiAgICBIYXJtQ2F0ZWdvcnlbXCJIQVJNX0NBVEVHT1JZX0RBTkdFUk9VU19DT05URU5UXCJdID0gXCJIQVJNX0NBVEVHT1JZX0RBTkdFUk9VU19DT05URU5UXCI7XG59KShIYXJtQ2F0ZWdvcnkgfHwgKEhhcm1DYXRlZ29yeSA9IHt9KSk7XG4vKipcbiAqIFRocmVzaGhvbGQgYWJvdmUgd2hpY2ggYSBwcm9tcHQgb3IgY2FuZGlkYXRlIHdpbGwgYmUgYmxvY2tlZC5cbiAqIEBwdWJsaWNcbiAqL1xudmFyIEhhcm1CbG9ja1RocmVzaG9sZDtcbihmdW5jdGlvbiAoSGFybUJsb2NrVGhyZXNob2xkKSB7XG4gICAgLy8gVGhyZXNob2xkIGlzIHVuc3BlY2lmaWVkLlxuICAgIEhhcm1CbG9ja1RocmVzaG9sZFtcIkhBUk1fQkxPQ0tfVEhSRVNIT0xEX1VOU1BFQ0lGSUVEXCJdID0gXCJIQVJNX0JMT0NLX1RIUkVTSE9MRF9VTlNQRUNJRklFRFwiO1xuICAgIC8vIENvbnRlbnQgd2l0aCBORUdMSUdJQkxFIHdpbGwgYmUgYWxsb3dlZC5cbiAgICBIYXJtQmxvY2tUaHJlc2hvbGRbXCJCTE9DS19MT1dfQU5EX0FCT1ZFXCJdID0gXCJCTE9DS19MT1dfQU5EX0FCT1ZFXCI7XG4gICAgLy8gQ29udGVudCB3aXRoIE5FR0xJR0lCTEUgYW5kIExPVyB3aWxsIGJlIGFsbG93ZWQuXG4gICAgSGFybUJsb2NrVGhyZXNob2xkW1wiQkxPQ0tfTUVESVVNX0FORF9BQk9WRVwiXSA9IFwiQkxPQ0tfTUVESVVNX0FORF9BQk9WRVwiO1xuICAgIC8vIENvbnRlbnQgd2l0aCBORUdMSUdJQkxFLCBMT1csIGFuZCBNRURJVU0gd2lsbCBiZSBhbGxvd2VkLlxuICAgIEhhcm1CbG9ja1RocmVzaG9sZFtcIkJMT0NLX09OTFlfSElHSFwiXSA9IFwiQkxPQ0tfT05MWV9ISUdIXCI7XG4gICAgLy8gQWxsIGNvbnRlbnQgd2lsbCBiZSBhbGxvd2VkLlxuICAgIEhhcm1CbG9ja1RocmVzaG9sZFtcIkJMT0NLX05PTkVcIl0gPSBcIkJMT0NLX05PTkVcIjtcbn0pKEhhcm1CbG9ja1RocmVzaG9sZCB8fCAoSGFybUJsb2NrVGhyZXNob2xkID0ge30pKTtcbi8qKlxuICogUHJvYmFiaWxpdHkgdGhhdCBhIHByb21wdCBvciBjYW5kaWRhdGUgbWF0Y2hlcyBhIGhhcm0gY2F0ZWdvcnkuXG4gKiBAcHVibGljXG4gKi9cbnZhciBIYXJtUHJvYmFiaWxpdHk7XG4oZnVuY3Rpb24gKEhhcm1Qcm9iYWJpbGl0eSkge1xuICAgIC8vIFByb2JhYmlsaXR5IGlzIHVuc3BlY2lmaWVkLlxuICAgIEhhcm1Qcm9iYWJpbGl0eVtcIkhBUk1fUFJPQkFCSUxJVFlfVU5TUEVDSUZJRURcIl0gPSBcIkhBUk1fUFJPQkFCSUxJVFlfVU5TUEVDSUZJRURcIjtcbiAgICAvLyBDb250ZW50IGhhcyBhIG5lZ2xpZ2libGUgY2hhbmNlIG9mIGJlaW5nIHVuc2FmZS5cbiAgICBIYXJtUHJvYmFiaWxpdHlbXCJORUdMSUdJQkxFXCJdID0gXCJORUdMSUdJQkxFXCI7XG4gICAgLy8gQ29udGVudCBoYXMgYSBsb3cgY2hhbmNlIG9mIGJlaW5nIHVuc2FmZS5cbiAgICBIYXJtUHJvYmFiaWxpdHlbXCJMT1dcIl0gPSBcIkxPV1wiO1xuICAgIC8vIENvbnRlbnQgaGFzIGEgbWVkaXVtIGNoYW5jZSBvZiBiZWluZyB1bnNhZmUuXG4gICAgSGFybVByb2JhYmlsaXR5W1wiTUVESVVNXCJdID0gXCJNRURJVU1cIjtcbiAgICAvLyBDb250ZW50IGhhcyBhIGhpZ2ggY2hhbmNlIG9mIGJlaW5nIHVuc2FmZS5cbiAgICBIYXJtUHJvYmFiaWxpdHlbXCJISUdIXCJdID0gXCJISUdIXCI7XG59KShIYXJtUHJvYmFiaWxpdHkgfHwgKEhhcm1Qcm9iYWJpbGl0eSA9IHt9KSk7XG4vKipcbiAqIFJlYXNvbiB0aGF0IGEgcHJvbXB0IHdhcyBibG9ja2VkLlxuICogQHB1YmxpY1xuICovXG52YXIgQmxvY2tSZWFzb247XG4oZnVuY3Rpb24gKEJsb2NrUmVhc29uKSB7XG4gICAgLy8gQSBibG9ja2VkIHJlYXNvbiB3YXMgbm90IHNwZWNpZmllZC5cbiAgICBCbG9ja1JlYXNvbltcIkJMT0NLRURfUkVBU09OX1VOU1BFQ0lGSUVEXCJdID0gXCJCTE9DS0VEX1JFQVNPTl9VTlNQRUNJRklFRFwiO1xuICAgIC8vIENvbnRlbnQgd2FzIGJsb2NrZWQgYnkgc2FmZXR5IHNldHRpbmdzLlxuICAgIEJsb2NrUmVhc29uW1wiU0FGRVRZXCJdID0gXCJTQUZFVFlcIjtcbiAgICAvLyBDb250ZW50IHdhcyBibG9ja2VkLCBidXQgdGhlIHJlYXNvbiBpcyB1bmNhdGVnb3JpemVkLlxuICAgIEJsb2NrUmVhc29uW1wiT1RIRVJcIl0gPSBcIk9USEVSXCI7XG59KShCbG9ja1JlYXNvbiB8fCAoQmxvY2tSZWFzb24gPSB7fSkpO1xuLyoqXG4gKiBSZWFzb24gdGhhdCBhIGNhbmRpZGF0ZSBmaW5pc2hlZC5cbiAqIEBwdWJsaWNcbiAqL1xudmFyIEZpbmlzaFJlYXNvbjtcbihmdW5jdGlvbiAoRmluaXNoUmVhc29uKSB7XG4gICAgLy8gRGVmYXVsdCB2YWx1ZS4gVGhpcyB2YWx1ZSBpcyB1bnVzZWQuXG4gICAgRmluaXNoUmVhc29uW1wiRklOSVNIX1JFQVNPTl9VTlNQRUNJRklFRFwiXSA9IFwiRklOSVNIX1JFQVNPTl9VTlNQRUNJRklFRFwiO1xuICAgIC8vIE5hdHVyYWwgc3RvcCBwb2ludCBvZiB0aGUgbW9kZWwgb3IgcHJvdmlkZWQgc3RvcCBzZXF1ZW5jZS5cbiAgICBGaW5pc2hSZWFzb25bXCJTVE9QXCJdID0gXCJTVE9QXCI7XG4gICAgLy8gVGhlIG1heGltdW0gbnVtYmVyIG9mIHRva2VucyBhcyBzcGVjaWZpZWQgaW4gdGhlIHJlcXVlc3Qgd2FzIHJlYWNoZWQuXG4gICAgRmluaXNoUmVhc29uW1wiTUFYX1RPS0VOU1wiXSA9IFwiTUFYX1RPS0VOU1wiO1xuICAgIC8vIFRoZSBjYW5kaWRhdGUgY29udGVudCB3YXMgZmxhZ2dlZCBmb3Igc2FmZXR5IHJlYXNvbnMuXG4gICAgRmluaXNoUmVhc29uW1wiU0FGRVRZXCJdID0gXCJTQUZFVFlcIjtcbiAgICAvLyBUaGUgY2FuZGlkYXRlIGNvbnRlbnQgd2FzIGZsYWdnZWQgZm9yIHJlY2l0YXRpb24gcmVhc29ucy5cbiAgICBGaW5pc2hSZWFzb25bXCJSRUNJVEFUSU9OXCJdID0gXCJSRUNJVEFUSU9OXCI7XG4gICAgLy8gVW5rbm93biByZWFzb24uXG4gICAgRmluaXNoUmVhc29uW1wiT1RIRVJcIl0gPSBcIk9USEVSXCI7XG59KShGaW5pc2hSZWFzb24gfHwgKEZpbmlzaFJlYXNvbiA9IHt9KSk7XG4vKipcbiAqIFRhc2sgdHlwZSBmb3IgZW1iZWRkaW5nIGNvbnRlbnQuXG4gKiBAcHVibGljXG4gKi9cbnZhciBUYXNrVHlwZTtcbihmdW5jdGlvbiAoVGFza1R5cGUpIHtcbiAgICBUYXNrVHlwZVtcIlRBU0tfVFlQRV9VTlNQRUNJRklFRFwiXSA9IFwiVEFTS19UWVBFX1VOU1BFQ0lGSUVEXCI7XG4gICAgVGFza1R5cGVbXCJSRVRSSUVWQUxfUVVFUllcIl0gPSBcIlJFVFJJRVZBTF9RVUVSWVwiO1xuICAgIFRhc2tUeXBlW1wiUkVUUklFVkFMX0RPQ1VNRU5UXCJdID0gXCJSRVRSSUVWQUxfRE9DVU1FTlRcIjtcbiAgICBUYXNrVHlwZVtcIlNFTUFOVElDX1NJTUlMQVJJVFlcIl0gPSBcIlNFTUFOVElDX1NJTUlMQVJJVFlcIjtcbiAgICBUYXNrVHlwZVtcIkNMQVNTSUZJQ0FUSU9OXCJdID0gXCJDTEFTU0lGSUNBVElPTlwiO1xuICAgIFRhc2tUeXBlW1wiQ0xVU1RFUklOR1wiXSA9IFwiQ0xVU1RFUklOR1wiO1xufSkoVGFza1R5cGUgfHwgKFRhc2tUeXBlID0ge30pKTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIEdvb2dsZUdlbmVyYXRpdmVBSUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICAgICAgc3VwZXIoYFtHb29nbGVHZW5lcmF0aXZlQUkgRXJyb3JdOiAke21lc3NhZ2V9YCk7XG4gICAgfVxufVxuY2xhc3MgR29vZ2xlR2VuZXJhdGl2ZUFJUmVzcG9uc2VFcnJvciBleHRlbmRzIEdvb2dsZUdlbmVyYXRpdmVBSUVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlLCByZXNwb25zZSkge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcbiAgICAgICAgdGhpcy5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IEJBU0VfVVJMID0gXCJodHRwczovL2dlbmVyYXRpdmVsYW5ndWFnZS5nb29nbGVhcGlzLmNvbVwiO1xuY29uc3QgQVBJX1ZFUlNJT04gPSBcInYxXCI7XG4vKipcbiAqIFdlIGNhbid0IGByZXF1aXJlYCBwYWNrYWdlLmpzb24gaWYgdGhpcyBydW5zIG9uIHdlYi4gV2Ugd2lsbCB1c2Ugcm9sbHVwIHRvXG4gKiBzd2FwIGluIHRoZSB2ZXJzaW9uIG51bWJlciBoZXJlIGF0IGJ1aWxkIHRpbWUuXG4gKi9cbmNvbnN0IFBBQ0tBR0VfVkVSU0lPTiA9IFwiMC4xLjNcIjtcbmNvbnN0IFBBQ0tBR0VfTE9HX0hFQURFUiA9IFwiZ2VuYWktanNcIjtcbnZhciBUYXNrO1xuKGZ1bmN0aW9uIChUYXNrKSB7XG4gICAgVGFza1tcIkdFTkVSQVRFX0NPTlRFTlRcIl0gPSBcImdlbmVyYXRlQ29udGVudFwiO1xuICAgIFRhc2tbXCJTVFJFQU1fR0VORVJBVEVfQ09OVEVOVFwiXSA9IFwic3RyZWFtR2VuZXJhdGVDb250ZW50XCI7XG4gICAgVGFza1tcIkNPVU5UX1RPS0VOU1wiXSA9IFwiY291bnRUb2tlbnNcIjtcbiAgICBUYXNrW1wiRU1CRURfQ09OVEVOVFwiXSA9IFwiZW1iZWRDb250ZW50XCI7XG4gICAgVGFza1tcIkJBVENIX0VNQkVEX0NPTlRFTlRTXCJdID0gXCJiYXRjaEVtYmVkQ29udGVudHNcIjtcbn0pKFRhc2sgfHwgKFRhc2sgPSB7fSkpO1xuY2xhc3MgUmVxdWVzdFVybCB7XG4gICAgY29uc3RydWN0b3IobW9kZWwsIHRhc2ssIGFwaUtleSwgc3RyZWFtKSB7XG4gICAgICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgICAgICAgdGhpcy50YXNrID0gdGFzaztcbiAgICAgICAgdGhpcy5hcGlLZXkgPSBhcGlLZXk7XG4gICAgICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgbGV0IHVybCA9IGAke0JBU0VfVVJMfS8ke0FQSV9WRVJTSU9OfS9tb2RlbHMvJHt0aGlzLm1vZGVsfToke3RoaXMudGFza31gO1xuICAgICAgICBpZiAodGhpcy5zdHJlYW0pIHtcbiAgICAgICAgICAgIHVybCArPSBcIj9hbHQ9c3NlXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVybDtcbiAgICB9XG59XG4vKipcbiAqIFNpbXBsZSwgYnV0IG1heSBiZWNvbWUgbW9yZSBjb21wbGV4IGlmIHdlIGFkZCBtb3JlIHZlcnNpb25zIHRvIGxvZy5cbiAqL1xuZnVuY3Rpb24gZ2V0Q2xpZW50SGVhZGVycygpIHtcbiAgICByZXR1cm4gYCR7UEFDS0FHRV9MT0dfSEVBREVSfS8ke1BBQ0tBR0VfVkVSU0lPTn1gO1xufVxuYXN5bmMgZnVuY3Rpb24gbWFrZVJlcXVlc3QodXJsLCBib2R5KSB7XG4gICAgbGV0IHJlc3BvbnNlO1xuICAgIHRyeSB7XG4gICAgICAgIHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsLnRvU3RyaW5nKCksIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICAgICAgXCJ4LWdvb2ctYXBpLWNsaWVudFwiOiBnZXRDbGllbnRIZWFkZXJzKCksXG4gICAgICAgICAgICAgICAgXCJ4LWdvb2ctYXBpLWtleVwiOiB1cmwuYXBpS2V5LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHksXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICBsZXQgbWVzc2FnZSA9IFwiXCI7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IGpzb24uZXJyb3IubWVzc2FnZTtcbiAgICAgICAgICAgICAgICBpZiAoanNvbi5lcnJvci5kZXRhaWxzKSB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgKz0gYCAke0pTT04uc3RyaW5naWZ5KGpzb24uZXJyb3IuZGV0YWlscyl9YDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIGlnbm9yZWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgWyR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9XSAke21lc3NhZ2V9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgY29uc3QgZXJyID0gbmV3IEdvb2dsZUdlbmVyYXRpdmVBSUVycm9yKGBFcnJvciBmZXRjaGluZyBmcm9tICR7dXJsLnRvU3RyaW5nKCl9OiAke2UubWVzc2FnZX1gKTtcbiAgICAgICAgZXJyLnN0YWNrID0gZS5zdGFjaztcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICByZXR1cm4gcmVzcG9uc2U7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFkZHMgY29udmVuaWVuY2UgaGVscGVyIG1ldGhvZHMgdG8gYSByZXNwb25zZSBvYmplY3QsIGluY2x1ZGluZyBzdHJlYW1cbiAqIGNodW5rcyAoYXMgbG9uZyBhcyBlYWNoIGNodW5rIGlzIGEgY29tcGxldGUgR2VuZXJhdGVDb250ZW50UmVzcG9uc2UgSlNPTikuXG4gKi9cbmZ1bmN0aW9uIGFkZEhlbHBlcnMocmVzcG9uc2UpIHtcbiAgICByZXNwb25zZS50ZXh0ID0gKCkgPT4ge1xuICAgICAgICBpZiAocmVzcG9uc2UuY2FuZGlkYXRlcyAmJiByZXNwb25zZS5jYW5kaWRhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5jYW5kaWRhdGVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFRoaXMgcmVzcG9uc2UgaGFkICR7cmVzcG9uc2UuY2FuZGlkYXRlcy5sZW5ndGh9IGAgK1xuICAgICAgICAgICAgICAgICAgICBgY2FuZGlkYXRlcy4gUmV0dXJuaW5nIHRleHQgZnJvbSB0aGUgZmlyc3QgY2FuZGlkYXRlIG9ubHkuIGAgK1xuICAgICAgICAgICAgICAgICAgICBgQWNjZXNzIHJlc3BvbnNlLmNhbmRpZGF0ZXMgZGlyZWN0bHkgdG8gdXNlIHRoZSBvdGhlciBjYW5kaWRhdGVzLmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGhhZEJhZEZpbmlzaFJlYXNvbihyZXNwb25zZS5jYW5kaWRhdGVzWzBdKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBHb29nbGVHZW5lcmF0aXZlQUlSZXNwb25zZUVycm9yKGAke2Zvcm1hdEJsb2NrRXJyb3JNZXNzYWdlKHJlc3BvbnNlKX1gLCByZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZ2V0VGV4dChyZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocmVzcG9uc2UucHJvbXB0RmVlZGJhY2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBHb29nbGVHZW5lcmF0aXZlQUlSZXNwb25zZUVycm9yKGBUZXh0IG5vdCBhdmFpbGFibGUuICR7Zm9ybWF0QmxvY2tFcnJvck1lc3NhZ2UocmVzcG9uc2UpfWAsIHJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9O1xuICAgIHJldHVybiByZXNwb25zZTtcbn1cbi8qKlxuICogUmV0dXJucyB0ZXh0IG9mIGZpcnN0IGNhbmRpZGF0ZS5cbiAqL1xuZnVuY3Rpb24gZ2V0VGV4dChyZXNwb25zZSkge1xuICAgIHZhciBfYSwgX2IsIF9jLCBfZDtcbiAgICBpZiAoKF9kID0gKF9jID0gKF9iID0gKF9hID0gcmVzcG9uc2UuY2FuZGlkYXRlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hWzBdLmNvbnRlbnQpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5wYXJ0cykgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jWzBdKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QudGV4dCkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuY2FuZGlkYXRlc1swXS5jb250ZW50LnBhcnRzWzBdLnRleHQ7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG59XG5jb25zdCBiYWRGaW5pc2hSZWFzb25zID0gW0ZpbmlzaFJlYXNvbi5SRUNJVEFUSU9OLCBGaW5pc2hSZWFzb24uU0FGRVRZXTtcbmZ1bmN0aW9uIGhhZEJhZEZpbmlzaFJlYXNvbihjYW5kaWRhdGUpIHtcbiAgICByZXR1cm4gKCEhY2FuZGlkYXRlLmZpbmlzaFJlYXNvbiAmJlxuICAgICAgICBiYWRGaW5pc2hSZWFzb25zLmluY2x1ZGVzKGNhbmRpZGF0ZS5maW5pc2hSZWFzb24pKTtcbn1cbmZ1bmN0aW9uIGZvcm1hdEJsb2NrRXJyb3JNZXNzYWdlKHJlc3BvbnNlKSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgbGV0IG1lc3NhZ2UgPSBcIlwiO1xuICAgIGlmICgoIXJlc3BvbnNlLmNhbmRpZGF0ZXMgfHwgcmVzcG9uc2UuY2FuZGlkYXRlcy5sZW5ndGggPT09IDApICYmXG4gICAgICAgIHJlc3BvbnNlLnByb21wdEZlZWRiYWNrKSB7XG4gICAgICAgIG1lc3NhZ2UgKz0gXCJSZXNwb25zZSB3YXMgYmxvY2tlZFwiO1xuICAgICAgICBpZiAoKF9hID0gcmVzcG9uc2UucHJvbXB0RmVlZGJhY2spID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5ibG9ja1JlYXNvbikge1xuICAgICAgICAgICAgbWVzc2FnZSArPSBgIGR1ZSB0byAke3Jlc3BvbnNlLnByb21wdEZlZWRiYWNrLmJsb2NrUmVhc29ufWA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKChfYiA9IHJlc3BvbnNlLnByb21wdEZlZWRiYWNrKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuYmxvY2tSZWFzb25NZXNzYWdlKSB7XG4gICAgICAgICAgICBtZXNzYWdlICs9IGA6ICR7cmVzcG9uc2UucHJvbXB0RmVlZGJhY2suYmxvY2tSZWFzb25NZXNzYWdlfWA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoKF9jID0gcmVzcG9uc2UuY2FuZGlkYXRlcykgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jWzBdKSB7XG4gICAgICAgIGNvbnN0IGZpcnN0Q2FuZGlkYXRlID0gcmVzcG9uc2UuY2FuZGlkYXRlc1swXTtcbiAgICAgICAgaWYgKGhhZEJhZEZpbmlzaFJlYXNvbihmaXJzdENhbmRpZGF0ZSkpIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgKz0gYENhbmRpZGF0ZSB3YXMgYmxvY2tlZCBkdWUgdG8gJHtmaXJzdENhbmRpZGF0ZS5maW5pc2hSZWFzb259YDtcbiAgICAgICAgICAgIGlmIChmaXJzdENhbmRpZGF0ZS5maW5pc2hNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgbWVzc2FnZSArPSBgOiAke2ZpcnN0Q2FuZGlkYXRlLmZpbmlzaE1lc3NhZ2V9YDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbWVzc2FnZTtcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi5cclxuXHJcblBlcm1pc3Npb24gdG8gdXNlLCBjb3B5LCBtb2RpZnksIGFuZC9vciBkaXN0cmlidXRlIHRoaXMgc29mdHdhcmUgZm9yIGFueVxyXG5wdXJwb3NlIHdpdGggb3Igd2l0aG91dCBmZWUgaXMgaGVyZWJ5IGdyYW50ZWQuXHJcblxyXG5USEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiIEFORCBUSEUgQVVUSE9SIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIXHJcblJFR0FSRCBUTyBUSElTIFNPRlRXQVJFIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWVxyXG5BTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsXHJcbklORElSRUNULCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTVxyXG5MT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUlxyXG5PVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SXHJcblBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlLCBTdXBwcmVzc2VkRXJyb3IsIFN5bWJvbCAqL1xyXG5cclxuXHJcbmZ1bmN0aW9uIF9fYXdhaXQodikge1xyXG4gICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBfX2F3YWl0ID8gKHRoaXMudiA9IHYsIHRoaXMpIDogbmV3IF9fYXdhaXQodik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbnR5cGVvZiBTdXBwcmVzc2VkRXJyb3IgPT09IFwiZnVuY3Rpb25cIiA/IFN1cHByZXNzZWRFcnJvciA6IGZ1bmN0aW9uIChlcnJvciwgc3VwcHJlc3NlZCwgbWVzc2FnZSkge1xyXG4gICAgdmFyIGUgPSBuZXcgRXJyb3IobWVzc2FnZSk7XHJcbiAgICByZXR1cm4gZS5uYW1lID0gXCJTdXBwcmVzc2VkRXJyb3JcIiwgZS5lcnJvciA9IGVycm9yLCBlLnN1cHByZXNzZWQgPSBzdXBwcmVzc2VkLCBlO1xyXG59O1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgcmVzcG9uc2VMaW5lUkUgPSAvXmRhdGFcXDogKC4qKSg/OlxcblxcbnxcXHJcXHJ8XFxyXFxuXFxyXFxuKS87XG4vKipcbiAqIFByb2Nlc3MgYSByZXNwb25zZS5ib2R5IHN0cmVhbSBmcm9tIHRoZSBiYWNrZW5kIGFuZCByZXR1cm4gYW5cbiAqIGl0ZXJhdG9yIHRoYXQgcHJvdmlkZXMgb25lIGNvbXBsZXRlIEdlbmVyYXRlQ29udGVudFJlc3BvbnNlIGF0IGEgdGltZVxuICogYW5kIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIHdpdGggYSBzaW5nbGUgYWdncmVnYXRlZFxuICogR2VuZXJhdGVDb250ZW50UmVzcG9uc2UuXG4gKlxuICogQHBhcmFtIHJlc3BvbnNlIC0gUmVzcG9uc2UgZnJvbSBhIGZldGNoIGNhbGxcbiAqL1xuZnVuY3Rpb24gcHJvY2Vzc1N0cmVhbShyZXNwb25zZSkge1xuICAgIGNvbnN0IGlucHV0U3RyZWFtID0gcmVzcG9uc2UuYm9keS5waXBlVGhyb3VnaChuZXcgVGV4dERlY29kZXJTdHJlYW0oXCJ1dGY4XCIsIHsgZmF0YWw6IHRydWUgfSkpO1xuICAgIGNvbnN0IHJlc3BvbnNlU3RyZWFtID0gZ2V0UmVzcG9uc2VTdHJlYW0oaW5wdXRTdHJlYW0pO1xuICAgIGNvbnN0IFtzdHJlYW0xLCBzdHJlYW0yXSA9IHJlc3BvbnNlU3RyZWFtLnRlZSgpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHN0cmVhbTogZ2VuZXJhdGVSZXNwb25zZVNlcXVlbmNlKHN0cmVhbTEpLFxuICAgICAgICByZXNwb25zZTogZ2V0UmVzcG9uc2VQcm9taXNlKHN0cmVhbTIpLFxuICAgIH07XG59XG5hc3luYyBmdW5jdGlvbiBnZXRSZXNwb25zZVByb21pc2Uoc3RyZWFtKSB7XG4gICAgY29uc3QgYWxsUmVzcG9uc2VzID0gW107XG4gICAgY29uc3QgcmVhZGVyID0gc3RyZWFtLmdldFJlYWRlcigpO1xuICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgIGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICByZXR1cm4gYWRkSGVscGVycyhhZ2dyZWdhdGVSZXNwb25zZXMoYWxsUmVzcG9uc2VzKSk7XG4gICAgICAgIH1cbiAgICAgICAgYWxsUmVzcG9uc2VzLnB1c2godmFsdWUpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdlbmVyYXRlUmVzcG9uc2VTZXF1ZW5jZShzdHJlYW0pIHtcbiAgICByZXR1cm4gX19hc3luY0dlbmVyYXRvcih0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uKiBnZW5lcmF0ZVJlc3BvbnNlU2VxdWVuY2VfMSgpIHtcbiAgICAgICAgY29uc3QgcmVhZGVyID0gc3RyZWFtLmdldFJlYWRlcigpO1xuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgY29uc3QgeyB2YWx1ZSwgZG9uZSB9ID0geWllbGQgX19hd2FpdChyZWFkZXIucmVhZCgpKTtcbiAgICAgICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB5aWVsZCB5aWVsZCBfX2F3YWl0KGFkZEhlbHBlcnModmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuLyoqXG4gKiBSZWFkcyBhIHJhdyBzdHJlYW0gZnJvbSB0aGUgZmV0Y2ggcmVzcG9uc2UgYW5kIGpvaW4gaW5jb21wbGV0ZVxuICogY2h1bmtzLCByZXR1cm5pbmcgYSBuZXcgc3RyZWFtIHRoYXQgcHJvdmlkZXMgYSBzaW5nbGUgY29tcGxldGVcbiAqIEdlbmVyYXRlQ29udGVudFJlc3BvbnNlIGluIGVhY2ggaXRlcmF0aW9uLlxuICovXG5mdW5jdGlvbiBnZXRSZXNwb25zZVN0cmVhbShpbnB1dFN0cmVhbSkge1xuICAgIGNvbnN0IHJlYWRlciA9IGlucHV0U3RyZWFtLmdldFJlYWRlcigpO1xuICAgIGNvbnN0IHN0cmVhbSA9IG5ldyBSZWFkYWJsZVN0cmVhbSh7XG4gICAgICAgIHN0YXJ0KGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIGxldCBjdXJyZW50VGV4dCA9IFwiXCI7XG4gICAgICAgICAgICByZXR1cm4gcHVtcCgpO1xuICAgICAgICAgICAgZnVuY3Rpb24gcHVtcCgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVhZGVyLnJlYWQoKS50aGVuKCh7IHZhbHVlLCBkb25lIH0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VGV4dC50cmltKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVycm9yKG5ldyBHb29nbGVHZW5lcmF0aXZlQUlFcnJvcihcIkZhaWxlZCB0byBwYXJzZSBzdHJlYW1cIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGV4dCArPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoID0gY3VycmVudFRleHQubWF0Y2gocmVzcG9uc2VMaW5lUkUpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgcGFyc2VkUmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWRSZXNwb25zZSA9IEpTT04ucGFyc2UobWF0Y2hbMV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVycm9yKG5ldyBHb29nbGVHZW5lcmF0aXZlQUlFcnJvcihgRXJyb3IgcGFyc2luZyBKU09OIHJlc3BvbnNlOiBcIiR7bWF0Y2hbMV19XCJgKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHBhcnNlZFJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRUZXh0ID0gY3VycmVudFRleHQuc3Vic3RyaW5nKG1hdGNoWzBdLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaCA9IGN1cnJlbnRUZXh0Lm1hdGNoKHJlc3BvbnNlTGluZVJFKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHVtcCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgIH0pO1xuICAgIHJldHVybiBzdHJlYW07XG59XG4vKipcbiAqIEFnZ3JlZ2F0ZXMgYW4gYXJyYXkgb2YgYEdlbmVyYXRlQ29udGVudFJlc3BvbnNlYHMgaW50byBhIHNpbmdsZVxuICogR2VuZXJhdGVDb250ZW50UmVzcG9uc2UuXG4gKi9cbmZ1bmN0aW9uIGFnZ3JlZ2F0ZVJlc3BvbnNlcyhyZXNwb25zZXMpIHtcbiAgICBjb25zdCBsYXN0UmVzcG9uc2UgPSByZXNwb25zZXNbcmVzcG9uc2VzLmxlbmd0aCAtIDFdO1xuICAgIGNvbnN0IGFnZ3JlZ2F0ZWRSZXNwb25zZSA9IHtcbiAgICAgICAgcHJvbXB0RmVlZGJhY2s6IGxhc3RSZXNwb25zZSA9PT0gbnVsbCB8fCBsYXN0UmVzcG9uc2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGxhc3RSZXNwb25zZS5wcm9tcHRGZWVkYmFjayxcbiAgICB9O1xuICAgIGZvciAoY29uc3QgcmVzcG9uc2Ugb2YgcmVzcG9uc2VzKSB7XG4gICAgICAgIGlmIChyZXNwb25zZS5jYW5kaWRhdGVzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNhbmRpZGF0ZSBvZiByZXNwb25zZS5jYW5kaWRhdGVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGNhbmRpZGF0ZS5pbmRleDtcbiAgICAgICAgICAgICAgICBpZiAoIWFnZ3JlZ2F0ZWRSZXNwb25zZS5jYW5kaWRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZWRSZXNwb25zZS5jYW5kaWRhdGVzID0gW107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghYWdncmVnYXRlZFJlc3BvbnNlLmNhbmRpZGF0ZXNbaV0pIHtcbiAgICAgICAgICAgICAgICAgICAgYWdncmVnYXRlZFJlc3BvbnNlLmNhbmRpZGF0ZXNbaV0gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRleDogY2FuZGlkYXRlLmluZGV4LFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBLZWVwIG92ZXJ3cml0aW5nLCB0aGUgbGFzdCBvbmUgd2lsbCBiZSBmaW5hbFxuICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZWRSZXNwb25zZS5jYW5kaWRhdGVzW2ldLmNpdGF0aW9uTWV0YWRhdGEgPVxuICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGUuY2l0YXRpb25NZXRhZGF0YTtcbiAgICAgICAgICAgICAgICBhZ2dyZWdhdGVkUmVzcG9uc2UuY2FuZGlkYXRlc1tpXS5maW5pc2hSZWFzb24gPSBjYW5kaWRhdGUuZmluaXNoUmVhc29uO1xuICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZWRSZXNwb25zZS5jYW5kaWRhdGVzW2ldLmZpbmlzaE1lc3NhZ2UgPVxuICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGUuZmluaXNoTWVzc2FnZTtcbiAgICAgICAgICAgICAgICBhZ2dyZWdhdGVkUmVzcG9uc2UuY2FuZGlkYXRlc1tpXS5zYWZldHlSYXRpbmdzID1cbiAgICAgICAgICAgICAgICAgICAgY2FuZGlkYXRlLnNhZmV0eVJhdGluZ3M7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogQ2FuZGlkYXRlcyBzaG91bGQgYWx3YXlzIGhhdmUgY29udGVudCBhbmQgcGFydHMsIGJ1dCB0aGlzIGhhbmRsZXNcbiAgICAgICAgICAgICAgICAgKiBwb3NzaWJsZSBtYWxmb3JtZWQgcmVzcG9uc2VzLlxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmIChjYW5kaWRhdGUuY29udGVudCAmJiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWFnZ3JlZ2F0ZWRSZXNwb25zZS5jYW5kaWRhdGVzW2ldLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZWRSZXNwb25zZS5jYW5kaWRhdGVzW2ldLmNvbnRlbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm9sZTogY2FuZGlkYXRlLmNvbnRlbnQucm9sZSB8fCBcInVzZXJcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0czogW3sgdGV4dDogXCJcIiB9XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIGNhbmRpZGF0ZS5jb250ZW50LnBhcnRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFydC50ZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWdncmVnYXRlZFJlc3BvbnNlLmNhbmRpZGF0ZXNbaV0uY29udGVudC5wYXJ0c1swXS50ZXh0ICs9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnQudGV4dDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYWdncmVnYXRlZFJlc3BvbnNlO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVDb250ZW50U3RyZWFtKGFwaUtleSwgbW9kZWwsIHBhcmFtcykge1xuICAgIGNvbnN0IHVybCA9IG5ldyBSZXF1ZXN0VXJsKG1vZGVsLCBUYXNrLlNUUkVBTV9HRU5FUkFURV9DT05URU5ULCBhcGlLZXksIFxuICAgIC8qIHN0cmVhbSAqLyB0cnVlKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG1ha2VSZXF1ZXN0KHVybCwgSlNPTi5zdHJpbmdpZnkocGFyYW1zKSk7XG4gICAgcmV0dXJuIHByb2Nlc3NTdHJlYW0ocmVzcG9uc2UpO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVDb250ZW50KGFwaUtleSwgbW9kZWwsIHBhcmFtcykge1xuICAgIGNvbnN0IHVybCA9IG5ldyBSZXF1ZXN0VXJsKG1vZGVsLCBUYXNrLkdFTkVSQVRFX0NPTlRFTlQsIGFwaUtleSwgXG4gICAgLyogc3RyZWFtICovIGZhbHNlKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG1ha2VSZXF1ZXN0KHVybCwgSlNPTi5zdHJpbmdpZnkocGFyYW1zKSk7XG4gICAgY29uc3QgcmVzcG9uc2VKc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIGNvbnN0IGVuaGFuY2VkUmVzcG9uc2UgPSBhZGRIZWxwZXJzKHJlc3BvbnNlSnNvbik7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzcG9uc2U6IGVuaGFuY2VkUmVzcG9uc2UsXG4gICAgfTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmZ1bmN0aW9uIGZvcm1hdE5ld0NvbnRlbnQocmVxdWVzdCwgcm9sZSkge1xuICAgIGxldCBuZXdQYXJ0cyA9IFtdO1xuICAgIGlmICh0eXBlb2YgcmVxdWVzdCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBuZXdQYXJ0cyA9IFt7IHRleHQ6IHJlcXVlc3QgfV07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBmb3IgKGNvbnN0IHBhcnRPclN0cmluZyBvZiByZXF1ZXN0KSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHBhcnRPclN0cmluZyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIG5ld1BhcnRzLnB1c2goeyB0ZXh0OiBwYXJ0T3JTdHJpbmcgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXdQYXJ0cy5wdXNoKHBhcnRPclN0cmluZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHsgcm9sZSwgcGFydHM6IG5ld1BhcnRzIH07XG59XG5mdW5jdGlvbiBmb3JtYXRHZW5lcmF0ZUNvbnRlbnRJbnB1dChwYXJhbXMpIHtcbiAgICBpZiAocGFyYW1zLmNvbnRlbnRzKSB7XG4gICAgICAgIHJldHVybiBwYXJhbXM7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb25zdCBjb250ZW50ID0gZm9ybWF0TmV3Q29udGVudChwYXJhbXMsIFwidXNlclwiKTtcbiAgICAgICAgcmV0dXJuIHsgY29udGVudHM6IFtjb250ZW50XSB9O1xuICAgIH1cbn1cbmZ1bmN0aW9uIGZvcm1hdEVtYmVkQ29udGVudElucHV0KHBhcmFtcykge1xuICAgIGlmICh0eXBlb2YgcGFyYW1zID09PSBcInN0cmluZ1wiIHx8IEFycmF5LmlzQXJyYXkocGFyYW1zKSkge1xuICAgICAgICBjb25zdCBjb250ZW50ID0gZm9ybWF0TmV3Q29udGVudChwYXJhbXMsIFwidXNlclwiKTtcbiAgICAgICAgcmV0dXJuIHsgY29udGVudCB9O1xuICAgIH1cbiAgICByZXR1cm4gcGFyYW1zO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBEbyBub3QgbG9nIGEgbWVzc2FnZSBmb3IgdGhpcyBlcnJvci5cbiAqL1xuY29uc3QgU0lMRU5UX0VSUk9SID0gXCJTSUxFTlRfRVJST1JcIjtcbi8qKlxuICogQ2hhdFNlc3Npb24gY2xhc3MgdGhhdCBlbmFibGVzIHNlbmRpbmcgY2hhdCBtZXNzYWdlcyBhbmQgc3RvcmVzXG4gKiBoaXN0b3J5IG9mIHNlbnQgYW5kIHJlY2VpdmVkIG1lc3NhZ2VzIHNvIGZhci5cbiAqXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIENoYXRTZXNzaW9uIHtcbiAgICBjb25zdHJ1Y3RvcihhcGlLZXksIG1vZGVsLCBwYXJhbXMpIHtcbiAgICAgICAgdGhpcy5tb2RlbCA9IG1vZGVsO1xuICAgICAgICB0aGlzLnBhcmFtcyA9IHBhcmFtcztcbiAgICAgICAgdGhpcy5faGlzdG9yeSA9IFtdO1xuICAgICAgICB0aGlzLl9zZW5kUHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICB0aGlzLl9hcGlLZXkgPSBhcGlLZXk7XG4gICAgICAgIGlmIChwYXJhbXMgPT09IG51bGwgfHwgcGFyYW1zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwYXJhbXMuaGlzdG9yeSkge1xuICAgICAgICAgICAgdGhpcy5faGlzdG9yeSA9IHBhcmFtcy5oaXN0b3J5Lm1hcCgoY29udGVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICghY29udGVudC5yb2xlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3Npbmcgcm9sZSBmb3IgaGlzdG9yeSBpdGVtOiBcIiArIEpTT04uc3RyaW5naWZ5KGNvbnRlbnQpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZvcm1hdE5ld0NvbnRlbnQoY29udGVudC5wYXJ0cywgY29udGVudC5yb2xlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGNoYXQgaGlzdG9yeSBzbyBmYXIuIEJsb2NrZWQgcHJvbXB0cyBhcmUgbm90IGFkZGVkIHRvIGhpc3RvcnkuXG4gICAgICogQmxvY2tlZCBjYW5kaWRhdGVzIGFyZSBub3QgYWRkZWQgdG8gaGlzdG9yeSwgbm9yIGFyZSB0aGUgcHJvbXB0cyB0aGF0XG4gICAgICogZ2VuZXJhdGVkIHRoZW0uXG4gICAgICovXG4gICAgYXN5bmMgZ2V0SGlzdG9yeSgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5fc2VuZFByb21pc2U7XG4gICAgICAgIHJldHVybiB0aGlzLl9oaXN0b3J5O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZW5kcyBhIGNoYXQgbWVzc2FnZSBhbmQgcmVjZWl2ZXMgYSBub24tc3RyZWFtaW5nXG4gICAgICoge0BsaW5rIEdlbmVyYXRlQ29udGVudFJlc3VsdH1cbiAgICAgKi9cbiAgICBhc3luYyBzZW5kTWVzc2FnZShyZXF1ZXN0KSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIGF3YWl0IHRoaXMuX3NlbmRQcm9taXNlO1xuICAgICAgICBjb25zdCBuZXdDb250ZW50ID0gZm9ybWF0TmV3Q29udGVudChyZXF1ZXN0LCBcInVzZXJcIik7XG4gICAgICAgIGNvbnN0IGdlbmVyYXRlQ29udGVudFJlcXVlc3QgPSB7XG4gICAgICAgICAgICBzYWZldHlTZXR0aW5nczogKF9hID0gdGhpcy5wYXJhbXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zYWZldHlTZXR0aW5ncyxcbiAgICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IChfYiA9IHRoaXMucGFyYW1zKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZ2VuZXJhdGlvbkNvbmZpZyxcbiAgICAgICAgICAgIGNvbnRlbnRzOiBbLi4udGhpcy5faGlzdG9yeSwgbmV3Q29udGVudF0sXG4gICAgICAgIH07XG4gICAgICAgIGxldCBmaW5hbFJlc3VsdDtcbiAgICAgICAgLy8gQWRkIG9udG8gdGhlIGNoYWluLlxuICAgICAgICB0aGlzLl9zZW5kUHJvbWlzZSA9IHRoaXMuX3NlbmRQcm9taXNlXG4gICAgICAgICAgICAudGhlbigoKSA9PiBnZW5lcmF0ZUNvbnRlbnQodGhpcy5fYXBpS2V5LCB0aGlzLm1vZGVsLCBnZW5lcmF0ZUNvbnRlbnRSZXF1ZXN0KSlcbiAgICAgICAgICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQucmVzcG9uc2UuY2FuZGlkYXRlcyAmJlxuICAgICAgICAgICAgICAgIHJlc3VsdC5yZXNwb25zZS5jYW5kaWRhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oaXN0b3J5LnB1c2gobmV3Q29udGVudCk7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VDb250ZW50ID0gT2JqZWN0LmFzc2lnbih7IHBhcnRzOiBbXSwgXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlc3BvbnNlIHNlZW1zIHRvIGNvbWUgYmFjayB3aXRob3V0IGEgcm9sZSBzZXQuXG4gICAgICAgICAgICAgICAgICAgIHJvbGU6IFwibW9kZWxcIiB9LCAoX2EgPSByZXN1bHQucmVzcG9uc2UuY2FuZGlkYXRlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hWzBdLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2hpc3RvcnkucHVzaChyZXNwb25zZUNvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYmxvY2tFcnJvck1lc3NhZ2UgPSBmb3JtYXRCbG9ja0Vycm9yTWVzc2FnZShyZXN1bHQucmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIGlmIChibG9ja0Vycm9yTWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYHNlbmRNZXNzYWdlKCkgd2FzIHVuc3VjY2Vzc2Z1bC4gJHtibG9ja0Vycm9yTWVzc2FnZX0uIEluc3BlY3QgcmVzcG9uc2Ugb2JqZWN0IGZvciBkZXRhaWxzLmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZpbmFsUmVzdWx0ID0gcmVzdWx0O1xuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgdGhpcy5fc2VuZFByb21pc2U7XG4gICAgICAgIHJldHVybiBmaW5hbFJlc3VsdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYSBjaGF0IG1lc3NhZ2UgYW5kIHJlY2VpdmVzIHRoZSByZXNwb25zZSBhcyBhXG4gICAgICoge0BsaW5rIEdlbmVyYXRlQ29udGVudFN0cmVhbVJlc3VsdH0gY29udGFpbmluZyBhbiBpdGVyYWJsZSBzdHJlYW1cbiAgICAgKiBhbmQgYSByZXNwb25zZSBwcm9taXNlLlxuICAgICAqL1xuICAgIGFzeW5jIHNlbmRNZXNzYWdlU3RyZWFtKHJlcXVlc3QpIHtcbiAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgYXdhaXQgdGhpcy5fc2VuZFByb21pc2U7XG4gICAgICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBmb3JtYXROZXdDb250ZW50KHJlcXVlc3QsIFwidXNlclwiKTtcbiAgICAgICAgY29uc3QgZ2VuZXJhdGVDb250ZW50UmVxdWVzdCA9IHtcbiAgICAgICAgICAgIHNhZmV0eVNldHRpbmdzOiAoX2EgPSB0aGlzLnBhcmFtcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNhZmV0eVNldHRpbmdzLFxuICAgICAgICAgICAgZ2VuZXJhdGlvbkNvbmZpZzogKF9iID0gdGhpcy5wYXJhbXMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5nZW5lcmF0aW9uQ29uZmlnLFxuICAgICAgICAgICAgY29udGVudHM6IFsuLi50aGlzLl9oaXN0b3J5LCBuZXdDb250ZW50XSxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgc3RyZWFtUHJvbWlzZSA9IGdlbmVyYXRlQ29udGVudFN0cmVhbSh0aGlzLl9hcGlLZXksIHRoaXMubW9kZWwsIGdlbmVyYXRlQ29udGVudFJlcXVlc3QpO1xuICAgICAgICAvLyBBZGQgb250byB0aGUgY2hhaW4uXG4gICAgICAgIHRoaXMuX3NlbmRQcm9taXNlID0gdGhpcy5fc2VuZFByb21pc2VcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHN0cmVhbVByb21pc2UpXG4gICAgICAgICAgICAvLyBUaGlzIG11c3QgYmUgaGFuZGxlZCB0byBhdm9pZCB1bmhhbmRsZWQgcmVqZWN0aW9uLCBidXQganVtcFxuICAgICAgICAgICAgLy8gdG8gdGhlIGZpbmFsIGNhdGNoIGJsb2NrIHdpdGggYSBsYWJlbCB0byBub3QgbG9nIHRoaXMgZXJyb3IuXG4gICAgICAgICAgICAuY2F0Y2goKF9pZ25vcmVkKSA9PiB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoU0lMRU5UX0VSUk9SKTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKChzdHJlYW1SZXN1bHQpID0+IHN0cmVhbVJlc3VsdC5yZXNwb25zZSlcbiAgICAgICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmNhbmRpZGF0ZXMgJiYgcmVzcG9uc2UuY2FuZGlkYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGlzdG9yeS5wdXNoKG5ld0NvbnRlbnQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlQ29udGVudCA9IE9iamVjdC5hc3NpZ24oe30sIHJlc3BvbnNlLmNhbmRpZGF0ZXNbMF0uY29udGVudCk7XG4gICAgICAgICAgICAgICAgLy8gUmVzcG9uc2Ugc2VlbXMgdG8gY29tZSBiYWNrIHdpdGhvdXQgYSByb2xlIHNldC5cbiAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlQ29udGVudC5yb2xlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlQ29udGVudC5yb2xlID0gXCJtb2RlbFwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9oaXN0b3J5LnB1c2gocmVzcG9uc2VDb250ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJsb2NrRXJyb3JNZXNzYWdlID0gZm9ybWF0QmxvY2tFcnJvck1lc3NhZ2UocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIGlmIChibG9ja0Vycm9yTWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYHNlbmRNZXNzYWdlU3RyZWFtKCkgd2FzIHVuc3VjY2Vzc2Z1bC4gJHtibG9ja0Vycm9yTWVzc2FnZX0uIEluc3BlY3QgcmVzcG9uc2Ugb2JqZWN0IGZvciBkZXRhaWxzLmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZSkgPT4ge1xuICAgICAgICAgICAgLy8gRXJyb3JzIGluIHN0cmVhbVByb21pc2UgYXJlIGFscmVhZHkgY2F0Y2hhYmxlIGJ5IHRoZSB1c2VyIGFzXG4gICAgICAgICAgICAvLyBzdHJlYW1Qcm9taXNlIGlzIHJldHVybmVkLlxuICAgICAgICAgICAgLy8gQXZvaWQgZHVwbGljYXRpbmcgdGhlIGVycm9yIG1lc3NhZ2UgaW4gbG9ncy5cbiAgICAgICAgICAgIGlmIChlLm1lc3NhZ2UgIT09IFNJTEVOVF9FUlJPUikge1xuICAgICAgICAgICAgICAgIC8vIFVzZXJzIGRvIG5vdCBoYXZlIGFjY2VzcyB0byBfc2VuZFByb21pc2UgdG8gY2F0Y2ggZXJyb3JzXG4gICAgICAgICAgICAgICAgLy8gZG93bnN0cmVhbSBmcm9tIHN0cmVhbVByb21pc2UsIHNvIHRoZXkgc2hvdWxkIG5vdCB0aHJvdy5cbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHN0cmVhbVByb21pc2U7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gY291bnRUb2tlbnMoYXBpS2V5LCBtb2RlbCwgcGFyYW1zKSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFJlcXVlc3RVcmwobW9kZWwsIFRhc2suQ09VTlRfVE9LRU5TLCBhcGlLZXksIGZhbHNlKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG1ha2VSZXF1ZXN0KHVybCwgSlNPTi5zdHJpbmdpZnkoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBwYXJhbXMpLCB7IG1vZGVsIH0pKSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGVtYmVkQ29udGVudChhcGlLZXksIG1vZGVsLCBwYXJhbXMpIHtcbiAgICBjb25zdCB1cmwgPSBuZXcgUmVxdWVzdFVybChtb2RlbCwgVGFzay5FTUJFRF9DT05URU5ULCBhcGlLZXksIGZhbHNlKTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG1ha2VSZXF1ZXN0KHVybCwgSlNPTi5zdHJpbmdpZnkocGFyYW1zKSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGJhdGNoRW1iZWRDb250ZW50cyhhcGlLZXksIG1vZGVsLCBwYXJhbXMpIHtcbiAgICBjb25zdCB1cmwgPSBuZXcgUmVxdWVzdFVybChtb2RlbCwgVGFzay5CQVRDSF9FTUJFRF9DT05URU5UUywgYXBpS2V5LCBmYWxzZSk7XG4gICAgY29uc3QgcmVxdWVzdHNXaXRoTW9kZWwgPSBwYXJhbXMucmVxdWVzdHMubWFwKChyZXF1ZXN0KSA9PiB7XG4gICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHJlcXVlc3QpLCB7IG1vZGVsOiBgbW9kZWxzLyR7bW9kZWx9YCB9KTtcbiAgICB9KTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IG1ha2VSZXF1ZXN0KHVybCwgSlNPTi5zdHJpbmdpZnkoeyByZXF1ZXN0czogcmVxdWVzdHNXaXRoTW9kZWwgfSkpO1xuICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIENsYXNzIGZvciBnZW5lcmF0aXZlIG1vZGVsIEFQSXMuXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIEdlbmVyYXRpdmVNb2RlbCB7XG4gICAgY29uc3RydWN0b3IoYXBpS2V5LCBtb2RlbFBhcmFtcykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHRoaXMuYXBpS2V5ID0gYXBpS2V5O1xuICAgICAgICBpZiAobW9kZWxQYXJhbXMubW9kZWwuc3RhcnRzV2l0aChcIm1vZGVscy9cIikpIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwgPSAoX2EgPSBtb2RlbFBhcmFtcy5tb2RlbC5zcGxpdChcIm1vZGVscy9cIikpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYVsxXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwgPSBtb2RlbFBhcmFtcy5tb2RlbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmdlbmVyYXRpb25Db25maWcgPSBtb2RlbFBhcmFtcy5nZW5lcmF0aW9uQ29uZmlnIHx8IHt9O1xuICAgICAgICB0aGlzLnNhZmV0eVNldHRpbmdzID0gbW9kZWxQYXJhbXMuc2FmZXR5U2V0dGluZ3MgfHwgW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ha2VzIGEgc2luZ2xlIG5vbi1zdHJlYW1pbmcgY2FsbCB0byB0aGUgbW9kZWxcbiAgICAgKiBhbmQgcmV0dXJucyBhbiBvYmplY3QgY29udGFpbmluZyBhIHNpbmdsZSB7QGxpbmsgR2VuZXJhdGVDb250ZW50UmVzcG9uc2V9LlxuICAgICAqL1xuICAgIGFzeW5jIGdlbmVyYXRlQ29udGVudChyZXF1ZXN0KSB7XG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZFBhcmFtcyA9IGZvcm1hdEdlbmVyYXRlQ29udGVudElucHV0KHJlcXVlc3QpO1xuICAgICAgICByZXR1cm4gZ2VuZXJhdGVDb250ZW50KHRoaXMuYXBpS2V5LCB0aGlzLm1vZGVsLCBPYmplY3QuYXNzaWduKHsgZ2VuZXJhdGlvbkNvbmZpZzogdGhpcy5nZW5lcmF0aW9uQ29uZmlnLCBzYWZldHlTZXR0aW5nczogdGhpcy5zYWZldHlTZXR0aW5ncyB9LCBmb3JtYXR0ZWRQYXJhbXMpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTWFrZXMgYSBzaW5nbGUgc3RyZWFtaW5nIGNhbGwgdG8gdGhlIG1vZGVsXG4gICAgICogYW5kIHJldHVybnMgYW4gb2JqZWN0IGNvbnRhaW5pbmcgYW4gaXRlcmFibGUgc3RyZWFtIHRoYXQgaXRlcmF0ZXNcbiAgICAgKiBvdmVyIGFsbCBjaHVua3MgaW4gdGhlIHN0cmVhbWluZyByZXNwb25zZSBhcyB3ZWxsIGFzXG4gICAgICogYSBwcm9taXNlIHRoYXQgcmV0dXJucyB0aGUgZmluYWwgYWdncmVnYXRlZCByZXNwb25zZS5cbiAgICAgKi9cbiAgICBhc3luYyBnZW5lcmF0ZUNvbnRlbnRTdHJlYW0ocmVxdWVzdCkge1xuICAgICAgICBjb25zdCBmb3JtYXR0ZWRQYXJhbXMgPSBmb3JtYXRHZW5lcmF0ZUNvbnRlbnRJbnB1dChyZXF1ZXN0KTtcbiAgICAgICAgcmV0dXJuIGdlbmVyYXRlQ29udGVudFN0cmVhbSh0aGlzLmFwaUtleSwgdGhpcy5tb2RlbCwgT2JqZWN0LmFzc2lnbih7IGdlbmVyYXRpb25Db25maWc6IHRoaXMuZ2VuZXJhdGlvbkNvbmZpZywgc2FmZXR5U2V0dGluZ3M6IHRoaXMuc2FmZXR5U2V0dGluZ3MgfSwgZm9ybWF0dGVkUGFyYW1zKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgYSBuZXcge0BsaW5rIENoYXRTZXNzaW9ufSBpbnN0YW5jZSB3aGljaCBjYW4gYmUgdXNlZCBmb3JcbiAgICAgKiBtdWx0aS10dXJuIGNoYXRzLlxuICAgICAqL1xuICAgIHN0YXJ0Q2hhdChzdGFydENoYXRQYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDaGF0U2Vzc2lvbih0aGlzLmFwaUtleSwgdGhpcy5tb2RlbCwgc3RhcnRDaGF0UGFyYW1zKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ291bnRzIHRoZSB0b2tlbnMgaW4gdGhlIHByb3ZpZGVkIHJlcXVlc3QuXG4gICAgICovXG4gICAgYXN5bmMgY291bnRUb2tlbnMocmVxdWVzdCkge1xuICAgICAgICBjb25zdCBmb3JtYXR0ZWRQYXJhbXMgPSBmb3JtYXRHZW5lcmF0ZUNvbnRlbnRJbnB1dChyZXF1ZXN0KTtcbiAgICAgICAgcmV0dXJuIGNvdW50VG9rZW5zKHRoaXMuYXBpS2V5LCB0aGlzLm1vZGVsLCBmb3JtYXR0ZWRQYXJhbXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbWJlZHMgdGhlIHByb3ZpZGVkIGNvbnRlbnQuXG4gICAgICovXG4gICAgYXN5bmMgZW1iZWRDb250ZW50KHJlcXVlc3QpIHtcbiAgICAgICAgY29uc3QgZm9ybWF0dGVkUGFyYW1zID0gZm9ybWF0RW1iZWRDb250ZW50SW5wdXQocmVxdWVzdCk7XG4gICAgICAgIHJldHVybiBlbWJlZENvbnRlbnQodGhpcy5hcGlLZXksIHRoaXMubW9kZWwsIGZvcm1hdHRlZFBhcmFtcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVtYmVkcyBhbiBhcnJheSBvZiB7QGxpbmsgRW1iZWRDb250ZW50UmVxdWVzdH1zLlxuICAgICAqL1xuICAgIGFzeW5jIGJhdGNoRW1iZWRDb250ZW50cyhiYXRjaEVtYmVkQ29udGVudFJlcXVlc3QpIHtcbiAgICAgICAgcmV0dXJuIGJhdGNoRW1iZWRDb250ZW50cyh0aGlzLmFwaUtleSwgdGhpcy5tb2RlbCwgYmF0Y2hFbWJlZENvbnRlbnRSZXF1ZXN0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRvcC1sZXZlbCBjbGFzcyBmb3IgdGhpcyBTREtcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgR29vZ2xlR2VuZXJhdGl2ZUFJIHtcbiAgICBjb25zdHJ1Y3RvcihhcGlLZXkpIHtcbiAgICAgICAgdGhpcy5hcGlLZXkgPSBhcGlLZXk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgYSB7QGxpbmsgR2VuZXJhdGl2ZU1vZGVsfSBpbnN0YW5jZSBmb3IgdGhlIHByb3ZpZGVkIG1vZGVsIG5hbWUuXG4gICAgICovXG4gICAgZ2V0R2VuZXJhdGl2ZU1vZGVsKG1vZGVsUGFyYW1zKSB7XG4gICAgICAgIGlmICghbW9kZWxQYXJhbXMubW9kZWwpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBHb29nbGVHZW5lcmF0aXZlQUlFcnJvcihgTXVzdCBwcm92aWRlIGEgbW9kZWwgbmFtZS4gYCArXG4gICAgICAgICAgICAgICAgYEV4YW1wbGU6IGdlbmFpLmdldEdlbmVyYXRpdmVNb2RlbCh7IG1vZGVsOiAnbXktbW9kZWwtbmFtZScgfSlgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IEdlbmVyYXRpdmVNb2RlbCh0aGlzLmFwaUtleSwgbW9kZWxQYXJhbXMpO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgQmxvY2tSZWFzb24sIENoYXRTZXNzaW9uLCBGaW5pc2hSZWFzb24sIEdlbmVyYXRpdmVNb2RlbCwgR29vZ2xlR2VuZXJhdGl2ZUFJLCBIYXJtQmxvY2tUaHJlc2hvbGQsIEhhcm1DYXRlZ29yeSwgSGFybVByb2JhYmlsaXR5LCBUYXNrVHlwZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcFxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHNCQUFzRTs7O0FDb0J0RSxJQUFJO0FBQUEsQ0FDSCxTQUFVQSxlQUFjO0FBQ3JCLEVBQUFBLGNBQWEsMkJBQTJCLElBQUk7QUFDNUMsRUFBQUEsY0FBYSwyQkFBMkIsSUFBSTtBQUM1QyxFQUFBQSxjQUFhLGlDQUFpQyxJQUFJO0FBQ2xELEVBQUFBLGNBQWEsMEJBQTBCLElBQUk7QUFDM0MsRUFBQUEsY0FBYSxpQ0FBaUMsSUFBSTtBQUN0RCxHQUFHLGlCQUFpQixlQUFlLENBQUMsRUFBRTtBQUt0QyxJQUFJO0FBQUEsQ0FDSCxTQUFVQyxxQkFBb0I7QUFFM0IsRUFBQUEsb0JBQW1CLGtDQUFrQyxJQUFJO0FBRXpELEVBQUFBLG9CQUFtQixxQkFBcUIsSUFBSTtBQUU1QyxFQUFBQSxvQkFBbUIsd0JBQXdCLElBQUk7QUFFL0MsRUFBQUEsb0JBQW1CLGlCQUFpQixJQUFJO0FBRXhDLEVBQUFBLG9CQUFtQixZQUFZLElBQUk7QUFDdkMsR0FBRyx1QkFBdUIscUJBQXFCLENBQUMsRUFBRTtBQUtsRCxJQUFJO0FBQUEsQ0FDSCxTQUFVQyxrQkFBaUI7QUFFeEIsRUFBQUEsaUJBQWdCLDhCQUE4QixJ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QixZQUFJLENBQUMsS0FBSyxlQUFlLEdBQUc7QUFDeEIscUJBQVc7QUFBQTtBQUFBO0FBQ1g7QUFBQSxRQUNKO0FBRUEsY0FBTSxZQUFZLE1BQU0sS0FBSyxVQUFVLEtBQUs7QUFDNUMsWUFBSSxVQUFVLFFBQVE7QUFDbEIsZ0JBQU0sVUFBVSxNQUFNLEtBQUssZ0JBQWdCLFNBQVM7QUFDcEQscUJBQVcsVUFBVTtBQUFBLFFBQ3pCLE9BQU87QUFDSCxxQkFBVyw0QkFBNEI7QUFBQTtBQUFBO0FBQUEsUUFDM0M7QUFBQSxNQUNKO0FBR0EsVUFBSSxnQkFBZ0IsU0FBUyxLQUFLLFNBQVMsT0FBTyxRQUFRO0FBQ3RELG1CQUFXO0FBQUE7QUFBQTtBQUNYLG1CQUFXO0FBQUE7QUFBQTtBQUVYLGNBQU0sZ0JBQWdCLEtBQUssU0FBUyxPQUFPLE9BQU8sV0FBUyxDQUFDLGdCQUFnQixTQUFTLEtBQUssQ0FBQztBQUMzRixzQkFBYyxRQUFRLFdBQVM7QUFDM0IscUJBQVcsS0FBSztBQUFBO0FBQUEsUUFDcEIsQ0FBQztBQUNELG1CQUFXO0FBQUE7QUFBQSxNQUNmO0FBRUEsWUFBTSxXQUFXLEdBQUcsS0FBSyxTQUFTLDhCQUE4QjtBQUNoRSxZQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sVUFBVSxPQUFPO0FBRTdDLFVBQUksS0FBSyxTQUFTLHFCQUFxQjtBQUNuQyxZQUFJLHVCQUFPLG1DQUFtQztBQUFBLE1BQ2xEO0FBRUEsVUFBSSxLQUFLLGVBQWU7QUFDcEIsYUFBSyxnQkFBZ0I7QUFBQSxNQUN6QjtBQUFBLElBQ0osU0FBUyxPQUFQO0FBQ0UsY0FBUSxNQUFNLDRCQUE0QixLQUFLO0FBQy9DLFVBQUksS0FBSyxTQUFTLHFCQUFxQjtBQUNuQyxZQUFJLHVCQUFPLHFEQUFxRDtBQUFBLE1BQ3BFO0FBRUEsVUFBSSxLQUFLLGVBQWU7QUFDcEIsYUFBSyxjQUFjLFFBQVEsdUJBQWdCO0FBQUEsTUFDL0M7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBYyxjQUFzQztBQUNoRCxRQUFJLENBQUMsS0FBSyxTQUFTO0FBQWMsYUFBTztBQUV4QyxRQUFJO0FBQ0EsWUFBTSxlQUFlLEtBQUssSUFBSSxNQUFNLHNCQUFzQixLQUFLLFNBQVMsWUFBWTtBQUNwRixVQUFJLHdCQUF3Qix1QkFBTztBQUMvQixlQUFPLE1BQU0sS0FBSyxJQUFJLE1BQU0sS0FBSyxZQUFZO0FBQUEsTUFDakQ7QUFBQSxJQUNKLFNBQVMsT0FBUDtBQUNFLGNBQVEsTUFBTSw0QkFBNEIsS0FBSztBQUFBLElBQ25EO0FBQ0EsV0FBTztBQUFBLEVBQ1g7QUFDSjsiLAogICJuYW1lcyI6IFsiSGFybUNhdGVnb3J5IiwgIkhhcm1CbG9ja1RocmVzaG9sZCIsICJIYXJtUHJvYmFiaWxpdHkiLCAiQmxvY2tSZWFzb24iLCAiRmluaXNoUmVhc29uIiwgIlRhc2tUeXBlIiwgIlRhc2siLCAiX2EiXQp9Cg==
