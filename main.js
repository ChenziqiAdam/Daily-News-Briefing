/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => DailyNewsPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");

// node_modules/@google/generative-ai/dist/index.mjs
var HarmCategory;
(function(HarmCategory2) {
  HarmCategory2["HARM_CATEGORY_UNSPECIFIED"] = "HARM_CATEGORY_UNSPECIFIED";
  HarmCategory2["HARM_CATEGORY_HATE_SPEECH"] = "HARM_CATEGORY_HATE_SPEECH";
  HarmCategory2["HARM_CATEGORY_SEXUALLY_EXPLICIT"] = "HARM_CATEGORY_SEXUALLY_EXPLICIT";
  HarmCategory2["HARM_CATEGORY_HARASSMENT"] = "HARM_CATEGORY_HARASSMENT";
  HarmCategory2["HARM_CATEGORY_DANGEROUS_CONTENT"] = "HARM_CATEGORY_DANGEROUS_CONTENT";
})(HarmCategory || (HarmCategory = {}));
var HarmBlockThreshold;
(function(HarmBlockThreshold2) {
  HarmBlockThreshold2["HARM_BLOCK_THRESHOLD_UNSPECIFIED"] = "HARM_BLOCK_THRESHOLD_UNSPECIFIED";
  HarmBlockThreshold2["BLOCK_LOW_AND_ABOVE"] = "BLOCK_LOW_AND_ABOVE";
  HarmBlockThreshold2["BLOCK_MEDIUM_AND_ABOVE"] = "BLOCK_MEDIUM_AND_ABOVE";
  HarmBlockThreshold2["BLOCK_ONLY_HIGH"] = "BLOCK_ONLY_HIGH";
  HarmBlockThreshold2["BLOCK_NONE"] = "BLOCK_NONE";
})(HarmBlockThreshold || (HarmBlockThreshold = {}));
var HarmProbability;
(function(HarmProbability2) {
  HarmProbability2["HARM_PROBABILITY_UNSPECIFIED"] = "HARM_PROBABILITY_UNSPECIFIED";
  HarmProbability2["NEGLIGIBLE"] = "NEGLIGIBLE";
  HarmProbability2["LOW"] = "LOW";
  HarmProbability2["MEDIUM"] = "MEDIUM";
  HarmProbability2["HIGH"] = "HIGH";
})(HarmProbability || (HarmProbability = {}));
var BlockReason;
(function(BlockReason2) {
  BlockReason2["BLOCKED_REASON_UNSPECIFIED"] = "BLOCKED_REASON_UNSPECIFIED";
  BlockReason2["SAFETY"] = "SAFETY";
  BlockReason2["OTHER"] = "OTHER";
})(BlockReason || (BlockReason = {}));
var FinishReason;
(function(FinishReason2) {
  FinishReason2["FINISH_REASON_UNSPECIFIED"] = "FINISH_REASON_UNSPECIFIED";
  FinishReason2["STOP"] = "STOP";
  FinishReason2["MAX_TOKENS"] = "MAX_TOKENS";
  FinishReason2["SAFETY"] = "SAFETY";
  FinishReason2["RECITATION"] = "RECITATION";
  FinishReason2["OTHER"] = "OTHER";
})(FinishReason || (FinishReason = {}));
var TaskType;
(function(TaskType2) {
  TaskType2["TASK_TYPE_UNSPECIFIED"] = "TASK_TYPE_UNSPECIFIED";
  TaskType2["RETRIEVAL_QUERY"] = "RETRIEVAL_QUERY";
  TaskType2["RETRIEVAL_DOCUMENT"] = "RETRIEVAL_DOCUMENT";
  TaskType2["SEMANTIC_SIMILARITY"] = "SEMANTIC_SIMILARITY";
  TaskType2["CLASSIFICATION"] = "CLASSIFICATION";
  TaskType2["CLUSTERING"] = "CLUSTERING";
})(TaskType || (TaskType = {}));
var GoogleGenerativeAIError = class extends Error {
  constructor(message) {
    super(`[GoogleGenerativeAI Error]: ${message}`);
  }
};
var GoogleGenerativeAIResponseError = class extends GoogleGenerativeAIError {
  constructor(message, response) {
    super(message);
    this.response = response;
  }
};
var BASE_URL = "https://generativelanguage.googleapis.com";
var API_VERSION = "v1";
var PACKAGE_VERSION = "0.1.3";
var PACKAGE_LOG_HEADER = "genai-js";
var Task;
(function(Task2) {
  Task2["GENERATE_CONTENT"] = "generateContent";
  Task2["STREAM_GENERATE_CONTENT"] = "streamGenerateContent";
  Task2["COUNT_TOKENS"] = "countTokens";
  Task2["EMBED_CONTENT"] = "embedContent";
  Task2["BATCH_EMBED_CONTENTS"] = "batchEmbedContents";
})(Task || (Task = {}));
var RequestUrl = class {
  constructor(model, task, apiKey, stream) {
    this.model = model;
    this.task = task;
    this.apiKey = apiKey;
    this.stream = stream;
  }
  toString() {
    let url = `${BASE_URL}/${API_VERSION}/models/${this.model}:${this.task}`;
    if (this.stream) {
      url += "?alt=sse";
    }
    return url;
  }
};
function getClientHeaders() {
  return `${PACKAGE_LOG_HEADER}/${PACKAGE_VERSION}`;
}
async function makeRequest(url, body) {
  let response;
  try {
    response = await fetch(url.toString(), {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "x-goog-api-client": getClientHeaders(),
        "x-goog-api-key": url.apiKey
      },
      body
    });
    if (!response.ok) {
      let message = "";
      try {
        const json = await response.json();
        message = json.error.message;
        if (json.error.details) {
          message += ` ${JSON.stringify(json.error.details)}`;
        }
      } catch (e) {
      }
      throw new Error(`[${response.status} ${response.statusText}] ${message}`);
    }
  } catch (e) {
    const err = new GoogleGenerativeAIError(`Error fetching from ${url.toString()}: ${e.message}`);
    err.stack = e.stack;
    throw err;
  }
  return response;
}
function addHelpers(response) {
  response.text = () => {
    if (response.candidates && response.candidates.length > 0) {
      if (response.candidates.length > 1) {
        console.warn(`This response had ${response.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`);
      }
      if (hadBadFinishReason(response.candidates[0])) {
        throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(response)}`, response);
      }
      return getText(response);
    } else if (response.promptFeedback) {
      throw new GoogleGenerativeAIResponseError(`Text not available. ${formatBlockErrorMessage(response)}`, response);
    }
    return "";
  };
  return response;
}
function getText(response) {
  var _a, _b, _c, _d;
  if ((_d = (_c = (_b = (_a = response.candidates) === null || _a === void 0 ? void 0 : _a[0].content) === null || _b === void 0 ? void 0 : _b.parts) === null || _c === void 0 ? void 0 : _c[0]) === null || _d === void 0 ? void 0 : _d.text) {
    return response.candidates[0].content.parts[0].text;
  } else {
    return "";
  }
}
var badFinishReasons = [FinishReason.RECITATION, FinishReason.SAFETY];
function hadBadFinishReason(candidate) {
  return !!candidate.finishReason && badFinishReasons.includes(candidate.finishReason);
}
function formatBlockErrorMessage(response) {
  var _a, _b, _c;
  let message = "";
  if ((!response.candidates || response.candidates.length === 0) && response.promptFeedback) {
    message += "Response was blocked";
    if ((_a = response.promptFeedback) === null || _a === void 0 ? void 0 : _a.blockReason) {
      message += ` due to ${response.promptFeedback.blockReason}`;
    }
    if ((_b = response.promptFeedback) === null || _b === void 0 ? void 0 : _b.blockReasonMessage) {
      message += `: ${response.promptFeedback.blockReasonMessage}`;
    }
  } else if ((_c = response.candidates) === null || _c === void 0 ? void 0 : _c[0]) {
    const firstCandidate = response.candidates[0];
    if (hadBadFinishReason(firstCandidate)) {
      message += `Candidate was blocked due to ${firstCandidate.finishReason}`;
      if (firstCandidate.finishMessage) {
        message += `: ${firstCandidate.finishMessage}`;
      }
    }
  }
  return message;
}
function __await(v) {
  return this instanceof __await ? (this.v = v, this) : new __await(v);
}
function __asyncGenerator(thisArg, _arguments, generator) {
  if (!Symbol.asyncIterator)
    throw new TypeError("Symbol.asyncIterator is not defined.");
  var g = generator.apply(thisArg, _arguments || []), i, q = [];
  return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function() {
    return this;
  }, i;
  function verb(n) {
    if (g[n])
      i[n] = function(v) {
        return new Promise(function(a, b) {
          q.push([n, v, a, b]) > 1 || resume(n, v);
        });
      };
  }
  function resume(n, v) {
    try {
      step(g[n](v));
    } catch (e) {
      settle(q[0][3], e);
    }
  }
  function step(r) {
    r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);
  }
  function fulfill(value) {
    resume("next", value);
  }
  function reject(value) {
    resume("throw", value);
  }
  function settle(f, v) {
    if (f(v), q.shift(), q.length)
      resume(q[0][0], q[0][1]);
  }
}
var responseLineRE = /^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;
function processStream(response) {
  const inputStream = response.body.pipeThrough(new TextDecoderStream("utf8", { fatal: true }));
  const responseStream = getResponseStream(inputStream);
  const [stream1, stream2] = responseStream.tee();
  return {
    stream: generateResponseSequence(stream1),
    response: getResponsePromise(stream2)
  };
}
async function getResponsePromise(stream) {
  const allResponses = [];
  const reader = stream.getReader();
  while (true) {
    const { done, value } = await reader.read();
    if (done) {
      return addHelpers(aggregateResponses(allResponses));
    }
    allResponses.push(value);
  }
}
function generateResponseSequence(stream) {
  return __asyncGenerator(this, arguments, function* generateResponseSequence_1() {
    const reader = stream.getReader();
    while (true) {
      const { value, done } = yield __await(reader.read());
      if (done) {
        break;
      }
      yield yield __await(addHelpers(value));
    }
  });
}
function getResponseStream(inputStream) {
  const reader = inputStream.getReader();
  const stream = new ReadableStream({
    start(controller) {
      let currentText = "";
      return pump();
      function pump() {
        return reader.read().then(({ value, done }) => {
          if (done) {
            if (currentText.trim()) {
              controller.error(new GoogleGenerativeAIError("Failed to parse stream"));
              return;
            }
            controller.close();
            return;
          }
          currentText += value;
          let match = currentText.match(responseLineRE);
          let parsedResponse;
          while (match) {
            try {
              parsedResponse = JSON.parse(match[1]);
            } catch (e) {
              controller.error(new GoogleGenerativeAIError(`Error parsing JSON response: "${match[1]}"`));
              return;
            }
            controller.enqueue(parsedResponse);
            currentText = currentText.substring(match[0].length);
            match = currentText.match(responseLineRE);
          }
          return pump();
        });
      }
    }
  });
  return stream;
}
function aggregateResponses(responses) {
  const lastResponse = responses[responses.length - 1];
  const aggregatedResponse = {
    promptFeedback: lastResponse === null || lastResponse === void 0 ? void 0 : lastResponse.promptFeedback
  };
  for (const response of responses) {
    if (response.candidates) {
      for (const candidate of response.candidates) {
        const i = candidate.index;
        if (!aggregatedResponse.candidates) {
          aggregatedResponse.candidates = [];
        }
        if (!aggregatedResponse.candidates[i]) {
          aggregatedResponse.candidates[i] = {
            index: candidate.index
          };
        }
        aggregatedResponse.candidates[i].citationMetadata = candidate.citationMetadata;
        aggregatedResponse.candidates[i].finishReason = candidate.finishReason;
        aggregatedResponse.candidates[i].finishMessage = candidate.finishMessage;
        aggregatedResponse.candidates[i].safetyRatings = candidate.safetyRatings;
        if (candidate.content && candidate.content.parts) {
          if (!aggregatedResponse.candidates[i].content) {
            aggregatedResponse.candidates[i].content = {
              role: candidate.content.role || "user",
              parts: [{ text: "" }]
            };
          }
          for (const part of candidate.content.parts) {
            if (part.text) {
              aggregatedResponse.candidates[i].content.parts[0].text += part.text;
            }
          }
        }
      }
    }
  }
  return aggregatedResponse;
}
async function generateContentStream(apiKey, model, params) {
  const url = new RequestUrl(
    model,
    Task.STREAM_GENERATE_CONTENT,
    apiKey,
    /* stream */
    true
  );
  const response = await makeRequest(url, JSON.stringify(params));
  return processStream(response);
}
async function generateContent(apiKey, model, params) {
  const url = new RequestUrl(
    model,
    Task.GENERATE_CONTENT,
    apiKey,
    /* stream */
    false
  );
  const response = await makeRequest(url, JSON.stringify(params));
  const responseJson = await response.json();
  const enhancedResponse = addHelpers(responseJson);
  return {
    response: enhancedResponse
  };
}
function formatNewContent(request, role) {
  let newParts = [];
  if (typeof request === "string") {
    newParts = [{ text: request }];
  } else {
    for (const partOrString of request) {
      if (typeof partOrString === "string") {
        newParts.push({ text: partOrString });
      } else {
        newParts.push(partOrString);
      }
    }
  }
  return { role, parts: newParts };
}
function formatGenerateContentInput(params) {
  if (params.contents) {
    return params;
  } else {
    const content = formatNewContent(params, "user");
    return { contents: [content] };
  }
}
function formatEmbedContentInput(params) {
  if (typeof params === "string" || Array.isArray(params)) {
    const content = formatNewContent(params, "user");
    return { content };
  }
  return params;
}
var SILENT_ERROR = "SILENT_ERROR";
var ChatSession = class {
  constructor(apiKey, model, params) {
    this.model = model;
    this.params = params;
    this._history = [];
    this._sendPromise = Promise.resolve();
    this._apiKey = apiKey;
    if (params === null || params === void 0 ? void 0 : params.history) {
      this._history = params.history.map((content) => {
        if (!content.role) {
          throw new Error("Missing role for history item: " + JSON.stringify(content));
        }
        return formatNewContent(content.parts, content.role);
      });
    }
  }
  /**
   * Gets the chat history so far. Blocked prompts are not added to history.
   * Blocked candidates are not added to history, nor are the prompts that
   * generated them.
   */
  async getHistory() {
    await this._sendPromise;
    return this._history;
  }
  /**
   * Sends a chat message and receives a non-streaming
   * {@link GenerateContentResult}
   */
  async sendMessage(request) {
    var _a, _b;
    await this._sendPromise;
    const newContent = formatNewContent(request, "user");
    const generateContentRequest = {
      safetySettings: (_a = this.params) === null || _a === void 0 ? void 0 : _a.safetySettings,
      generationConfig: (_b = this.params) === null || _b === void 0 ? void 0 : _b.generationConfig,
      contents: [...this._history, newContent]
    };
    let finalResult;
    this._sendPromise = this._sendPromise.then(() => generateContent(this._apiKey, this.model, generateContentRequest)).then((result) => {
      var _a2;
      if (result.response.candidates && result.response.candidates.length > 0) {
        this._history.push(newContent);
        const responseContent = Object.assign({
          parts: [],
          // Response seems to come back without a role set.
          role: "model"
        }, (_a2 = result.response.candidates) === null || _a2 === void 0 ? void 0 : _a2[0].content);
        this._history.push(responseContent);
      } else {
        const blockErrorMessage = formatBlockErrorMessage(result.response);
        if (blockErrorMessage) {
          console.warn(`sendMessage() was unsuccessful. ${blockErrorMessage}. Inspect response object for details.`);
        }
      }
      finalResult = result;
    });
    await this._sendPromise;
    return finalResult;
  }
  /**
   * Sends a chat message and receives the response as a
   * {@link GenerateContentStreamResult} containing an iterable stream
   * and a response promise.
   */
  async sendMessageStream(request) {
    var _a, _b;
    await this._sendPromise;
    const newContent = formatNewContent(request, "user");
    const generateContentRequest = {
      safetySettings: (_a = this.params) === null || _a === void 0 ? void 0 : _a.safetySettings,
      generationConfig: (_b = this.params) === null || _b === void 0 ? void 0 : _b.generationConfig,
      contents: [...this._history, newContent]
    };
    const streamPromise = generateContentStream(this._apiKey, this.model, generateContentRequest);
    this._sendPromise = this._sendPromise.then(() => streamPromise).catch((_ignored) => {
      throw new Error(SILENT_ERROR);
    }).then((streamResult) => streamResult.response).then((response) => {
      if (response.candidates && response.candidates.length > 0) {
        this._history.push(newContent);
        const responseContent = Object.assign({}, response.candidates[0].content);
        if (!responseContent.role) {
          responseContent.role = "model";
        }
        this._history.push(responseContent);
      } else {
        const blockErrorMessage = formatBlockErrorMessage(response);
        if (blockErrorMessage) {
          console.warn(`sendMessageStream() was unsuccessful. ${blockErrorMessage}. Inspect response object for details.`);
        }
      }
    }).catch((e) => {
      if (e.message !== SILENT_ERROR) {
        console.error(e);
      }
    });
    return streamPromise;
  }
};
async function countTokens(apiKey, model, params) {
  const url = new RequestUrl(model, Task.COUNT_TOKENS, apiKey, false);
  const response = await makeRequest(url, JSON.stringify(Object.assign(Object.assign({}, params), { model })));
  return response.json();
}
async function embedContent(apiKey, model, params) {
  const url = new RequestUrl(model, Task.EMBED_CONTENT, apiKey, false);
  const response = await makeRequest(url, JSON.stringify(params));
  return response.json();
}
async function batchEmbedContents(apiKey, model, params) {
  const url = new RequestUrl(model, Task.BATCH_EMBED_CONTENTS, apiKey, false);
  const requestsWithModel = params.requests.map((request) => {
    return Object.assign(Object.assign({}, request), { model: `models/${model}` });
  });
  const response = await makeRequest(url, JSON.stringify({ requests: requestsWithModel }));
  return response.json();
}
var GenerativeModel = class {
  constructor(apiKey, modelParams) {
    var _a;
    this.apiKey = apiKey;
    if (modelParams.model.startsWith("models/")) {
      this.model = (_a = modelParams.model.split("models/")) === null || _a === void 0 ? void 0 : _a[1];
    } else {
      this.model = modelParams.model;
    }
    this.generationConfig = modelParams.generationConfig || {};
    this.safetySettings = modelParams.safetySettings || [];
  }
  /**
   * Makes a single non-streaming call to the model
   * and returns an object containing a single {@link GenerateContentResponse}.
   */
  async generateContent(request) {
    const formattedParams = formatGenerateContentInput(request);
    return generateContent(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings }, formattedParams));
  }
  /**
   * Makes a single streaming call to the model
   * and returns an object containing an iterable stream that iterates
   * over all chunks in the streaming response as well as
   * a promise that returns the final aggregated response.
   */
  async generateContentStream(request) {
    const formattedParams = formatGenerateContentInput(request);
    return generateContentStream(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings }, formattedParams));
  }
  /**
   * Gets a new {@link ChatSession} instance which can be used for
   * multi-turn chats.
   */
  startChat(startChatParams) {
    return new ChatSession(this.apiKey, this.model, startChatParams);
  }
  /**
   * Counts the tokens in the provided request.
   */
  async countTokens(request) {
    const formattedParams = formatGenerateContentInput(request);
    return countTokens(this.apiKey, this.model, formattedParams);
  }
  /**
   * Embeds the provided content.
   */
  async embedContent(request) {
    const formattedParams = formatEmbedContentInput(request);
    return embedContent(this.apiKey, this.model, formattedParams);
  }
  /**
   * Embeds an array of {@link EmbedContentRequest}s.
   */
  async batchEmbedContents(batchEmbedContentRequest) {
    return batchEmbedContents(this.apiKey, this.model, batchEmbedContentRequest);
  }
};
var GoogleGenerativeAI = class {
  constructor(apiKey) {
    this.apiKey = apiKey;
  }
  /**
   * Gets a {@link GenerativeModel} instance for the provided model name.
   */
  getGenerativeModel(modelParams) {
    if (!modelParams.model) {
      throw new GoogleGenerativeAIError(`Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })`);
    }
    return new GenerativeModel(this.apiKey, modelParams);
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  googleApiKey: "",
  searchEngineId: "",
  geminiApiKey: "",
  topics: ["Technology", "World News"],
  scheduleTime: "08:00",
  archiveFolder: "News Archive",
  news_number: 10,
  // Reduced to stay within API limits
  templatePath: "",
  maxRetries: 3,
  enableNotifications: true,
  sortByDate: true,
  includeMetadata: true,
  maxRetryDelay: 3e4,
  outputFormat: "detailed",
  removeAds: true,
  maxNewsPerTopic: 10,
  highlightKeywords: true,
  commonAdPatterns: [
    "Subscribe to read",
    "Sign up now",
    "Advertisement",
    "Click here to",
    "Special offer",
    "newsletters?\\b",
    "\\[\\d+\\]",
    "\xA9\\s*\\d{4}",
    "cookie",
    "subscribe",
    "sign up",
    "for more information",
    "privacy policy",
    "terms of service",
    "all rights reserved"
  ],
  minSnippetLength: 100,
  excludedDomains: [],
  preferredDomains: [],
  searchDateRange: "d2",
  contentRelevanceScore: 6,
  enableSourceRanking: true,
  searchExactPhrases: [],
  searchExcludeTerms: [],
  useAdvancedFiltering: true,
  conserveApiCalls: true,
  // Default to conserving API calls
  apiCallsPerDay: 100,
  // Default limit
  useEnhancedSearchQueries: true
  // Default to using enhanced queries
};
var QUALITY_NEWS_SOURCES = [
  "nytimes.com",
  "bbc.com",
  "reuters.com",
  "apnews.com",
  "economist.com",
  "wsj.com",
  "ft.com",
  "bloomberg.com",
  "theguardian.com",
  "npr.org",
  "washingtonpost.com",
  "aljazeera.com",
  "nature.com",
  "time.com",
  "wired.com",
  "theatlantic.com",
  "newyorker.com",
  "scientificamerican.com",
  "cnbc.com",
  "fortune.com",
  "techcrunch.com",
  "thenextweb.com",
  "arstechnica.com"
];
var DailyNewsSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Daily News Settings" });
    if (this.plugin.settings.conserveApiCalls) {
      const apiInfo = containerEl.createEl("div", {
        cls: "api-usage-info"
      });
      apiInfo.createEl("p", {
        text: `API Usage Today: ${this.plugin.apiCallsToday}/${this.plugin.settings.apiCallsPerDay} calls`
      });
    }
    const apiSection = containerEl.createEl("div");
    apiSection.createEl("h3", { text: "API Configuration" });
    new import_obsidian.Setting(apiSection).setName("Google API Key").setDesc("Your Google Custom Search API key").addText((text) => text.setPlaceholder("Enter API key").setValue(this.plugin.settings.googleApiKey).onChange(async (value) => {
      this.plugin.settings.googleApiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(apiSection).setName("Search Engine ID").setDesc("Your Google Custom Search Engine ID").addText((text) => text.setPlaceholder("Enter Search Engine ID").setValue(this.plugin.settings.searchEngineId).onChange(async (value) => {
      this.plugin.settings.searchEngineId = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(apiSection).setName("Gemini API Key").setDesc("Your Google Gemini API key").addText((text) => text.setPlaceholder("Enter Gemini API key").setValue(this.plugin.settings.geminiApiKey).onChange(async (value) => {
      this.plugin.settings.geminiApiKey = value;
      await this.plugin.saveSettings();
    }));
    const newsSection = containerEl.createEl("div");
    newsSection.createEl("h3", { text: "Basic News Preferences" });
    new import_obsidian.Setting(newsSection).setName("Schedule Time").setDesc("When to generate daily news (24-hour format)").addText((text) => text.setPlaceholder("HH:MM").setValue(this.plugin.settings.scheduleTime).onChange(async (value) => {
      this.plugin.settings.scheduleTime = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(newsSection).setName("Archive Folder").setDesc("Folder to store daily news notes").addText((text) => text.setPlaceholder("News Archive").setValue(this.plugin.settings.archiveFolder).onChange(async (value) => {
      this.plugin.settings.archiveFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(newsSection).setName("Topics").setDesc("News topics to follow (comma-separated)").addText((text) => text.setPlaceholder("Technology, World News").setValue(this.plugin.settings.topics.join(", ")).onChange(async (value) => {
      this.plugin.settings.topics = value.split(",").map((t) => t.trim());
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(newsSection).setName("Template File").setDesc("Custom template file path (optional)").addText((text) => text.setPlaceholder("templates/news-template.md").setValue(this.plugin.settings.templatePath).onChange(async (value) => {
      this.plugin.settings.templatePath = value;
      await this.plugin.saveSettings();
    }));
    const apiUsageSection = containerEl.createEl("div");
    apiUsageSection.createEl("h3", { text: "API Usage Management" });
    new import_obsidian.Setting(apiUsageSection).setName("Conserve API Calls").setDesc("Enable to limit API calls and prevent quota exhaustion").addToggle((toggle) => toggle.setValue(this.plugin.settings.conserveApiCalls).onChange(async (value) => {
      this.plugin.settings.conserveApiCalls = value;
      await this.plugin.saveSettings();
      this.display();
    }));
    if (this.plugin.settings.conserveApiCalls) {
      new import_obsidian.Setting(apiUsageSection).setName("Daily API Call Limit").setDesc("Maximum number of API calls to make per day").addText((text) => text.setPlaceholder("100").setValue(this.plugin.settings.apiCallsPerDay.toString()).onChange(async (value) => {
        const parsedValue = parseInt(value);
        this.plugin.settings.apiCallsPerDay = isNaN(parsedValue) ? 100 : parsedValue;
        await this.plugin.saveSettings();
      }));
      new import_obsidian.Setting(apiUsageSection).setName("Reset API Counter").setDesc("Reset today's API call counter").addButton((button) => button.setButtonText("Reset Counter").onClick(async () => {
        this.plugin.apiCallsToday = 0;
        this.plugin.updateStatusBar();
        this.display();
        new import_obsidian.Notice("API call counter reset to 0");
      }));
    }
    const searchQualitySection = containerEl.createEl("div");
    searchQualitySection.createEl("h3", { text: "Search Quality" });
    new import_obsidian.Setting(searchQualitySection).setName("Use Enhanced Search Queries").setDesc("Use topic-specific optimized search queries to find better news articles").addToggle((toggle) => toggle.setValue(this.plugin.settings.useEnhancedSearchQueries).onChange(async (value) => {
      this.plugin.settings.useEnhancedSearchQueries = value;
      await this.plugin.saveSettings();
    }));
    const searchSection = containerEl.createEl("div");
    searchSection.createEl("h3", { text: "Advanced Search Settings" });
    new import_obsidian.Setting(searchSection).setName("Search Date Range").setDesc("How far back to search (d1 = 1 day, d2 = 2 days, w1 = 1 week)").addText((text) => text.setPlaceholder("d2").setValue(this.plugin.settings.searchDateRange).onChange(async (value) => {
      this.plugin.settings.searchDateRange = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("News Results Per Topic").setDesc("Maximum number of news results to retrieve per topic (via pagination)").addText((text) => text.setPlaceholder("20").setValue(this.plugin.settings.news_number.toString()).onChange(async (value) => {
      const parsedValue = parseInt(value);
      this.plugin.settings.news_number = isNaN(parsedValue) ? 20 : parsedValue;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Max News Items Per Summary").setDesc("Maximum number of news items to include in the summary").addText((text) => text.setPlaceholder("8").setValue(this.plugin.settings.maxNewsPerTopic.toString()).onChange(async (value) => {
      const parsedValue = parseInt(value);
      this.plugin.settings.maxNewsPerTopic = isNaN(parsedValue) ? 10 : parsedValue;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Minimum Content Length").setDesc("Minimum length for news snippets to be considered").addText((text) => text.setPlaceholder("100").setValue(this.plugin.settings.minSnippetLength.toString()).onChange(async (value) => {
      const parsedValue = parseInt(value);
      this.plugin.settings.minSnippetLength = isNaN(parsedValue) ? 100 : parsedValue;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Preferred Domains").setDesc("Comma-separated list of preferred domains (e.g., nytimes.com, bbc.com)").addText((text) => text.setPlaceholder("nytimes.com, bbc.com").setValue(this.plugin.settings.preferredDomains.join(", ")).onChange(async (value) => {
      this.plugin.settings.preferredDomains = value.split(",").map((d) => d.trim());
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Excluded Domains").setDesc("Comma-separated list of domains to exclude").addText((text) => text.setPlaceholder("pinterest.com, facebook.com").setValue(this.plugin.settings.excludedDomains.join(", ")).onChange(async (value) => {
      this.plugin.settings.excludedDomains = value.split(",").map((d) => d.trim());
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Exact Phrases to Include").setDesc("Comma-separated list of exact phrases to include in search").addText((text) => text.setPlaceholder("latest developments, new research").setValue(this.plugin.settings.searchExactPhrases.join(", ")).onChange(async (value) => {
      this.plugin.settings.searchExactPhrases = value.split(",").map((p) => p.trim());
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(searchSection).setName("Terms to Exclude").setDesc("Comma-separated list of terms to exclude from search").addText((text) => text.setPlaceholder("clickbait, rumor, opinion").setValue(this.plugin.settings.searchExcludeTerms.join(", ")).onChange(async (value) => {
      this.plugin.settings.searchExcludeTerms = value.split(",").map((t) => t.trim());
      await this.plugin.saveSettings();
    }));
    const qualitySection = containerEl.createEl("div");
    qualitySection.createEl("h3", { text: "Content Quality Settings" });
    new import_obsidian.Setting(qualitySection).setName("Enable Advanced Filtering").setDesc("Apply advanced filtering to improve news quality").addToggle((toggle) => toggle.setValue(this.plugin.settings.useAdvancedFiltering).onChange(async (value) => {
      this.plugin.settings.useAdvancedFiltering = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(qualitySection).setName("Enable Source Ranking").setDesc("Prioritize high-quality news sources").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableSourceRanking).onChange(async (value) => {
      this.plugin.settings.enableSourceRanking = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(qualitySection).setName("Minimum Relevance Score").setDesc("Minimum relevance score for news (1-10)").addSlider((slider) => slider.setLimits(1, 10, 1).setValue(this.plugin.settings.contentRelevanceScore).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.contentRelevanceScore = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(qualitySection).setName("Remove Ads and Promotions").setDesc("Clean promotional content from news").addToggle((toggle) => toggle.setValue(this.plugin.settings.removeAds).onChange(async (value) => {
      this.plugin.settings.removeAds = value;
      await this.plugin.saveSettings();
    }));
    const formatSection = containerEl.createEl("div");
    formatSection.createEl("h3", { text: "Output Format" });
    new import_obsidian.Setting(formatSection).setName("Output Style").setDesc("Choose between detailed or concise news format").addDropdown((dropdown) => dropdown.addOption("detailed", "Detailed").addOption("concise", "Concise").setValue(this.plugin.settings.outputFormat).onChange(async (value) => {
      this.plugin.settings.outputFormat = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(formatSection).setName("Highlight Keywords").setDesc("Highlight important terms in the summary").addToggle((toggle) => toggle.setValue(this.plugin.settings.highlightKeywords).onChange(async (value) => {
      this.plugin.settings.highlightKeywords = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(formatSection).setName("Sort News by Date").setDesc("Sort news items by published date").addToggle((toggle) => toggle.setValue(this.plugin.settings.sortByDate).onChange(async (value) => {
      this.plugin.settings.sortByDate = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(formatSection).setName("Include Metadata").setDesc("Include metadata in the generated news").addToggle((toggle) => toggle.setValue(this.plugin.settings.includeMetadata).onChange(async (value) => {
      this.plugin.settings.includeMetadata = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(formatSection).setName("Enable Notifications").setDesc("Show notifications when news is generated").addToggle((toggle) => toggle.setValue(this.plugin.settings.enableNotifications).onChange(async (value) => {
      this.plugin.settings.enableNotifications = value;
      await this.plugin.saveSettings();
    }));
  }
};
var DailyNewsPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.statusBarItem = null;
    this.apiCallsToday = 0;
    this.lastApiCallDate = "";
  }
  async onunload() {
    console.log("Unloading Daily News Plugin");
    if (this.statusBarItem) {
      this.statusBarItem.remove();
    }
  }
  async onload() {
    await this.loadSettings();
    this.loadApiCallCount();
    this.addSettingTab(new DailyNewsSettingTab(this.app, this));
    this.registerInterval(
      window.setInterval(() => this.checkAndGenerateNews(), 6e4)
    );
    this.addCommand({
      id: "generate-news-now",
      name: "Generate News Now",
      callback: async () => {
        new import_obsidian.Notice("Generating news...");
        await this.generateDailyNews();
      }
    });
    this.statusBarItem = this.addStatusBarItem();
    this.updateStatusBar();
  }
  // API call tracking methods
  loadApiCallCount() {
    const today = new Date().toISOString().split("T")[0];
    if (this.lastApiCallDate !== today) {
      this.apiCallsToday = 0;
      this.lastApiCallDate = today;
    }
  }
  incrementApiCallCount() {
    const today = new Date().toISOString().split("T")[0];
    if (this.lastApiCallDate !== today) {
      this.apiCallsToday = 0;
      this.lastApiCallDate = today;
    }
    this.apiCallsToday++;
    this.updateStatusBar();
  }
  // Changed to public so it can be accessed from DailyNewsSettingTab
  updateStatusBar() {
    if (this.statusBarItem) {
      const apiStatus = this.settings.conserveApiCalls ? ` | API: ${this.apiCallsToday}/${this.settings.apiCallsPerDay}` : "";
      this.statusBarItem.setText(`\u{1F4F0} Daily News Ready${apiStatus}`);
    }
  }
  canMakeApiCall() {
    if (!this.settings.conserveApiCalls) {
      return true;
    }
    return this.apiCallsToday < this.settings.apiCallsPerDay;
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async fetchNews(topic) {
    if (!this.canMakeApiCall()) {
      console.log("API call limit reached for today. Skipping search for:", topic);
      new import_obsidian.Notice(`API call limit reached (${this.settings.apiCallsPerDay}/day). Try again tomorrow.`);
      return [];
    }
    let searchQuery = "";
    if (this.settings.useEnhancedSearchQueries) {
      switch (topic.toLowerCase()) {
        case "technology":
          searchQuery = `${topic} news "latest developments" OR "new research" OR "breakthrough" OR "innovation" OR "launch" -old -outdated`;
          break;
        case "world news":
          searchQuery = `${topic} "international relations" OR "global affairs" OR "foreign policy" OR "diplomatic" OR "geopolitical" -speculation -rumor`;
          break;
        case "business":
          searchQuery = `${topic} news "financial results" OR "market trends" OR "earnings" OR "economic data" OR "merger" -speculative`;
          break;
        case "science":
          searchQuery = `${topic} news "discovery" OR "research findings" OR "study results" OR "scientific breakthrough" -preliminary -unconfirmed`;
          break;
        case "health":
          searchQuery = `${topic} news "medical research" OR "health study" OR "clinical trial" OR "treatment breakthrough" -unverified`;
          break;
        default:
          searchQuery = `${topic} news "latest developments" OR "recent events" OR "significant developments" OR "important update"`;
      }
    } else {
      searchQuery = `${topic} news`;
    }
    if (this.settings.searchExactPhrases && this.settings.searchExactPhrases.length > 0) {
      for (const phrase of this.settings.searchExactPhrases) {
        if (phrase.trim()) {
          searchQuery += ` "${phrase.trim()}"`;
        }
      }
    }
    if (this.settings.searchExcludeTerms && this.settings.searchExcludeTerms.length > 0) {
      for (const term of this.settings.searchExcludeTerms) {
        if (term.trim()) {
          searchQuery += ` -${term.trim()}`;
        }
      }
    }
    console.log(`Using search query for ${topic}: ${searchQuery}`);
    const dateRangeParam = this.getOptimizedDateRange();
    const maxResultsPerRequest = 10;
    const totalResultsToFetch = this.settings.conserveApiCalls ? maxResultsPerRequest : Math.min(20, this.settings.news_number);
    const numRequests = Math.ceil(totalResultsToFetch / maxResultsPerRequest);
    try {
      let allNewsItems = [];
      if (this.settings.preferredDomains && this.settings.preferredDomains.length > 0) {
        const highQualityNewsItems = await this.makeSearchRequest(
          searchQuery,
          1,
          dateRangeParam,
          true,
          // prioritize preferred domains
          maxResultsPerRequest
        );
        if (highQualityNewsItems && highQualityNewsItems.length > 0) {
          allNewsItems = [...highQualityNewsItems];
          console.log(`Found ${highQualityNewsItems.length} high-quality items for ${topic}`);
        }
      }
      if (allNewsItems.length < totalResultsToFetch) {
        for (let i = 0; i < numRequests; i++) {
          if (!this.canMakeApiCall()) {
            console.log(`API call limit reached. Stopping after ${i} requests for topic:`, topic);
            break;
          }
          const startIndex = i * maxResultsPerRequest + 1;
          const newItems = await this.makeSearchRequest(
            searchQuery,
            startIndex,
            dateRangeParam,
            false,
            // don't prioritize domains again
            maxResultsPerRequest
          );
          if (!newItems || newItems.length === 0) {
            break;
          }
          for (const item of newItems) {
            if (!allNewsItems.some((existingItem) => existingItem.link === item.link)) {
              allNewsItems.push(item);
            }
          }
          if (allNewsItems.length >= totalResultsToFetch) {
            break;
          }
          if (i < numRequests - 1) {
            await new Promise((resolve) => setTimeout(resolve, 1e3));
          }
        }
      }
      if (allNewsItems.length === 0) {
        console.log(`No news items found for topic: ${topic}`);
        return [];
      }
      console.log(`Found total of ${allNewsItems.length} items for ${topic}`);
      let newsItems = allNewsItems.map((item) => {
        var _a, _b, _c, _d, _e, _f;
        const url = new URL(item.link);
        const domain = url.hostname.replace("www.", "");
        const source = ((_c = (_b = (_a = item.pagemap) == null ? void 0 : _a.metatags) == null ? void 0 : _b[0]) == null ? void 0 : _c.og_site_name) || domain;
        return {
          title: item.title,
          link: item.link,
          snippet: item.snippet,
          publishedTime: (_f = (_e = (_d = item.pagemap) == null ? void 0 : _d.metatags) == null ? void 0 : _e[0]) == null ? void 0 : _f.publishedTime,
          source,
          relevanceScore: this.calculateRelevanceScore(item, topic)
        };
      });
      if (this.settings.useAdvancedFiltering) {
        newsItems = this.applyAdvancedFiltering(newsItems);
      }
      if (newsItems.length === 0 && this.canMakeApiCall()) {
        console.log(`No items after filtering for ${topic}. Trying broader search...`);
        const broaderQuery = `${topic} news latest`;
        const broaderItems = await this.makeSearchRequest(
          broaderQuery,
          1,
          "w1",
          // Expand to a week to get more results
          false,
          maxResultsPerRequest
        );
        if (broaderItems && broaderItems.length > 0) {
          console.log(`Found ${broaderItems.length} items with broader search for ${topic}`);
          newsItems = broaderItems.map((item) => {
            var _a, _b, _c, _d, _e, _f;
            const url = new URL(item.link);
            const domain = url.hostname.replace("www.", "");
            const source = ((_c = (_b = (_a = item.pagemap) == null ? void 0 : _a.metatags) == null ? void 0 : _b[0]) == null ? void 0 : _c.og_site_name) || domain;
            return {
              title: item.title,
              link: item.link,
              snippet: item.snippet,
              publishedTime: (_f = (_e = (_d = item.pagemap) == null ? void 0 : _d.metatags) == null ? void 0 : _e[0]) == null ? void 0 : _f.publishedTime,
              source,
              relevanceScore: this.calculateRelevanceScore(item, topic) * 0.8
              // Reduce score slightly for broader results
            };
          });
          newsItems = newsItems.filter((item) => {
            return (item.relevanceScore || 0) >= Math.max(3, this.settings.contentRelevanceScore - 2);
          });
        }
      }
      if (this.settings.enableSourceRanking) {
        newsItems.sort(
          (a, b) => (b.relevanceScore || 0) - (a.relevanceScore || 0)
        );
      } else if (this.settings.sortByDate) {
        newsItems.sort((a, b) => {
          if (!a.publishedTime)
            return 1;
          if (!b.publishedTime)
            return -1;
          return new Date(b.publishedTime).getTime() - new Date(a.publishedTime).getTime();
        });
      }
      return newsItems;
    } catch (error) {
      console.error("Failed to fetch news:", error);
      new import_obsidian.Notice(`Failed to fetch news for topic "${topic}". Check console for details.`);
      return [];
    }
  }
  // Helper methods for news fetching
  async makeSearchRequest(query, startIndex, dateRestrict, prioritizePreferredDomains, numResults) {
    const params = new URLSearchParams({
      key: this.settings.googleApiKey,
      cx: this.settings.searchEngineId,
      q: query,
      num: numResults.toString(),
      dateRestrict,
      fields: "items(title,link,snippet,pagemap/metatags/publishedTime,pagemap/metatags/og_site_name)",
      sort: "date",
      start: startIndex.toString()
    });
    if (prioritizePreferredDomains && this.settings.preferredDomains && this.settings.preferredDomains.length > 0) {
      const sitesQuery = this.settings.preferredDomains.map((domain) => `site:${domain}`).join(" OR ");
      params.set("q", `${params.get("q")} (${sitesQuery})`);
    }
    console.log(`Making API request with query: ${params.get("q")}`);
    this.incrementApiCallCount();
    const response = await this.retryOperation(async () => {
      const res = await fetch(
        `https://www.googleapis.com/customsearch/v1?${params.toString()}`
      );
      if (!res.ok) {
        try {
          const errorData = await res.json();
          console.error("API Error Details:", errorData);
          throw new Error(`HTTP error! status: ${res.status}, details: ${JSON.stringify(errorData)}`);
        } catch (parseError) {
          throw new Error(`HTTP error! status: ${res.status}, couldn't parse error details`);
        }
      }
      return res;
    });
    const data = await response.json();
    if (!data || !data.items || data.items.length === 0) {
      console.log(`No results found for query: ${params.get("q")}`);
      return [];
    }
    return data.items;
  }
  getOptimizedDateRange() {
    let dateRange = this.settings.searchDateRange;
    if (!dateRange.match(/^[dw]\d+$/)) {
      dateRange = "d2";
    }
    return dateRange;
  }
  // Enhanced relevance scoring
  calculateRelevanceScore(item, topic) {
    let score = 5;
    const url = new URL(item.link);
    const domain = url.hostname.replace("www.", "");
    if (QUALITY_NEWS_SOURCES.some((source) => domain.includes(source))) {
      score += 3;
    }
    if (/\/article\/|\/story\/|\/news\/|\/\d{4}\/\d{2}\/|[-]\d+\.html$/.test(item.link)) {
      score += 2;
    }
    if (url.pathname.length > 1 && url.pathname !== "/" && !url.pathname.endsWith("/")) {
      score += 1;
    }
    if (url.pathname === "/" || url.pathname === "" || url.pathname.length < 3) {
      score -= 4;
    }
    if (/\/category\/|\/categories\/|\/topics\/|\/sections\/|\/tag\/|\/tags\//.test(item.link)) {
      score -= 3;
    }
    if (item.snippet && item.snippet.length > 200) {
      score += 1;
    }
    if (item.title && item.title.toLowerCase().includes(topic.toLowerCase())) {
      score += 1;
    }
    if (item.snippet) {
      if (/\d+%|\d+ percent|\$\d+|\d+ million|\d+ billion/.test(item.snippet)) {
        score += 2;
      }
      if (/January|February|March|April|May|June|July|August|September|October|November|December \d{1,2}(st|nd|rd|th)?/.test(item.snippet)) {
        score += 1.5;
      }
      if (/"[^"]{10,}"/.test(item.snippet) || /'[^']{10,}'/.test(item.snippet)) {
        score += 1.5;
      }
      if (/reported|announced|revealed|published|released|stated|confirmed|said|according to/i.test(item.snippet)) {
        score += 1;
      }
      if (/provides news|latest news|breaking news|news and information|coverage of|news from|headlines from/i.test(item.snippet) && item.snippet.length < 120) {
        score -= 3;
      }
      if (/is a website|is the official|is an online|website of|homepage of|official site/i.test(item.snippet)) {
        score -= 4;
      }
    }
    if (item.title) {
      if (/you won't believe|shocking|amazing|mind-blowing|incredible|top \d+ ways/i.test(item.title)) {
        score -= 2;
      }
      if (/official website|homepage|welcome to/i.test(item.title)) {
        score -= 3;
      }
    }
    if (!item.snippet || item.snippet.length < this.settings.minSnippetLength) {
      score -= 3;
    }
    if (this.settings.preferredDomains && this.settings.preferredDomains.some((preferredDomain) => domain.includes(preferredDomain))) {
      score += 2;
    }
    if (this.settings.excludedDomains && this.settings.excludedDomains.some((excludedDomain) => domain.includes(excludedDomain))) {
      score -= 4;
    }
    return Math.max(1, Math.min(10, score));
  }
  // Enhanced filtering
  applyAdvancedFiltering(newsItems) {
    return newsItems.filter((item) => {
      const url = new URL(item.link);
      const domain = url.hostname.replace("www.", "");
      if (this.settings.excludedDomains && this.settings.excludedDomains.length > 0) {
        if (this.settings.excludedDomains.some((excluded) => domain.includes(excluded))) {
          return false;
        }
      }
      if (!item.snippet || item.snippet.length < this.settings.minSnippetLength) {
        return false;
      }
      if ((item.relevanceScore || 0) < this.settings.contentRelevanceScore) {
        return false;
      }
      if (item.title && /top \d+|best \d+|\d+ ways|\d+ things|best of|roundup/i.test(item.title)) {
        return false;
      }
      if (url.pathname === "/" || url.pathname === "" || url.pathname.length < 3) {
        console.log(`Filtering out homepage URL: ${item.link}`);
        return false;
      }
      if (/\/category\/|\/categories\/|\/topics\/|\/sections\/|\/tag\/|\/tags\//.test(item.link)) {
        console.log(`Filtering out category/tag page: ${item.link}`);
        return false;
      }
      if (item.snippet && /is a website|is the official|is an online|official site of|homepage of/i.test(item.snippet)) {
        console.log(`Filtering out website description: ${item.title}`);
        return false;
      }
      return true;
    });
  }
  cleanNewsContent(text) {
    if (!this.settings.removeAds)
      return text;
    let cleaned = text;
    this.settings.commonAdPatterns.forEach((pattern) => {
      cleaned = cleaned.replace(new RegExp(pattern, "gi"), "");
    });
    cleaned = cleaned.replace(/https?:\/\/\S+/g, "");
    cleaned = cleaned.replace(/\S+@\S+\.\S+/g, "");
    const fillerPhrases = [
      "click here",
      "read more",
      "learn more",
      "find out more",
      "sign up",
      "subscribe",
      "follow us",
      "share this",
      "according to reports",
      "sources say"
    ];
    fillerPhrases.forEach((phrase) => {
      cleaned = cleaned.replace(new RegExp(phrase, "gi"), "");
    });
    cleaned = cleaned.replace(/\s+/g, " ").trim();
    cleaned = cleaned.replace(/(\n\s*){3,}/g, "\n\n");
    return cleaned;
  }
  // Fallback method for low-quality content
  getFallbackSummary(topic, newsItems) {
    const sampleUrls = newsItems.slice(0, 3).map((item) => {
      const domain = new URL(item.link).hostname.replace("www.", "");
      return `${domain} (${item.title ? item.title.substring(0, 30) + "..." : "No title"})`;
    }).join(", ");
    return `### No Substantial News Content Found

Unfortunately, the search didn't find substantive news articles for "${topic}" today. 

**What was found instead:**
- Generic website listings or landing pages
- Sites that describe themselves rather than providing specific news
- Content that lacks concrete details, quotes, or developments
${sampleUrls ? `- Sample sites checked: ${sampleUrls}` : ""}

**Recommendations to improve results:**
- Try again later when more recent news may be available
- Add specific keywords to your "${topic}" topic, like "${topic} breakthrough" or "${topic} latest research"
- Add high-quality news sources to your Preferred Domains settings
- Adjust the Search Date Range to look back further (e.g., "w1" for one week)

This plugin works best with specific, substantive news rather than general website directories or landing pages.
`;
  }
  // Enhanced prompts for AI summary generation
  getDetailedPrompt(newsText) {
    return `You are a professional news analyst creating a high-quality news briefing. Analyze and summarize these news articles:

${newsText}

CRITICAL GUIDELINES - READ CAREFULLY:
1. Focus ONLY on substantive, high-impact news with concrete developments
2. Completely IGNORE any generic website listings, simple link compilations, or shallow content
3. EXCLUDE any content that merely mentions a website without actual news (e.g., "News from Site X")
4. NEVER include entries like "RIT highlights news from Rochester Institute of Technology" or "CNET provides product reviews"
5. PRIORITIZE news with specific data, quotes, figures, and developments
6. AVOID vague summaries and instead focus on specific facts and details
7. ANALYZE the implications and context of each significant story
8. INCLUDE only ONE verified, significant news item per bullet point
9. For each news item, include the SOURCE NAME and link in markdown format: [Source Name](URL)
10. Use exact dates rather than relative time references
11. Make each bullet point specific, concrete and informative - avoid generic placeholders
12. Exclude ANY item that only describes what a website does rather than actual news content

IMPORTANT: If the provided articles lack substantive content or are mostly website landing pages, DO NOT create placeholder entries. Instead, try to salvage any substantive news that does exist. If none exist, note "Insufficient substantive news found on this topic today" and explain briefly what type of content was available but unusable.

WHEN CONTENT IS LIMITED:
1. If ANY substantive article exists with real news, focus entirely on that, even if it's just one item.
2. If only one topic has quality news, it's better to provide in-depth coverage of that topic than to force content for all topics.
3. Look for concrete facts, dates, statistics, and direct quotes - these indicate genuine news rather than website descriptions.

EXAMPLES OF BAD CONTENT TO EXCLUDE:
- "University News: [RIT](https://www.rit.edu/news) highlights news from Rochester Institute of Technology (RIT)."
- "Product Reviews & Tech Coverage: [CNET](https://www.cnet.com/) provides product reviews, tech news, and daily deals."
- "Breaking News: [CNN](https://www.cnn.com/) covers the latest news and headlines."
- "Daily Updates: [BBC](https://www.bbc.com/) delivers international news coverage."

EXAMPLES OF GOOD CONTENT TO INCLUDE:
- "**Quantum Computing Breakthrough**: Researchers at MIT demonstrated a 128-qubit quantum processor achieving quantum advantage in simulating complex molecules on February 25, 2025. [Nature](https://www.nature.com/articles/s41586-025-05742-z)"
- "**Global Trade Impact**: The EU-China trade deficit widened to \u20AC291 billion in 2024, a 24% increase from 2023, according to data released yesterday. [Financial Times](https://www.ft.com/content/3a7b5e9c)"

## Key Developments
[For each significant story - ONLY include items with actual news, NOT descriptions of websites]
- **Title with specific detail**: Concrete fact or development. Include exact figures, data points, and expert quotes when available. [Source](URL)

## Analysis & Context
[Provide context, implications, or background for the most significant story]

## Notable Quotes or Data
[Include a specific quote, statistic, or data point from the news, if available]
`;
  }
  getConcisePrompt(newsText) {
    return `You are a professional news editor creating a concise, high-quality news briefing. Analyze and summarize these news articles:

${newsText}

CRITICAL GUIDELINES - READ CAREFULLY:
1. Focus ONLY on substantive, high-impact news with concrete developments
2. Completely IGNORE any generic website listings, simple link compilations, or shallow content
3. EXCLUDE any content that merely mentions a website without actual news (e.g., "News from Site X")
4. NEVER include entries like "RIT highlights news from Rochester Institute of Technology" or "CNET provides product reviews"
5. PRIORITIZE news with specific data, quotes, figures, and developments
6. AVOID vague summaries and instead focus on specific facts and details
7. For each news item, include the SOURCE NAME and link in markdown format: [Source Name](URL)
8. Use exact dates rather than relative time references
9. Make each bullet point specific, concrete and informative - avoid generic placeholders
10. Exclude ANY item that only describes what a website does rather than actual news content

IMPORTANT: If the provided articles lack substantive content or are mostly website landing pages, DO NOT create placeholder entries. Instead, try to salvage any substantive news that does exist. If none exist, note "Insufficient substantive news found on this topic today" and explain briefly what type of content was available but unusable.

WHEN CONTENT IS LIMITED:
1. If ANY substantive article exists with real news, focus entirely on that, even if it's just one item.
2. It's better to provide one genuine news item than multiple generic placeholders.
3. For articles that look like landing pages (no real news content), completely exclude them.

EXAMPLES OF BAD CONTENT TO EXCLUDE:
- "University News: [RIT](https://www.rit.edu/news) highlights news from Rochester Institute of Technology (RIT)."
- "Product Reviews & Tech Coverage: [CNET](https://www.cnet.com/) provides product reviews, tech news, and daily deals."
- "Breaking News: [CNN](https://www.cnn.com/) covers the latest news and headlines."
- "Daily Updates: [BBC](https://www.bbc.com/) delivers international news coverage."

EXAMPLES OF GOOD CONTENT TO INCLUDE:
- "**Apple's AI Integration**: Apple announced integration of GPT-4o across iOS 19 starting next month, impacting 850M devices worldwide. [TechCrunch](https://techcrunch.com/article/apple-gpt4)"
- "**Climate Policy Shift**: The EU Parliament voted 402-157 to increase carbon reduction targets to 65% by 2035, up from the previous 55% goal. [Reuters](https://www.reuters.com/article/eu-climate-vote)"

## Key Updates
- **Specific Development 1**: Concrete details with data points [Source](URL)
- **Specific Development 2**: Concrete details with data points [Source](URL)
- **Specific Development 3**: Concrete details with data points [Source](URL)

## Noteworthy Quote or Data Point
[Most significant quote, metric or statistic with source and context]
`;
  }
  // Enhanced summary generation
  async generateSummary(newsItems) {
    var _a;
    if (!newsItems.length) {
      return "No recent news found for this topic.";
    }
    const processedItems = newsItems.slice(0, this.settings.maxNewsPerTopic).map((item) => ({
      ...item,
      snippet: this.cleanNewsContent(item.snippet)
    }));
    const hasQualityContent = processedItems.some(
      (item) => (item.relevanceScore || 0) >= 7 && item.snippet && item.snippet.length > 120 && !/is a website|is the official|homepage|official site/i.test(item.snippet)
    );
    if (!hasQualityContent && processedItems.length < 3) {
      console.log("No quality content found, using fallback summary");
      const topicMatch = (_a = processedItems[0]) == null ? void 0 : _a.link.match(/[?&]q=([^&]+)/);
      const topic = topicMatch ? decodeURIComponent(topicMatch[1]).replace(/\+news.*$/, "") : "this topic";
      return this.getFallbackSummary(topic, processedItems);
    }
    const newsText = processedItems.map(
      (item) => `Title: ${item.title}
Source: ${item.source || "Unknown"}
Published: ${item.publishedTime || "Unknown"}
URL: ${item.link}
Content: ${item.snippet}
Relevance Score: ${item.relevanceScore}/10`
    ).join("\n\n");
    const promptTemplate = this.settings.outputFormat === "detailed" ? this.getDetailedPrompt(newsText) : this.getConcisePrompt(newsText);
    try {
      const genAI = new GoogleGenerativeAI(this.settings.geminiApiKey);
      const model = genAI.getGenerativeModel({ model: "gemini-2.0-flash" });
      const result = await this.retryOperation(
        () => model.generateContent(promptTemplate)
      );
      let summary = result.response.text();
      if (this.settings.highlightKeywords) {
        summary = this.highlightKeywords(summary);
      }
      return summary;
    } catch (error) {
      console.error("Failed to generate summary:", error);
      return `Failed to generate summary due to an error: ${error}

Raw news data:
${newsItems.slice(0, 3).map((item) => `- ${item.title} (${item.link})`).join("\n")}`;
    }
  }
  highlightKeywords(text) {
    const keywords = {
      positive: [
        "launch",
        "grow",
        "success",
        "improve",
        "increase",
        "breakthrough",
        "advance",
        "discovery",
        "achievement",
        "progress",
        "development",
        "innovation"
      ],
      negative: [
        "decline",
        "risk",
        "fail",
        "loss",
        "crisis",
        "downturn",
        "challenge",
        "threat",
        "deficit",
        "recession",
        "setback",
        "conflict"
      ],
      neutral: [
        "announce",
        "report",
        "state",
        "plan",
        "develop",
        "analyze",
        "release",
        "study",
        "research",
        "investigate",
        "examine",
        "evaluate"
      ],
      data: [
        "percent",
        "billion",
        "million",
        "trillion",
        "increase",
        "decrease",
        "growth",
        "reduction",
        "doubled",
        "tripled",
        "halved",
        "statistics"
      ]
    };
    let highlighted = text;
    Object.entries(keywords).forEach(([type, words]) => {
      words.forEach((word) => {
        const regex = new RegExp(`\\b${word}\\w*\\b`, "gi");
        highlighted = highlighted.replace(regex, `**$&**`);
      });
    });
    highlighted = highlighted.replace(/(\$\d+[\d,.]*)|((\d+[\d,.]*%)|(\d+[\d,.]* percent))/gi, "**$&**");
    return highlighted;
  }
  async retryOperation(operation, maxRetries = this.settings.maxRetries) {
    for (let i = 0; i < maxRetries; i++) {
      try {
        return await operation();
      } catch (error) {
        console.error(`Retry attempt ${i + 1}/${maxRetries} failed:`, error);
        if (i === maxRetries - 1) {
          console.error(`All ${maxRetries} retry attempts failed`);
          throw error;
        }
        const delay = Math.min(1e3 * Math.pow(2, i), this.settings.maxRetryDelay);
        console.log(`Retrying in ${delay / 1e3} seconds...`);
        await new Promise((resolve) => setTimeout(resolve, delay));
      }
    }
    throw new Error("Max retries exceeded");
  }
  async checkAndGenerateNews() {
    this.loadApiCallCount();
    const now = new Date();
    const scheduledTime = this.settings.scheduleTime.split(":");
    const targetHour = parseInt(scheduledTime[0]);
    const targetMinute = parseInt(scheduledTime[1]);
    if (now.getHours() === targetHour && now.getMinutes() === targetMinute) {
      await this.generateDailyNews();
    }
  }
  async generateDailyNews() {
    const date = new Date().toISOString().split("T")[0];
    if (this.statusBarItem) {
      this.statusBarItem.setText("\u{1F4F0} Generating News...");
    }
    try {
      let content = await this.getTemplate() || `*Generated at ${new Date().toLocaleTimeString()}*

---

`;
      if (this.settings.conserveApiCalls) {
        content += `*API Usage: ${this.apiCallsToday}/${this.settings.apiCallsPerDay} calls today*

`;
      }
      if (this.settings.outputFormat === "detailed") {
        content += `## Table of Contents

`;
        this.settings.topics.forEach((topic) => {
          content += `- [${topic}](#${topic.toLowerCase().replace(/\s+/g, "%20")})
`;
        });
        content += `
---

`;
      }
      const availableApiCalls = this.settings.apiCallsPerDay - this.apiCallsToday;
      let topicsToProcess = [...this.settings.topics];
      if (this.settings.conserveApiCalls && availableApiCalls < this.settings.topics.length) {
        topicsToProcess = topicsToProcess.slice(0, availableApiCalls);
        content += `> **Note:** Due to API limits, only processing ${topicsToProcess.length} of ${this.settings.topics.length} topics today.

`;
      }
      for (const topic of topicsToProcess) {
        content += `## ${topic}

`;
        if (!this.canMakeApiCall()) {
          content += `*API call limit reached. Skipping this topic.*

`;
          continue;
        }
        const newsItems = await this.fetchNews(topic);
        if (newsItems.length) {
          const summary = await this.generateSummary(newsItems);
          content += summary + "\n\n";
        } else {
          content += `No recent news found for ${topic}

`;
        }
      }
      if (topicsToProcess.length < this.settings.topics.length) {
        content += `## Omitted Topics

`;
        content += `The following topics were omitted due to API call limits:

`;
        const omittedTopics = this.settings.topics.filter((topic) => !topicsToProcess.includes(topic));
        omittedTopics.forEach((topic) => {
          content += `- ${topic}
`;
        });
        content += `
`;
      }
      const fileName = `${this.settings.archiveFolder}/Daily News - ${date}.md`;
      await this.app.vault.create(fileName, content);
      if (this.settings.enableNotifications) {
        new import_obsidian.Notice("Daily news generated successfully");
      }
      if (this.statusBarItem) {
        this.updateStatusBar();
      }
    } catch (error) {
      console.error("Failed to generate news:", error);
      if (this.settings.enableNotifications) {
        new import_obsidian.Notice("Failed to generate news. Check console for details.");
      }
      if (this.statusBarItem) {
        this.statusBarItem.setText("\u{1F4F0} News Error!");
      }
    }
  }
  async getTemplate() {
    if (!this.settings.templatePath)
      return null;
    try {
      const templateFile = this.app.vault.getAbstractFileByPath(this.settings.templatePath);
      if (templateFile instanceof import_obsidian.TFile) {
        return await this.app.vault.read(templateFile);
      }
    } catch (error) {
      console.error("Failed to read template:", error);
    }
    return null;
  }
};
/*! Bundled license information:

@google/generative-ai/dist/index.mjs:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@google/generative-ai/dist/index.mjs:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJub2RlX21vZHVsZXMvQGdvb2dsZS9nZW5lcmF0aXZlLWFpL2Rpc3QvaW5kZXgubWpzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgTm90aWNlLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEdvb2dsZUdlbmVyYXRpdmVBSSB9IGZyb20gXCJAZ29vZ2xlL2dlbmVyYXRpdmUtYWlcIjtcblxuaW50ZXJmYWNlIERhaWx5TmV3c1NldHRpbmdzIHtcbiAgICBnb29nbGVBcGlLZXk6IHN0cmluZztcbiAgICBzZWFyY2hFbmdpbmVJZDogc3RyaW5nO1xuICAgIGdlbWluaUFwaUtleTogc3RyaW5nO1xuICAgIHRvcGljczogc3RyaW5nW107XG4gICAgc2NoZWR1bGVUaW1lOiBzdHJpbmc7XG4gICAgYXJjaGl2ZUZvbGRlcjogc3RyaW5nO1xuICAgIG5ld3NfbnVtYmVyOiBudW1iZXI7XG4gICAgdGVtcGxhdGVQYXRoOiBzdHJpbmc7XG4gICAgbWF4UmV0cmllczogbnVtYmVyO1xuICAgIGVuYWJsZU5vdGlmaWNhdGlvbnM6IGJvb2xlYW47XG4gICAgc29ydEJ5RGF0ZTogYm9vbGVhbjtcbiAgICBpbmNsdWRlTWV0YWRhdGE6IGJvb2xlYW47XG4gICAgbWF4UmV0cnlEZWxheTogbnVtYmVyO1xuICAgIG91dHB1dEZvcm1hdDogJ2RldGFpbGVkJyB8ICdjb25jaXNlJztcbiAgICByZW1vdmVBZHM6IGJvb2xlYW47XG4gICAgbWF4TmV3c1BlclRvcGljOiBudW1iZXI7XG4gICAgaGlnaGxpZ2h0S2V5d29yZHM6IGJvb2xlYW47XG4gICAgY29tbW9uQWRQYXR0ZXJuczogc3RyaW5nW107XG4gICAgbWluU25pcHBldExlbmd0aDogbnVtYmVyO1xuICAgIGV4Y2x1ZGVkRG9tYWluczogc3RyaW5nW107XG4gICAgcHJlZmVycmVkRG9tYWluczogc3RyaW5nW107XG4gICAgc2VhcmNoRGF0ZVJhbmdlOiBzdHJpbmc7XG4gICAgY29udGVudFJlbGV2YW5jZVNjb3JlOiBudW1iZXI7XG4gICAgZW5hYmxlU291cmNlUmFua2luZzogYm9vbGVhbjtcbiAgICBzZWFyY2hFeGFjdFBocmFzZXM6IHN0cmluZ1tdO1xuICAgIHNlYXJjaEV4Y2x1ZGVUZXJtczogc3RyaW5nW107XG4gICAgdXNlQWR2YW5jZWRGaWx0ZXJpbmc6IGJvb2xlYW47XG4gICAgY29uc2VydmVBcGlDYWxsczogYm9vbGVhbjsgLy8gT3B0aW9uIHRvIGNvbnNlcnZlIEFQSSBjYWxsc1xuICAgIGFwaUNhbGxzUGVyRGF5OiBudW1iZXI7IC8vIFNldHRpbmcgdG8gbGltaXQgQVBJIGNhbGxzIHBlciBkYXlcbiAgICB1c2VFbmhhbmNlZFNlYXJjaFF1ZXJpZXM6IGJvb2xlYW47IC8vIE5ldyBvcHRpb24gZm9yIGJldHRlciBzZWFyY2ggcXVlcmllc1xufVxuXG5pbnRlcmZhY2UgTmV3c0l0ZW0ge1xuICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgbGluazogc3RyaW5nO1xuICAgIHNuaXBwZXQ6IHN0cmluZztcbiAgICBwdWJsaXNoZWRUaW1lPzogc3RyaW5nO1xuICAgIHNvdXJjZT86IHN0cmluZztcbiAgICByZWxldmFuY2VTY29yZT86IG51bWJlcjtcbn1cblxuaW50ZXJmYWNlIFNlYXJjaEl0ZW0ge1xuICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgbGluazogc3RyaW5nO1xuICAgIHNuaXBwZXQ6IHN0cmluZztcbiAgICBwYWdlbWFwPzoge1xuICAgICAgICBtZXRhdGFncz86IEFycmF5PHtcbiAgICAgICAgICAgIHB1Ymxpc2hlZFRpbWU/OiBzdHJpbmc7XG4gICAgICAgICAgICBvZ19zaXRlX25hbWU/OiBzdHJpbmc7XG4gICAgICAgIH0+O1xuICAgIH07XG59XG5cbmludGVyZmFjZSBDdXN0b21TZWFyY2hSZXNwb25zZSB7XG4gICAgaXRlbXM/OiBTZWFyY2hJdGVtW107XG4gICAgZXJyb3I/OiB7XG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICAgICAgc3RhdHVzOiBzdHJpbmc7XG4gICAgfTtcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogRGFpbHlOZXdzU2V0dGluZ3MgPSB7XG4gICAgZ29vZ2xlQXBpS2V5OiAnJyxcbiAgICBzZWFyY2hFbmdpbmVJZDogJycsXG4gICAgZ2VtaW5pQXBpS2V5OiAnJyxcbiAgICB0b3BpY3M6IFsnVGVjaG5vbG9neScsICdXb3JsZCBOZXdzJ10sXG4gICAgc2NoZWR1bGVUaW1lOiAnMDg6MDAnLFxuICAgIGFyY2hpdmVGb2xkZXI6ICdOZXdzIEFyY2hpdmUnLFxuICAgIG5ld3NfbnVtYmVyOiAxMCwgLy8gUmVkdWNlZCB0byBzdGF5IHdpdGhpbiBBUEkgbGltaXRzXG4gICAgdGVtcGxhdGVQYXRoOiAnJyxcbiAgICBtYXhSZXRyaWVzOiAzLFxuICAgIGVuYWJsZU5vdGlmaWNhdGlvbnM6IHRydWUsXG4gICAgc29ydEJ5RGF0ZTogdHJ1ZSxcbiAgICBpbmNsdWRlTWV0YWRhdGE6IHRydWUsXG4gICAgbWF4UmV0cnlEZWxheTogMzAwMDAsXG4gICAgb3V0cHV0Rm9ybWF0OiAnZGV0YWlsZWQnLFxuICAgIHJlbW92ZUFkczogdHJ1ZSxcbiAgICBtYXhOZXdzUGVyVG9waWM6IDEwLFxuICAgIGhpZ2hsaWdodEtleXdvcmRzOiB0cnVlLFxuICAgIGNvbW1vbkFkUGF0dGVybnM6IFtcbiAgICAgICAgJ1N1YnNjcmliZSB0byByZWFkJyxcbiAgICAgICAgJ1NpZ24gdXAgbm93JyxcbiAgICAgICAgJ0FkdmVydGlzZW1lbnQnLFxuICAgICAgICAnQ2xpY2sgaGVyZSB0bycsXG4gICAgICAgICdTcGVjaWFsIG9mZmVyJyxcbiAgICAgICAgJ25ld3NsZXR0ZXJzP1xcXFxiJyxcbiAgICAgICAgJ1xcXFxbXFxcXGQrXFxcXF0nLFxuICAgICAgICAnXHUwMEE5XFxcXHMqXFxcXGR7NH0nLFxuICAgICAgICAnY29va2llJyxcbiAgICAgICAgJ3N1YnNjcmliZScsXG4gICAgICAgICdzaWduIHVwJyxcbiAgICAgICAgJ2ZvciBtb3JlIGluZm9ybWF0aW9uJyxcbiAgICAgICAgJ3ByaXZhY3kgcG9saWN5JyxcbiAgICAgICAgJ3Rlcm1zIG9mIHNlcnZpY2UnLFxuICAgICAgICAnYWxsIHJpZ2h0cyByZXNlcnZlZCdcbiAgICBdLFxuICAgIG1pblNuaXBwZXRMZW5ndGg6IDEwMCxcbiAgICBleGNsdWRlZERvbWFpbnM6IFtdLFxuICAgIHByZWZlcnJlZERvbWFpbnM6IFtdLFxuICAgIHNlYXJjaERhdGVSYW5nZTogJ2QyJyxcbiAgICBjb250ZW50UmVsZXZhbmNlU2NvcmU6IDYsXG4gICAgZW5hYmxlU291cmNlUmFua2luZzogdHJ1ZSxcbiAgICBzZWFyY2hFeGFjdFBocmFzZXM6IFtdLFxuICAgIHNlYXJjaEV4Y2x1ZGVUZXJtczogW10sXG4gICAgdXNlQWR2YW5jZWRGaWx0ZXJpbmc6IHRydWUsXG4gICAgY29uc2VydmVBcGlDYWxsczogdHJ1ZSwgLy8gRGVmYXVsdCB0byBjb25zZXJ2aW5nIEFQSSBjYWxsc1xuICAgIGFwaUNhbGxzUGVyRGF5OiAxMDAsIC8vIERlZmF1bHQgbGltaXRcbiAgICB1c2VFbmhhbmNlZFNlYXJjaFF1ZXJpZXM6IHRydWUgLy8gRGVmYXVsdCB0byB1c2luZyBlbmhhbmNlZCBxdWVyaWVzXG59XG5cbi8vIFRvcCBuZXdzIHNvdXJjZXMgYnkgcXVhbGl0eS9yZWxpYWJpbGl0eVxuY29uc3QgUVVBTElUWV9ORVdTX1NPVVJDRVMgPSBbXG4gICAgJ255dGltZXMuY29tJywgJ2JiYy5jb20nLCAncmV1dGVycy5jb20nLCAnYXBuZXdzLmNvbScsICdlY29ub21pc3QuY29tJyxcbiAgICAnd3NqLmNvbScsICdmdC5jb20nLCAnYmxvb21iZXJnLmNvbScsICd0aGVndWFyZGlhbi5jb20nLCAnbnByLm9yZycsXG4gICAgJ3dhc2hpbmd0b25wb3N0LmNvbScsICdhbGphemVlcmEuY29tJywgJ25hdHVyZS5jb20nLCAndGltZS5jb20nLCAnd2lyZWQuY29tJyxcbiAgICAndGhlYXRsYW50aWMuY29tJywgJ25ld3lvcmtlci5jb20nLCAnc2NpZW50aWZpY2FtZXJpY2FuLmNvbScsICdjbmJjLmNvbScsXG4gICAgJ2ZvcnR1bmUuY29tJywgJ3RlY2hjcnVuY2guY29tJywgJ3RoZW5leHR3ZWIuY29tJywgJ2Fyc3RlY2huaWNhLmNvbSdcbl07XG5cbi8vIERlZmluZSB0aGUgRGFpbHlOZXdzU2V0dGluZ1RhYiBjbGFzcyBiZWZvcmUgaXQncyB1c2VkXG5jbGFzcyBEYWlseU5ld3NTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBEYWlseU5ld3NQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBEYWlseU5ld3NQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7Y29udGFpbmVyRWx9ID0gdGhpcztcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywge3RleHQ6ICdEYWlseSBOZXdzIFNldHRpbmdzJ30pO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIEFQSSB1c2FnZSBpbmZvIGF0IHRoZSB0b3BcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnNlcnZlQXBpQ2FsbHMpIHtcbiAgICAgICAgICAgIGNvbnN0IGFwaUluZm8gPSBjb250YWluZXJFbC5jcmVhdGVFbCgnZGl2Jywge1xuICAgICAgICAgICAgICAgIGNsczogJ2FwaS11c2FnZS1pbmZvJyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYXBpSW5mby5jcmVhdGVFbCgncCcsIHtcbiAgICAgICAgICAgICAgICB0ZXh0OiBgQVBJIFVzYWdlIFRvZGF5OiAke3RoaXMucGx1Z2luLmFwaUNhbGxzVG9kYXl9LyR7dGhpcy5wbHVnaW4uc2V0dGluZ3MuYXBpQ2FsbHNQZXJEYXl9IGNhbGxzYFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBUEkgY29uZmlndXJhdGlvbiBzZWN0aW9uXG4gICAgICAgIGNvbnN0IGFwaVNlY3Rpb24gPSBjb250YWluZXJFbC5jcmVhdGVFbCgnZGl2Jyk7XG4gICAgICAgIGFwaVNlY3Rpb24uY3JlYXRlRWwoJ2gzJywge3RleHQ6ICdBUEkgQ29uZmlndXJhdGlvbid9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhhcGlTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0dvb2dsZSBBUEkgS2V5JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdZb3VyIEdvb2dsZSBDdXN0b20gU2VhcmNoIEFQSSBrZXknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciBBUEkga2V5JylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZ29vZ2xlQXBpS2V5KVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ29vZ2xlQXBpS2V5ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhhcGlTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1NlYXJjaCBFbmdpbmUgSUQnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1lvdXIgR29vZ2xlIEN1c3RvbSBTZWFyY2ggRW5naW5lIElEJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRW50ZXIgU2VhcmNoIEVuZ2luZSBJRCcpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNlYXJjaEVuZ2luZUlkKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VhcmNoRW5naW5lSWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGFwaVNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnR2VtaW5pIEFQSSBLZXknKVxuICAgICAgICAgICAgLnNldERlc2MoJ1lvdXIgR29vZ2xlIEdlbWluaSBBUEkga2V5JylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignRW50ZXIgR2VtaW5pIEFQSSBrZXknKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW1pbmlBcGlLZXkpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZW1pbmlBcGlLZXkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIC8vIEJhc2ljIG5ld3MgcHJlZmVyZW5jZXMgc2VjdGlvblxuICAgICAgICBjb25zdCBuZXdzU2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgbmV3c1NlY3Rpb24uY3JlYXRlRWwoJ2gzJywge3RleHQ6ICdCYXNpYyBOZXdzIFByZWZlcmVuY2VzJ30pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKG5ld3NTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1NjaGVkdWxlIFRpbWUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1doZW4gdG8gZ2VuZXJhdGUgZGFpbHkgbmV3cyAoMjQtaG91ciBmb3JtYXQpJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignSEg6TU0nKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zY2hlZHVsZVRpbWUpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zY2hlZHVsZVRpbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhuZXdzU2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdBcmNoaXZlIEZvbGRlcicpXG4gICAgICAgICAgICAuc2V0RGVzYygnRm9sZGVyIHRvIHN0b3JlIGRhaWx5IG5ld3Mgbm90ZXMnKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdOZXdzIEFyY2hpdmUnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcmNoaXZlRm9sZGVyKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXJjaGl2ZUZvbGRlciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcobmV3c1NlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnVG9waWNzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdOZXdzIHRvcGljcyB0byBmb2xsb3cgKGNvbW1hLXNlcGFyYXRlZCknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdUZWNobm9sb2d5LCBXb3JsZCBOZXdzJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudG9waWNzLmpvaW4oJywgJykpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50b3BpY3MgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcCh0ID0+IHQudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKG5ld3NTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1RlbXBsYXRlIEZpbGUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0N1c3RvbSB0ZW1wbGF0ZSBmaWxlIHBhdGggKG9wdGlvbmFsKScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3RlbXBsYXRlcy9uZXdzLXRlbXBsYXRlLm1kJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVQYXRoKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudGVtcGxhdGVQYXRoID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAvLyBBUEkgVXNhZ2UgTWFuYWdlbWVudCBzZWN0aW9uXG4gICAgICAgIGNvbnN0IGFwaVVzYWdlU2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgYXBpVXNhZ2VTZWN0aW9uLmNyZWF0ZUVsKCdoMycsIHt0ZXh0OiAnQVBJIFVzYWdlIE1hbmFnZW1lbnQnfSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhhcGlVc2FnZVNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnQ29uc2VydmUgQVBJIENhbGxzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdFbmFibGUgdG8gbGltaXQgQVBJIGNhbGxzIGFuZCBwcmV2ZW50IHF1b3RhIGV4aGF1c3Rpb24nKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnNlcnZlQXBpQ2FsbHMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb25zZXJ2ZUFwaUNhbGxzID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTsgLy8gUmVmcmVzaCB0byBzaG93L2hpZGUgdGhlIEFQSSBjYWxscyBzZXR0aW5nXG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuY29uc2VydmVBcGlDYWxscykge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcoYXBpVXNhZ2VTZWN0aW9uKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdEYWlseSBBUEkgQ2FsbCBMaW1pdCcpXG4gICAgICAgICAgICAgICAgLnNldERlc2MoJ01heGltdW0gbnVtYmVyIG9mIEFQSSBjYWxscyB0byBtYWtlIHBlciBkYXknKVxuICAgICAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzEwMCcpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hcGlDYWxsc1BlckRheS50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWRWYWx1ZSA9IHBhcnNlSW50KHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmFwaUNhbGxzUGVyRGF5ID0gaXNOYU4ocGFyc2VkVmFsdWUpID8gMTAwIDogcGFyc2VkVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGFwaVVzYWdlU2VjdGlvbilcbiAgICAgICAgICAgICAgICAuc2V0TmFtZSgnUmVzZXQgQVBJIENvdW50ZXInKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKCdSZXNldCB0b2RheVxcJ3MgQVBJIGNhbGwgY291bnRlcicpXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG4gICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdSZXNldCBDb3VudGVyJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBpQ2FsbHNUb2RheSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnQVBJIGNhbGwgY291bnRlciByZXNldCB0byAwJyk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNlYXJjaCBRdWFsaXR5IHNlY3Rpb24gKG5ldylcbiAgICAgICAgY29uc3Qgc2VhcmNoUXVhbGl0eVNlY3Rpb24gPSBjb250YWluZXJFbC5jcmVhdGVFbCgnZGl2Jyk7XG4gICAgICAgIHNlYXJjaFF1YWxpdHlTZWN0aW9uLmNyZWF0ZUVsKCdoMycsIHt0ZXh0OiAnU2VhcmNoIFF1YWxpdHknfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoc2VhcmNoUXVhbGl0eVNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnVXNlIEVuaGFuY2VkIFNlYXJjaCBRdWVyaWVzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdVc2UgdG9waWMtc3BlY2lmaWMgb3B0aW1pemVkIHNlYXJjaCBxdWVyaWVzIHRvIGZpbmQgYmV0dGVyIG5ld3MgYXJ0aWNsZXMnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZUVuaGFuY2VkU2VhcmNoUXVlcmllcylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZUVuaGFuY2VkU2VhcmNoUXVlcmllcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZHZhbmNlZCBzZWFyY2ggc2V0dGluZ3NcbiAgICAgICAgY29uc3Qgc2VhcmNoU2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgc2VhcmNoU2VjdGlvbi5jcmVhdGVFbCgnaDMnLCB7dGV4dDogJ0FkdmFuY2VkIFNlYXJjaCBTZXR0aW5ncyd9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhzZWFyY2hTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1NlYXJjaCBEYXRlIFJhbmdlJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdIb3cgZmFyIGJhY2sgdG8gc2VhcmNoIChkMSA9IDEgZGF5LCBkMiA9IDIgZGF5cywgdzEgPSAxIHdlZWspJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignZDInKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWFyY2hEYXRlUmFuZ2UpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWFyY2hEYXRlUmFuZ2UgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnTmV3cyBSZXN1bHRzIFBlciBUb3BpYycpXG4gICAgICAgICAgICAuc2V0RGVzYygnTWF4aW11bSBudW1iZXIgb2YgbmV3cyByZXN1bHRzIHRvIHJldHJpZXZlIHBlciB0b3BpYyAodmlhIHBhZ2luYXRpb24pJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignMjAnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5uZXdzX251bWJlci50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkVmFsdWUgPSBwYXJzZUludCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm5ld3NfbnVtYmVyID0gaXNOYU4ocGFyc2VkVmFsdWUpID8gMjAgOiBwYXJzZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnTWF4IE5ld3MgSXRlbXMgUGVyIFN1bW1hcnknKVxuICAgICAgICAgICAgLnNldERlc2MoJ01heGltdW0gbnVtYmVyIG9mIG5ld3MgaXRlbXMgdG8gaW5jbHVkZSBpbiB0aGUgc3VtbWFyeScpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzgnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhOZXdzUGVyVG9waWMudG9TdHJpbmcoKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZFZhbHVlID0gcGFyc2VJbnQodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhOZXdzUGVyVG9waWMgPSBpc05hTihwYXJzZWRWYWx1ZSkgPyAxMCA6IHBhcnNlZFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoc2VhcmNoU2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdNaW5pbXVtIENvbnRlbnQgTGVuZ3RoJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdNaW5pbXVtIGxlbmd0aCBmb3IgbmV3cyBzbmlwcGV0cyB0byBiZSBjb25zaWRlcmVkJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignMTAwJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubWluU25pcHBldExlbmd0aC50b1N0cmluZygpKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFyc2VkVmFsdWUgPSBwYXJzZUludCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1pblNuaXBwZXRMZW5ndGggPSBpc05hTihwYXJzZWRWYWx1ZSkgPyAxMDAgOiBwYXJzZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnUHJlZmVycmVkIERvbWFpbnMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0NvbW1hLXNlcGFyYXRlZCBsaXN0IG9mIHByZWZlcnJlZCBkb21haW5zIChlLmcuLCBueXRpbWVzLmNvbSwgYmJjLmNvbSknKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdueXRpbWVzLmNvbSwgYmJjLmNvbScpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByZWZlcnJlZERvbWFpbnMuam9pbignLCAnKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByZWZlcnJlZERvbWFpbnMgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcChkID0+IGQudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnRXhjbHVkZWQgRG9tYWlucycpXG4gICAgICAgICAgICAuc2V0RGVzYygnQ29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgZG9tYWlucyB0byBleGNsdWRlJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigncGludGVyZXN0LmNvbSwgZmFjZWJvb2suY29tJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZXhjbHVkZWREb21haW5zLmpvaW4oJywgJykpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5leGNsdWRlZERvbWFpbnMgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcChkID0+IGQudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnRXhhY3QgUGhyYXNlcyB0byBJbmNsdWRlJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdDb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBleGFjdCBwaHJhc2VzIHRvIGluY2x1ZGUgaW4gc2VhcmNoJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignbGF0ZXN0IGRldmVsb3BtZW50cywgbmV3IHJlc2VhcmNoJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VhcmNoRXhhY3RQaHJhc2VzLmpvaW4oJywgJykpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWFyY2hFeGFjdFBocmFzZXMgPSB2YWx1ZS5zcGxpdCgnLCcpLm1hcChwID0+IHAudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHNlYXJjaFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnVGVybXMgdG8gRXhjbHVkZScpXG4gICAgICAgICAgICAuc2V0RGVzYygnQ29tbWEtc2VwYXJhdGVkIGxpc3Qgb2YgdGVybXMgdG8gZXhjbHVkZSBmcm9tIHNlYXJjaCcpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2NsaWNrYmFpdCwgcnVtb3IsIG9waW5pb24nKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWFyY2hFeGNsdWRlVGVybXMuam9pbignLCAnKSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNlYXJjaEV4Y2x1ZGVUZXJtcyA9IHZhbHVlLnNwbGl0KCcsJykubWFwKHQgPT4gdC50cmltKCkpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gQ29udGVudCBxdWFsaXR5IHNldHRpbmdzXG4gICAgICAgIGNvbnN0IHF1YWxpdHlTZWN0aW9uID0gY29udGFpbmVyRWwuY3JlYXRlRWwoJ2RpdicpO1xuICAgICAgICBxdWFsaXR5U2VjdGlvbi5jcmVhdGVFbCgnaDMnLCB7dGV4dDogJ0NvbnRlbnQgUXVhbGl0eSBTZXR0aW5ncyd9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhxdWFsaXR5U2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdFbmFibGUgQWR2YW5jZWQgRmlsdGVyaW5nJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdBcHBseSBhZHZhbmNlZCBmaWx0ZXJpbmcgdG8gaW1wcm92ZSBuZXdzIHF1YWxpdHknKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZUFkdmFuY2VkRmlsdGVyaW5nKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlQWR2YW5jZWRGaWx0ZXJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHF1YWxpdHlTZWN0aW9uKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0VuYWJsZSBTb3VyY2UgUmFua2luZycpXG4gICAgICAgICAgICAuc2V0RGVzYygnUHJpb3JpdGl6ZSBoaWdoLXF1YWxpdHkgbmV3cyBzb3VyY2VzJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVTb3VyY2VSYW5raW5nKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlU291cmNlUmFua2luZyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcocXVhbGl0eVNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnTWluaW11bSBSZWxldmFuY2UgU2NvcmUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ01pbmltdW0gcmVsZXZhbmNlIHNjb3JlIGZvciBuZXdzICgxLTEwKScpXG4gICAgICAgICAgICAuYWRkU2xpZGVyKHNsaWRlciA9PiBzbGlkZXJcbiAgICAgICAgICAgICAgICAuc2V0TGltaXRzKDEsIDEwLCAxKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50UmVsZXZhbmNlU2NvcmUpXG4gICAgICAgICAgICAgICAgLnNldER5bmFtaWNUb29sdGlwKClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRSZWxldmFuY2VTY29yZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcocXVhbGl0eVNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVtb3ZlIEFkcyBhbmQgUHJvbW90aW9ucycpXG4gICAgICAgICAgICAuc2V0RGVzYygnQ2xlYW4gcHJvbW90aW9uYWwgY29udGVudCBmcm9tIG5ld3MnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZUFkcylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZUFkcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgLy8gRm9ybWF0IHNlY3Rpb25cbiAgICAgICAgY29uc3QgZm9ybWF0U2VjdGlvbiA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgZm9ybWF0U2VjdGlvbi5jcmVhdGVFbCgnaDMnLCB7dGV4dDogJ091dHB1dCBGb3JtYXQnfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoZm9ybWF0U2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdPdXRwdXQgU3R5bGUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0Nob29zZSBiZXR3ZWVuIGRldGFpbGVkIG9yIGNvbmNpc2UgbmV3cyBmb3JtYXQnKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignZGV0YWlsZWQnLCAnRGV0YWlsZWQnKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2NvbmNpc2UnLCAnQ29uY2lzZScpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm91dHB1dEZvcm1hdClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiAnZGV0YWlsZWQnIHwgJ2NvbmNpc2UnKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm91dHB1dEZvcm1hdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoZm9ybWF0U2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdIaWdobGlnaHQgS2V5d29yZHMnKVxuICAgICAgICAgICAgLnNldERlc2MoJ0hpZ2hsaWdodCBpbXBvcnRhbnQgdGVybXMgaW4gdGhlIHN1bW1hcnknKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmhpZ2hsaWdodEtleXdvcmRzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaGlnaGxpZ2h0S2V5d29yZHMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGZvcm1hdFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnU29ydCBOZXdzIGJ5IERhdGUnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1NvcnQgbmV3cyBpdGVtcyBieSBwdWJsaXNoZWQgZGF0ZScpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc29ydEJ5RGF0ZSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNvcnRCeURhdGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGZvcm1hdFNlY3Rpb24pXG4gICAgICAgICAgICAuc2V0TmFtZSgnSW5jbHVkZSBNZXRhZGF0YScpXG4gICAgICAgICAgICAuc2V0RGVzYygnSW5jbHVkZSBtZXRhZGF0YSBpbiB0aGUgZ2VuZXJhdGVkIG5ld3MnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVNZXRhZGF0YSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVNZXRhZGF0YSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoZm9ybWF0U2VjdGlvbilcbiAgICAgICAgICAgIC5zZXROYW1lKCdFbmFibGUgTm90aWZpY2F0aW9ucycpXG4gICAgICAgICAgICAuc2V0RGVzYygnU2hvdyBub3RpZmljYXRpb25zIHdoZW4gbmV3cyBpcyBnZW5lcmF0ZWQnKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU5vdGlmaWNhdGlvbnMpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVOb3RpZmljYXRpb25zID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERhaWx5TmV3c1BsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IERhaWx5TmV3c1NldHRpbmdzO1xuICAgIHN0YXR1c0Jhckl0ZW06IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgYXBpQ2FsbHNUb2RheTogbnVtYmVyID0gMDtcbiAgICBsYXN0QXBpQ2FsbERhdGU6IHN0cmluZyA9ICcnO1xuXG4gICAgYXN5bmMgb251bmxvYWQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdVbmxvYWRpbmcgRGFpbHkgTmV3cyBQbHVnaW4nKTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdHVzQmFySXRlbSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIExvYWQgQVBJIGNhbGwgY291bnRcbiAgICAgICAgdGhpcy5sb2FkQXBpQ2FsbENvdW50KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgc2V0dGluZ3MgdGFiXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgRGFpbHlOZXdzU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIC8vIFNjaGVkdWxlIGRhaWx5IG5ld3MgZ2VuZXJhdGlvblxuICAgICAgICB0aGlzLnJlZ2lzdGVySW50ZXJ2YWwoXG4gICAgICAgICAgICB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy5jaGVja0FuZEdlbmVyYXRlTmV3cygpLCA2MDAwMClcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBBZGQgbWFudWFsIHRyaWdnZXIgY29tbWFuZFxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdnZW5lcmF0ZS1uZXdzLW5vdycsXG4gICAgICAgICAgICBuYW1lOiAnR2VuZXJhdGUgTmV3cyBOb3cnLFxuICAgICAgICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdHZW5lcmF0aW5nIG5ld3MuLi4nKTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmdlbmVyYXRlRGFpbHlOZXdzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFkZCBzdGF0dXMgYmFyIGl0ZW1cbiAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtID0gdGhpcy5hZGRTdGF0dXNCYXJJdGVtKCk7XG4gICAgICAgIHRoaXMudXBkYXRlU3RhdHVzQmFyKCk7XG4gICAgfVxuXG4gICAgLy8gQVBJIGNhbGwgdHJhY2tpbmcgbWV0aG9kc1xuICAgIHByaXZhdGUgbG9hZEFwaUNhbGxDb3VudCgpIHtcbiAgICAgICAgY29uc3QgdG9kYXkgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlc2V0IGNvdW50ZXIgaWYgaXQncyBhIG5ldyBkYXlcbiAgICAgICAgaWYgKHRoaXMubGFzdEFwaUNhbGxEYXRlICE9PSB0b2RheSkge1xuICAgICAgICAgICAgdGhpcy5hcGlDYWxsc1RvZGF5ID0gMDtcbiAgICAgICAgICAgIHRoaXMubGFzdEFwaUNhbGxEYXRlID0gdG9kYXk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBpbmNyZW1lbnRBcGlDYWxsQ291bnQoKSB7XG4gICAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XG4gICAgICAgIFxuICAgICAgICAvLyBSZXNldCBjb3VudGVyIGlmIGl0J3MgYSBuZXcgZGF5XG4gICAgICAgIGlmICh0aGlzLmxhc3RBcGlDYWxsRGF0ZSAhPT0gdG9kYXkpIHtcbiAgICAgICAgICAgIHRoaXMuYXBpQ2FsbHNUb2RheSA9IDA7XG4gICAgICAgICAgICB0aGlzLmxhc3RBcGlDYWxsRGF0ZSA9IHRvZGF5O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aGlzLmFwaUNhbGxzVG9kYXkrKztcbiAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2hhbmdlZCB0byBwdWJsaWMgc28gaXQgY2FuIGJlIGFjY2Vzc2VkIGZyb20gRGFpbHlOZXdzU2V0dGluZ1RhYlxuICAgIHB1YmxpYyB1cGRhdGVTdGF0dXNCYXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnN0YXR1c0Jhckl0ZW0pIHtcbiAgICAgICAgICAgIGNvbnN0IGFwaVN0YXR1cyA9IHRoaXMuc2V0dGluZ3MuY29uc2VydmVBcGlDYWxscyA/IFxuICAgICAgICAgICAgICAgIGAgfCBBUEk6ICR7dGhpcy5hcGlDYWxsc1RvZGF5fS8ke3RoaXMuc2V0dGluZ3MuYXBpQ2FsbHNQZXJEYXl9YCA6ICcnO1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLnNldFRleHQoYFx1RDgzRFx1RENGMCBEYWlseSBOZXdzIFJlYWR5JHthcGlTdGF0dXN9YCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHJpdmF0ZSBjYW5NYWtlQXBpQ2FsbCgpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLmNvbnNlcnZlQXBpQ2FsbHMpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpcy5hcGlDYWxsc1RvZGF5IDwgdGhpcy5zZXR0aW5ncy5hcGlDYWxsc1BlckRheTtcbiAgICB9XG5cbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBhc3luYyBmZXRjaE5ld3ModG9waWM6IHN0cmluZyk6IFByb21pc2U8TmV3c0l0ZW1bXT4ge1xuICAgICAgICAvLyBDaGVjayBpZiB3ZSBjYW4gbWFrZSBBUEkgY2FsbHNcbiAgICAgICAgaWYgKCF0aGlzLmNhbk1ha2VBcGlDYWxsKCkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBUEkgY2FsbCBsaW1pdCByZWFjaGVkIGZvciB0b2RheS4gU2tpcHBpbmcgc2VhcmNoIGZvcjonLCB0b3BpYyk7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBBUEkgY2FsbCBsaW1pdCByZWFjaGVkICgke3RoaXMuc2V0dGluZ3MuYXBpQ2FsbHNQZXJEYXl9L2RheSkuIFRyeSBhZ2FpbiB0b21vcnJvdy5gKTtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgYSBtb3JlIHNwZWNpZmljIHNlYXJjaCBxdWVyeSB3aXRoIGJldHRlciBrZXl3b3Jkc1xuICAgICAgICBsZXQgc2VhcmNoUXVlcnkgPSAnJztcbiAgICAgICAgXG4gICAgICAgIC8vIENob29zZSBiZXR3ZWVuIGVuaGFuY2VkIG9yIGJhc2ljIHF1ZXJpZXNcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MudXNlRW5oYW5jZWRTZWFyY2hRdWVyaWVzKSB7XG4gICAgICAgICAgICAvLyBFbmhhbmNlZCB0b3BpYy1zcGVjaWZpYyBzZWFyY2ggcXVlcmllc1xuICAgICAgICAgICAgc3dpdGNoKHRvcGljLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICBjYXNlICd0ZWNobm9sb2d5JzpcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoUXVlcnkgPSBgJHt0b3BpY30gbmV3cyBcImxhdGVzdCBkZXZlbG9wbWVudHNcIiBPUiBcIm5ldyByZXNlYXJjaFwiIE9SIFwiYnJlYWt0aHJvdWdoXCIgT1IgXCJpbm5vdmF0aW9uXCIgT1IgXCJsYXVuY2hcIiAtb2xkIC1vdXRkYXRlZGA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3dvcmxkIG5ld3MnOlxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hRdWVyeSA9IGAke3RvcGljfSBcImludGVybmF0aW9uYWwgcmVsYXRpb25zXCIgT1IgXCJnbG9iYWwgYWZmYWlyc1wiIE9SIFwiZm9yZWlnbiBwb2xpY3lcIiBPUiBcImRpcGxvbWF0aWNcIiBPUiBcImdlb3BvbGl0aWNhbFwiIC1zcGVjdWxhdGlvbiAtcnVtb3JgO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdidXNpbmVzcyc6XG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaFF1ZXJ5ID0gYCR7dG9waWN9IG5ld3MgXCJmaW5hbmNpYWwgcmVzdWx0c1wiIE9SIFwibWFya2V0IHRyZW5kc1wiIE9SIFwiZWFybmluZ3NcIiBPUiBcImVjb25vbWljIGRhdGFcIiBPUiBcIm1lcmdlclwiIC1zcGVjdWxhdGl2ZWA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3NjaWVuY2UnOlxuICAgICAgICAgICAgICAgICAgICBzZWFyY2hRdWVyeSA9IGAke3RvcGljfSBuZXdzIFwiZGlzY292ZXJ5XCIgT1IgXCJyZXNlYXJjaCBmaW5kaW5nc1wiIE9SIFwic3R1ZHkgcmVzdWx0c1wiIE9SIFwic2NpZW50aWZpYyBicmVha3Rocm91Z2hcIiAtcHJlbGltaW5hcnkgLXVuY29uZmlybWVkYDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnaGVhbHRoJzpcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoUXVlcnkgPSBgJHt0b3BpY30gbmV3cyBcIm1lZGljYWwgcmVzZWFyY2hcIiBPUiBcImhlYWx0aCBzdHVkeVwiIE9SIFwiY2xpbmljYWwgdHJpYWxcIiBPUiBcInRyZWF0bWVudCBicmVha3Rocm91Z2hcIiAtdW52ZXJpZmllZGA7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaFF1ZXJ5ID0gYCR7dG9waWN9IG5ld3MgXCJsYXRlc3QgZGV2ZWxvcG1lbnRzXCIgT1IgXCJyZWNlbnQgZXZlbnRzXCIgT1IgXCJzaWduaWZpY2FudCBkZXZlbG9wbWVudHNcIiBPUiBcImltcG9ydGFudCB1cGRhdGVcImA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBCYXNpYyBzZWFyY2ggcXVlcnlcbiAgICAgICAgICAgIHNlYXJjaFF1ZXJ5ID0gYCR7dG9waWN9IG5ld3NgO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgZXhhY3QgcGhyYXNlcyBpZiBzcGVjaWZpZWRcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3Muc2VhcmNoRXhhY3RQaHJhc2VzICYmIHRoaXMuc2V0dGluZ3Muc2VhcmNoRXhhY3RQaHJhc2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGhyYXNlIG9mIHRoaXMuc2V0dGluZ3Muc2VhcmNoRXhhY3RQaHJhc2VzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBocmFzZS50cmltKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoUXVlcnkgKz0gYCBcIiR7cGhyYXNlLnRyaW0oKX1cImA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgZXhjbHVkZWQgdGVybXMgaWYgc3BlY2lmaWVkXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnNlYXJjaEV4Y2x1ZGVUZXJtcyAmJiB0aGlzLnNldHRpbmdzLnNlYXJjaEV4Y2x1ZGVUZXJtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHRlcm0gb2YgdGhpcy5zZXR0aW5ncy5zZWFyY2hFeGNsdWRlVGVybXMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGVybS50cmltKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoUXVlcnkgKz0gYCAtJHt0ZXJtLnRyaW0oKX1gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUubG9nKGBVc2luZyBzZWFyY2ggcXVlcnkgZm9yICR7dG9waWN9OiAke3NlYXJjaFF1ZXJ5fWApO1xuXG4gICAgICAgIC8vIEdldCBkYXRlIHJhbmdlIHBhcmFtZXRlclxuICAgICAgICBjb25zdCBkYXRlUmFuZ2VQYXJhbSA9IHRoaXMuZ2V0T3B0aW1pemVkRGF0ZVJhbmdlKCk7XG5cbiAgICAgICAgLy8gQnVpbGQgc2VhcmNoIHBhcmFtZXRlcnNcbiAgICAgICAgY29uc3QgbWF4UmVzdWx0c1BlclJlcXVlc3QgPSAxMDsgLy8gQVBJIGxpbWl0YXRpb25cbiAgICAgICAgXG4gICAgICAgIC8vIERldGVybWluZSBob3cgbWFueSByZXF1ZXN0cyB0byBtYWtlIGJhc2VkIG9uIHNldHRpbmdzXG4gICAgICAgIGNvbnN0IHRvdGFsUmVzdWx0c1RvRmV0Y2ggPSB0aGlzLnNldHRpbmdzLmNvbnNlcnZlQXBpQ2FsbHMgPyBcbiAgICAgICAgICAgIG1heFJlc3VsdHNQZXJSZXF1ZXN0IDogXG4gICAgICAgICAgICBNYXRoLm1pbigyMCwgdGhpcy5zZXR0aW5ncy5uZXdzX251bWJlcik7XG4gICAgICAgICAgICBcbiAgICAgICAgY29uc3QgbnVtUmVxdWVzdHMgPSBNYXRoLmNlaWwodG90YWxSZXN1bHRzVG9GZXRjaCAvIG1heFJlc3VsdHNQZXJSZXF1ZXN0KTtcbiAgICAgICAgXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBDb2xsZWN0IGFsbCBuZXdzIGl0ZW1zIGZyb20gbXVsdGlwbGUgcGFnaW5hdGVkIHJlcXVlc3RzXG4gICAgICAgICAgICBsZXQgYWxsTmV3c0l0ZW1zOiBTZWFyY2hJdGVtW10gPSBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRmlyc3QgdHJ5IHdpdGggaGlnaC1xdWFsaXR5IHNvdXJjZXMgcHJpb3JpdGl6ZWRcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLnByZWZlcnJlZERvbWFpbnMgJiYgdGhpcy5zZXR0aW5ncy5wcmVmZXJyZWREb21haW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBNYWtlIGEgdGFyZ2V0ZWQgcmVxdWVzdCBmb3IgaGlnaC1xdWFsaXR5IHNvdXJjZXMgZmlyc3RcbiAgICAgICAgICAgICAgICBjb25zdCBoaWdoUXVhbGl0eU5ld3NJdGVtcyA9IGF3YWl0IHRoaXMubWFrZVNlYXJjaFJlcXVlc3QoXG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaFF1ZXJ5LCBcbiAgICAgICAgICAgICAgICAgICAgMSwgXG4gICAgICAgICAgICAgICAgICAgIGRhdGVSYW5nZVBhcmFtLCBcbiAgICAgICAgICAgICAgICAgICAgdHJ1ZSwgLy8gcHJpb3JpdGl6ZSBwcmVmZXJyZWQgZG9tYWluc1xuICAgICAgICAgICAgICAgICAgICBtYXhSZXN1bHRzUGVyUmVxdWVzdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGhpZ2hRdWFsaXR5TmV3c0l0ZW1zICYmIGhpZ2hRdWFsaXR5TmV3c0l0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYWxsTmV3c0l0ZW1zID0gWy4uLmhpZ2hRdWFsaXR5TmV3c0l0ZW1zXTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYEZvdW5kICR7aGlnaFF1YWxpdHlOZXdzSXRlbXMubGVuZ3RofSBoaWdoLXF1YWxpdHkgaXRlbXMgZm9yICR7dG9waWN9YCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJZiB3ZSBkaWRuJ3QgZ2V0IGVub3VnaCByZXN1bHRzIGZyb20gcHJlZmVycmVkIHNvdXJjZXMsIG9yIGRvbid0IGhhdmUgcHJlZmVycmVkIHNvdXJjZXMsXG4gICAgICAgICAgICAvLyBjb250aW51ZSB3aXRoIHJlZ3VsYXIgcGFnaW5hdGlvblxuICAgICAgICAgICAgaWYgKGFsbE5ld3NJdGVtcy5sZW5ndGggPCB0b3RhbFJlc3VsdHNUb0ZldGNoKSB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1SZXF1ZXN0czsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIEFQSSBjYWxsIGxpbWl0IGJlZm9yZSBlYWNoIHJlcXVlc3RcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLmNhbk1ha2VBcGlDYWxsKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBBUEkgY2FsbCBsaW1pdCByZWFjaGVkLiBTdG9wcGluZyBhZnRlciAke2l9IHJlcXVlc3RzIGZvciB0b3BpYzpgLCB0b3BpYyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IGkgKiBtYXhSZXN1bHRzUGVyUmVxdWVzdCArIDE7IC8vIEdvb2dsZSB1c2VzIDEtYmFzZWQgaW5kZXhpbmdcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld0l0ZW1zID0gYXdhaXQgdGhpcy5tYWtlU2VhcmNoUmVxdWVzdChcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaFF1ZXJ5LCBcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0SW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlUmFuZ2VQYXJhbSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhbHNlLCAvLyBkb24ndCBwcmlvcml0aXplIGRvbWFpbnMgYWdhaW5cbiAgICAgICAgICAgICAgICAgICAgICAgIG1heFJlc3VsdHNQZXJSZXF1ZXN0XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAoIW5ld0l0ZW1zIHx8IG5ld0l0ZW1zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEFkZCB1bmlxdWUgcmVzdWx0cyBvbmx5IChubyBkdXBsaWNhdGVzKVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgbmV3SXRlbXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWxsTmV3c0l0ZW1zLnNvbWUoZXhpc3RpbmdJdGVtID0+IGV4aXN0aW5nSXRlbS5saW5rID09PSBpdGVtLmxpbmspKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsTmV3c0l0ZW1zLnB1c2goaXRlbSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIGhhdmUgZW5vdWdoIHJlc3VsdHMsIHN0b3AgbWFraW5nIHJlcXVlc3RzXG4gICAgICAgICAgICAgICAgICAgIGlmIChhbGxOZXdzSXRlbXMubGVuZ3RoID49IHRvdGFsUmVzdWx0c1RvRmV0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBBZGQgYSBkZWxheSBiZXR3ZWVuIHJlcXVlc3RzIHRvIGF2b2lkIHJhdGUgbGltaXRpbmdcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCBudW1SZXF1ZXN0cyAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChhbGxOZXdzSXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYE5vIG5ld3MgaXRlbXMgZm91bmQgZm9yIHRvcGljOiAke3RvcGljfWApO1xuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc29sZS5sb2coYEZvdW5kIHRvdGFsIG9mICR7YWxsTmV3c0l0ZW1zLmxlbmd0aH0gaXRlbXMgZm9yICR7dG9waWN9YCk7XG5cbiAgICAgICAgICAgIC8vIE1hcCBzZWFyY2ggaXRlbXMgdG8gbmV3cyBpdGVtcyB3aXRoIHJpY2ggbWV0YWRhdGFcbiAgICAgICAgICAgIGxldCBuZXdzSXRlbXMgPSBhbGxOZXdzSXRlbXMubWFwKChpdGVtOiBTZWFyY2hJdGVtKTogTmV3c0l0ZW0gPT4ge1xuICAgICAgICAgICAgICAgIC8vIEV4dHJhY3QgZG9tYWluIGZyb20gVVJMXG4gICAgICAgICAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChpdGVtLmxpbmspO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRvbWFpbiA9IHVybC5ob3N0bmFtZS5yZXBsYWNlKCd3d3cuJywgJycpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEV4dHJhY3Qgc291cmNlIG5hbWUgZnJvbSBtZXRhZGF0YSBvciBVUkxcbiAgICAgICAgICAgICAgICBjb25zdCBzb3VyY2UgPSBpdGVtLnBhZ2VtYXA/Lm1ldGF0YWdzPy5bMF0/Lm9nX3NpdGVfbmFtZSB8fCBkb21haW47XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGl0ZW0udGl0bGUsXG4gICAgICAgICAgICAgICAgICAgIGxpbms6IGl0ZW0ubGluayxcbiAgICAgICAgICAgICAgICAgICAgc25pcHBldDogaXRlbS5zbmlwcGV0LFxuICAgICAgICAgICAgICAgICAgICBwdWJsaXNoZWRUaW1lOiBpdGVtLnBhZ2VtYXA/Lm1ldGF0YWdzPy5bMF0/LnB1Ymxpc2hlZFRpbWUsXG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZTogc291cmNlLFxuICAgICAgICAgICAgICAgICAgICByZWxldmFuY2VTY29yZTogdGhpcy5jYWxjdWxhdGVSZWxldmFuY2VTY29yZShpdGVtLCB0b3BpYylcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEFwcGx5IGVuaGFuY2VkIGZpbHRlcmluZ1xuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MudXNlQWR2YW5jZWRGaWx0ZXJpbmcpIHtcbiAgICAgICAgICAgICAgICBuZXdzSXRlbXMgPSB0aGlzLmFwcGx5QWR2YW5jZWRGaWx0ZXJpbmcobmV3c0l0ZW1zKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSWYgbm8gaXRlbXMgYWZ0ZXIgZmlsdGVyaW5nLCB0cnkgYSBicm9hZGVyIHNlYXJjaFxuICAgICAgICAgICAgaWYgKG5ld3NJdGVtcy5sZW5ndGggPT09IDAgJiYgdGhpcy5jYW5NYWtlQXBpQ2FsbCgpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coYE5vIGl0ZW1zIGFmdGVyIGZpbHRlcmluZyBmb3IgJHt0b3BpY30uIFRyeWluZyBicm9hZGVyIHNlYXJjaC4uLmApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEJyb2FkZXIgc2VhcmNoIHdpdGggZmV3ZXIgY29uc3RyYWludHNcbiAgICAgICAgICAgICAgICBjb25zdCBicm9hZGVyUXVlcnkgPSBgJHt0b3BpY30gbmV3cyBsYXRlc3RgO1xuICAgICAgICAgICAgICAgIGNvbnN0IGJyb2FkZXJJdGVtcyA9IGF3YWl0IHRoaXMubWFrZVNlYXJjaFJlcXVlc3QoXG4gICAgICAgICAgICAgICAgICAgIGJyb2FkZXJRdWVyeSxcbiAgICAgICAgICAgICAgICAgICAgMSxcbiAgICAgICAgICAgICAgICAgICAgJ3cxJywgLy8gRXhwYW5kIHRvIGEgd2VlayB0byBnZXQgbW9yZSByZXN1bHRzXG4gICAgICAgICAgICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBtYXhSZXN1bHRzUGVyUmVxdWVzdFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGJyb2FkZXJJdGVtcyAmJiBicm9hZGVySXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRm91bmQgJHticm9hZGVySXRlbXMubGVuZ3RofSBpdGVtcyB3aXRoIGJyb2FkZXIgc2VhcmNoIGZvciAke3RvcGljfWApO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgbmV3c0l0ZW1zID0gYnJvYWRlckl0ZW1zLm1hcCgoaXRlbTogU2VhcmNoSXRlbSk6IE5ld3NJdGVtID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoaXRlbS5saW5rKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRvbWFpbiA9IHVybC5ob3N0bmFtZS5yZXBsYWNlKCd3d3cuJywgJycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc291cmNlID0gaXRlbS5wYWdlbWFwPy5tZXRhdGFncz8uWzBdPy5vZ19zaXRlX25hbWUgfHwgZG9tYWluO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBpdGVtLnRpdGxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbms6IGl0ZW0ubGluayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbmlwcGV0OiBpdGVtLnNuaXBwZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHVibGlzaGVkVGltZTogaXRlbS5wYWdlbWFwPy5tZXRhdGFncz8uWzBdPy5wdWJsaXNoZWRUaW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogc291cmNlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbGV2YW5jZVNjb3JlOiB0aGlzLmNhbGN1bGF0ZVJlbGV2YW5jZVNjb3JlKGl0ZW0sIHRvcGljKSAqIDAuOCAvLyBSZWR1Y2Ugc2NvcmUgc2xpZ2h0bHkgZm9yIGJyb2FkZXIgcmVzdWx0c1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBMZXNzIGFnZ3Jlc3NpdmUgZmlsdGVyaW5nIGZvciBicm9hZGVyIHNlYXJjaFxuICAgICAgICAgICAgICAgICAgICBuZXdzSXRlbXMgPSBuZXdzSXRlbXMuZmlsdGVyKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT25seSBmaWx0ZXIgb3V0IHZlcnkgbG93IHJlbGV2YW5jZSBpdGVtc1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIChpdGVtLnJlbGV2YW5jZVNjb3JlIHx8IDApID49IE1hdGgubWF4KDMsIHRoaXMuc2V0dGluZ3MuY29udGVudFJlbGV2YW5jZVNjb3JlIC0gMik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU29ydCBieSByZWxldmFuY2Ugb3IgZGF0ZVxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlU291cmNlUmFua2luZykge1xuICAgICAgICAgICAgICAgIC8vIFNvcnQgYnkgcmVsZXZhbmNlIHNjb3JlIGZpcnN0XG4gICAgICAgICAgICAgICAgbmV3c0l0ZW1zLnNvcnQoKGE6IE5ld3NJdGVtLCBiOiBOZXdzSXRlbSkgPT4gXG4gICAgICAgICAgICAgICAgICAgIChiLnJlbGV2YW5jZVNjb3JlIHx8IDApIC0gKGEucmVsZXZhbmNlU2NvcmUgfHwgMClcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNldHRpbmdzLnNvcnRCeURhdGUpIHtcbiAgICAgICAgICAgICAgICAvLyBTb3J0IGJ5IHB1Ymxpc2hlZCBkYXRlXG4gICAgICAgICAgICAgICAgbmV3c0l0ZW1zLnNvcnQoKGE6IE5ld3NJdGVtLCBiOiBOZXdzSXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIWEucHVibGlzaGVkVGltZSkgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgICAgIGlmICghYi5wdWJsaXNoZWRUaW1lKSByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShiLnB1Ymxpc2hlZFRpbWUpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGEucHVibGlzaGVkVGltZSkuZ2V0VGltZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbmV3c0l0ZW1zO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGZldGNoIG5ld3M6JywgZXJyb3IpO1xuICAgICAgICAgICAgbmV3IE5vdGljZShgRmFpbGVkIHRvIGZldGNoIG5ld3MgZm9yIHRvcGljIFwiJHt0b3BpY31cIi4gQ2hlY2sgY29uc29sZSBmb3IgZGV0YWlscy5gKTtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhlbHBlciBtZXRob2RzIGZvciBuZXdzIGZldGNoaW5nXG4gICAgcHJpdmF0ZSBhc3luYyBtYWtlU2VhcmNoUmVxdWVzdChcbiAgICAgICAgcXVlcnk6IHN0cmluZywgXG4gICAgICAgIHN0YXJ0SW5kZXg6IG51bWJlciwgXG4gICAgICAgIGRhdGVSZXN0cmljdDogc3RyaW5nLFxuICAgICAgICBwcmlvcml0aXplUHJlZmVycmVkRG9tYWluczogYm9vbGVhbixcbiAgICAgICAgbnVtUmVzdWx0czogbnVtYmVyXG4gICAgKTogUHJvbWlzZTxTZWFyY2hJdGVtW10+IHtcbiAgICAgICAgLy8gQmFzZSBwYXJhbWV0ZXJzIGZvciB0aGUgc2VhcmNoIHJlcXVlc3RcbiAgICAgICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgICAgICBrZXk6IHRoaXMuc2V0dGluZ3MuZ29vZ2xlQXBpS2V5LFxuICAgICAgICAgICAgY3g6IHRoaXMuc2V0dGluZ3Muc2VhcmNoRW5naW5lSWQsXG4gICAgICAgICAgICBxOiBxdWVyeSxcbiAgICAgICAgICAgIG51bTogbnVtUmVzdWx0cy50b1N0cmluZygpLFxuICAgICAgICAgICAgZGF0ZVJlc3RyaWN0OiBkYXRlUmVzdHJpY3QsXG4gICAgICAgICAgICBmaWVsZHM6ICdpdGVtcyh0aXRsZSxsaW5rLHNuaXBwZXQscGFnZW1hcC9tZXRhdGFncy9wdWJsaXNoZWRUaW1lLHBhZ2VtYXAvbWV0YXRhZ3Mvb2dfc2l0ZV9uYW1lKScsXG4gICAgICAgICAgICBzb3J0OiAnZGF0ZScsXG4gICAgICAgICAgICBzdGFydDogc3RhcnRJbmRleC50b1N0cmluZygpXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHNpdGU6IG9wZXJhdG9yIGZvciBwcmVmZXJyZWQgZG9tYWlucyBpZiBzcGVjaWZpZWRcbiAgICAgICAgaWYgKHByaW9yaXRpemVQcmVmZXJyZWREb21haW5zICYmIHRoaXMuc2V0dGluZ3MucHJlZmVycmVkRG9tYWlucyAmJiB0aGlzLnNldHRpbmdzLnByZWZlcnJlZERvbWFpbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3Qgc2l0ZXNRdWVyeSA9IHRoaXMuc2V0dGluZ3MucHJlZmVycmVkRG9tYWlucy5tYXAoZG9tYWluID0+IGBzaXRlOiR7ZG9tYWlufWApLmpvaW4oJyBPUiAnKTtcbiAgICAgICAgICAgIHBhcmFtcy5zZXQoJ3EnLCBgJHtwYXJhbXMuZ2V0KCdxJyl9ICgke3NpdGVzUXVlcnl9KWApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhgTWFraW5nIEFQSSByZXF1ZXN0IHdpdGggcXVlcnk6ICR7cGFyYW1zLmdldCgncScpfWApO1xuICAgICAgICBcbiAgICAgICAgLy8gSW5jcmVtZW50IEFQSSBjYWxsIGNvdW50ZXJcbiAgICAgICAgdGhpcy5pbmNyZW1lbnRBcGlDYWxsQ291bnQoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5yZXRyeU9wZXJhdGlvbihhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgICAgICAgICBgaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vY3VzdG9tc2VhcmNoL3YxPyR7cGFyYW1zLnRvU3RyaW5nKCl9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICghcmVzLm9rKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzLmpzb24oKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQVBJIEVycm9yIERldGFpbHM6JywgZXJyb3JEYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBzdGF0dXM6ICR7cmVzLnN0YXR1c30sIGRldGFpbHM6ICR7SlNPTi5zdHJpbmdpZnkoZXJyb3JEYXRhKX1gKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Jlcy5zdGF0dXN9LCBjb3VsZG4ndCBwYXJzZSBlcnJvciBkZXRhaWxzYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgZGF0YTogQ3VzdG9tU2VhcmNoUmVzcG9uc2UgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWRhdGEgfHwgIWRhdGEuaXRlbXMgfHwgZGF0YS5pdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBObyByZXN1bHRzIGZvdW5kIGZvciBxdWVyeTogJHtwYXJhbXMuZ2V0KCdxJyl9YCk7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBkYXRhLml0ZW1zO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0T3B0aW1pemVkRGF0ZVJhbmdlKCk6IHN0cmluZyB7XG4gICAgICAgIC8vIFN0YXJ0IHdpdGggdGhlIHVzZXItY29uZmlndXJlZCBkYXRlIHJhbmdlXG4gICAgICAgIGxldCBkYXRlUmFuZ2UgPSB0aGlzLnNldHRpbmdzLnNlYXJjaERhdGVSYW5nZTtcbiAgICAgICAgXG4gICAgICAgIC8vIElmIG5vIHZhbGlkIGRhdGUgcmFuZ2UgaXMgc3BlY2lmaWVkLCBkZWZhdWx0IHRvIHRoZSBwYXN0IDIgZGF5c1xuICAgICAgICBpZiAoIWRhdGVSYW5nZS5tYXRjaCgvXltkd11cXGQrJC8pKSB7XG4gICAgICAgICAgICBkYXRlUmFuZ2UgPSAnZDInO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZGF0ZVJhbmdlO1xuICAgIH1cblxuICAgIC8vIEVuaGFuY2VkIHJlbGV2YW5jZSBzY29yaW5nXG4gICAgcHJpdmF0ZSBjYWxjdWxhdGVSZWxldmFuY2VTY29yZShpdGVtOiBTZWFyY2hJdGVtLCB0b3BpYzogc3RyaW5nKTogbnVtYmVyIHtcbiAgICAgICAgbGV0IHNjb3JlID0gNTsgLy8gQmFzZSBzY29yZVxuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBkb21haW4gYW5kIGNoZWNrIGlmIGl0J3MgYSBxdWFsaXR5IHNvdXJjZVxuICAgICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGl0ZW0ubGluayk7XG4gICAgICAgIGNvbnN0IGRvbWFpbiA9IHVybC5ob3N0bmFtZS5yZXBsYWNlKCd3d3cuJywgJycpO1xuICAgICAgICBcbiAgICAgICAgLy8gTWFqb3IgYm9vc3QgZm9yIGhpZ2gtcXVhbGl0eSBzb3VyY2VzXG4gICAgICAgIGlmIChRVUFMSVRZX05FV1NfU09VUkNFUy5zb21lKHNvdXJjZSA9PiBkb21haW4uaW5jbHVkZXMoc291cmNlKSkpIHtcbiAgICAgICAgICAgIHNjb3JlICs9IDM7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGZvciBhcnRpY2xlLWxpa2UgVVJMIHBhdHRlcm5zIChoaWdoZXIgcXVhbGl0eSB0aGFuIGluZGV4L2NhdGVnb3J5IHBhZ2VzKVxuICAgICAgICBpZiAoL1xcL2FydGljbGVcXC98XFwvc3RvcnlcXC98XFwvbmV3c1xcL3xcXC9cXGR7NH1cXC9cXGR7Mn1cXC98Wy1dXFxkK1xcLmh0bWwkLy50ZXN0KGl0ZW0ubGluaykpIHtcbiAgICAgICAgICAgIHNjb3JlICs9IDI7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIHRoZSBVUkwgcGF0dGVybiBzdWdnZXN0cyBpdCdzIGFuIGFjdHVhbCBhcnRpY2xlIGFuZCBub3QgYSBob21lcGFnZVxuICAgICAgICBpZiAodXJsLnBhdGhuYW1lLmxlbmd0aCA+IDEgJiYgdXJsLnBhdGhuYW1lICE9PSBcIi9cIiAmJiAhdXJsLnBhdGhuYW1lLmVuZHNXaXRoKFwiL1wiKSkge1xuICAgICAgICAgICAgc2NvcmUgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gU3Ryb25nbHkgcGVuYWxpemUgbm9uLWFydGljbGUgVVJMc1xuICAgICAgICBpZiAodXJsLnBhdGhuYW1lID09PSBcIi9cIiB8fCB1cmwucGF0aG5hbWUgPT09IFwiXCIgfHwgdXJsLnBhdGhuYW1lLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgICAgIHNjb3JlIC09IDQ7IC8vIEhvbWVwYWdlIG9yIHZlcnkgc2hvcnQgVVJMIC0gbGlrZWx5IG5vdCBhbiBhcnRpY2xlXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFBlbmFsaXplIGNhdGVnb3J5IHBhZ2VzXG4gICAgICAgIGlmICgvXFwvY2F0ZWdvcnlcXC98XFwvY2F0ZWdvcmllc1xcL3xcXC90b3BpY3NcXC98XFwvc2VjdGlvbnNcXC98XFwvdGFnXFwvfFxcL3RhZ3NcXC8vLnRlc3QoaXRlbS5saW5rKSkge1xuICAgICAgICAgICAgc2NvcmUgLT0gMztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gU25pcHBldCBsZW5ndGggKGxvbmdlciBvZnRlbiBtZWFucyBtb3JlIHN1YnN0YW50aWFsKVxuICAgICAgICBpZiAoaXRlbS5zbmlwcGV0ICYmIGl0ZW0uc25pcHBldC5sZW5ndGggPiAyMDApIHtcbiAgICAgICAgICAgIHNjb3JlICs9IDE7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFRpdGxlIGNvbnRhaW5zIHRvcGljIGtleXdvcmRzXG4gICAgICAgIGlmIChpdGVtLnRpdGxlICYmIGl0ZW0udGl0bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh0b3BpYy50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgICAgICAgc2NvcmUgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIG1lYW5pbmdmdWwgY29udGVudCBpbmRpY2F0b3JzIC0gZGF0YSwgcXVvdGVzLCBzcGVjaWZpY2l0eVxuICAgICAgICBpZiAoaXRlbS5zbmlwcGV0KSB7XG4gICAgICAgICAgICAvLyBDb250YWlucyBjb25jcmV0ZSBkYXRhIHBvaW50cyAobnVtYmVycyBvZnRlbiBpbmRpY2F0ZSBzdWJzdGFuY2UpXG4gICAgICAgICAgICBpZiAoL1xcZCslfFxcZCsgcGVyY2VudHxcXCRcXGQrfFxcZCsgbWlsbGlvbnxcXGQrIGJpbGxpb24vLnRlc3QoaXRlbS5zbmlwcGV0KSkge1xuICAgICAgICAgICAgICAgIHNjb3JlICs9IDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENvbnRhaW5zIHNwZWNpZmljIGRhdGVzIChvZnRlbiBpbmRpY2F0ZXMgcmVhbCBuZXdzKVxuICAgICAgICAgICAgaWYgKC9KYW51YXJ5fEZlYnJ1YXJ5fE1hcmNofEFwcmlsfE1heXxKdW5lfEp1bHl8QXVndXN0fFNlcHRlbWJlcnxPY3RvYmVyfE5vdmVtYmVyfERlY2VtYmVyIFxcZHsxLDJ9KHN0fG5kfHJkfHRoKT8vLnRlc3QoaXRlbS5zbmlwcGV0KSkge1xuICAgICAgICAgICAgICAgIHNjb3JlICs9IDEuNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ29udGFpbnMgcXVvdGVzIChvZnRlbiBpbmRpY2F0ZXMgYWN0dWFsIHJlcG9ydGluZylcbiAgICAgICAgICAgIGlmICgvXCJbXlwiXXsxMCx9XCIvLnRlc3QoaXRlbS5zbmlwcGV0KSB8fCAvJ1teJ117MTAsfScvLnRlc3QoaXRlbS5zbmlwcGV0KSkge1xuICAgICAgICAgICAgICAgIHNjb3JlICs9IDEuNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ29udGFpbnMgcmVwb3J0aW5nIHZlcmJzIGluZGljYXRpbmcgb3JpZ2luYWwgY29udGVudFxuICAgICAgICAgICAgaWYgKC9yZXBvcnRlZHxhbm5vdW5jZWR8cmV2ZWFsZWR8cHVibGlzaGVkfHJlbGVhc2VkfHN0YXRlZHxjb25maXJtZWR8c2FpZHxhY2NvcmRpbmcgdG8vaS50ZXN0KGl0ZW0uc25pcHBldCkpIHtcbiAgICAgICAgICAgICAgICBzY29yZSArPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDb250YWlucyB2ZXJ5IGdlbmVyYWwgZGVzY3JpcHRpb25zIChsaWtlbHkgc2l0ZSBkZXNjcmlwdGlvbnMsIG5vdCBhcnRpY2xlcylcbiAgICAgICAgICAgIGlmICgvcHJvdmlkZXMgbmV3c3xsYXRlc3QgbmV3c3xicmVha2luZyBuZXdzfG5ld3MgYW5kIGluZm9ybWF0aW9ufGNvdmVyYWdlIG9mfG5ld3MgZnJvbXxoZWFkbGluZXMgZnJvbS9pLnRlc3QoaXRlbS5zbmlwcGV0KSAmJiBpdGVtLnNuaXBwZXQubGVuZ3RoIDwgMTIwKSB7XG4gICAgICAgICAgICAgICAgc2NvcmUgLT0gMztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRGV0ZWN0cyB3ZWJzaXRlIGRlc2NyaXB0aW9ucyByYXRoZXIgdGhhbiBhY3R1YWwgbmV3c1xuICAgICAgICAgICAgaWYgKC9pcyBhIHdlYnNpdGV8aXMgdGhlIG9mZmljaWFsfGlzIGFuIG9ubGluZXx3ZWJzaXRlIG9mfGhvbWVwYWdlIG9mfG9mZmljaWFsIHNpdGUvaS50ZXN0KGl0ZW0uc25pcHBldCkpIHtcbiAgICAgICAgICAgICAgICBzY29yZSAtPSA0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBUaXRsZSBpbmRpY2F0b3JzXG4gICAgICAgIGlmIChpdGVtLnRpdGxlKSB7XG4gICAgICAgICAgICAvLyBUaXRsZSBzZWVtcyBjbGlja2JhaXR5XG4gICAgICAgICAgICBpZiAoL3lvdSB3b24ndCBiZWxpZXZlfHNob2NraW5nfGFtYXppbmd8bWluZC1ibG93aW5nfGluY3JlZGlibGV8dG9wIFxcZCsgd2F5cy9pLnRlc3QoaXRlbS50aXRsZSkpIHtcbiAgICAgICAgICAgICAgICBzY29yZSAtPSAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBUaXRsZSBpbmRpY2F0ZXMgaXQncyBqdXN0IGEgd2Vic2l0ZSBkZXNjcmlwdGlvblxuICAgICAgICAgICAgaWYgKC9vZmZpY2lhbCB3ZWJzaXRlfGhvbWVwYWdlfHdlbGNvbWUgdG8vaS50ZXN0KGl0ZW0udGl0bGUpKSB7XG4gICAgICAgICAgICAgICAgc2NvcmUgLT0gMztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVmVyeSBzaG9ydCBzbmlwcGV0XG4gICAgICAgIGlmICghaXRlbS5zbmlwcGV0IHx8IGl0ZW0uc25pcHBldC5sZW5ndGggPCB0aGlzLnNldHRpbmdzLm1pblNuaXBwZXRMZW5ndGgpIHtcbiAgICAgICAgICAgIHNjb3JlIC09IDM7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIElzIGZyb20gcHJlZmVycmVkIGRvbWFpbnMgbGlzdCAoYWRkaXRpb25hbCBib29zdClcbiAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MucHJlZmVycmVkRG9tYWlucyAmJiBcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MucHJlZmVycmVkRG9tYWlucy5zb21lKHByZWZlcnJlZERvbWFpbiA9PiBkb21haW4uaW5jbHVkZXMocHJlZmVycmVkRG9tYWluKSkpIHtcbiAgICAgICAgICAgIHNjb3JlICs9IDI7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIElzIGZyb20gZXhwbGljaXRseSBleGNsdWRlZCBkb21haW5zXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmV4Y2x1ZGVkRG9tYWlucyAmJiBcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuZXhjbHVkZWREb21haW5zLnNvbWUoZXhjbHVkZWREb21haW4gPT4gZG9tYWluLmluY2x1ZGVzKGV4Y2x1ZGVkRG9tYWluKSkpIHtcbiAgICAgICAgICAgIHNjb3JlIC09IDQ7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENsYW1wIHNjb3JlIGJldHdlZW4gMS0xMFxuICAgICAgICByZXR1cm4gTWF0aC5tYXgoMSwgTWF0aC5taW4oMTAsIHNjb3JlKSk7XG4gICAgfVxuXG4gICAgLy8gRW5oYW5jZWQgZmlsdGVyaW5nXG4gICAgcHJpdmF0ZSBhcHBseUFkdmFuY2VkRmlsdGVyaW5nKG5ld3NJdGVtczogTmV3c0l0ZW1bXSk6IE5ld3NJdGVtW10ge1xuICAgICAgICByZXR1cm4gbmV3c0l0ZW1zLmZpbHRlcihpdGVtID0+IHtcbiAgICAgICAgICAgIC8vIEdldCBVUkwgZm9yIHBhdGggYW5hbHlzaXNcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoaXRlbS5saW5rKTtcbiAgICAgICAgICAgIGNvbnN0IGRvbWFpbiA9IHVybC5ob3N0bmFtZS5yZXBsYWNlKCd3d3cuJywgJycpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyAxLiBDaGVjayBmb3IgZXhjbHVkZWQgZG9tYWluc1xuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZXhjbHVkZWREb21haW5zICYmIHRoaXMuc2V0dGluZ3MuZXhjbHVkZWREb21haW5zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5leGNsdWRlZERvbWFpbnMuc29tZShleGNsdWRlZCA9PiBkb21haW4uaW5jbHVkZXMoZXhjbHVkZWQpKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyAyLiBDaGVjayBmb3IgbWluaW11bSBzbmlwcGV0IGxlbmd0aFxuICAgICAgICAgICAgaWYgKCFpdGVtLnNuaXBwZXQgfHwgaXRlbS5zbmlwcGV0Lmxlbmd0aCA8IHRoaXMuc2V0dGluZ3MubWluU25pcHBldExlbmd0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gMy4gQ2hlY2sgZm9yIG1pbmltdW0gcmVsZXZhbmNlIHNjb3JlXG4gICAgICAgICAgICBpZiAoKGl0ZW0ucmVsZXZhbmNlU2NvcmUgfHwgMCkgPCB0aGlzLnNldHRpbmdzLmNvbnRlbnRSZWxldmFuY2VTY29yZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gNC4gRmlsdGVyIG91dCBvYnZpb3VzIGxpc3QgYXJ0aWNsZXMsIHByb2R1Y3Qgcm91bmR1cHMsIGV0Yy5cbiAgICAgICAgICAgIGlmIChpdGVtLnRpdGxlICYmIC90b3AgXFxkK3xiZXN0IFxcZCt8XFxkKyB3YXlzfFxcZCsgdGhpbmdzfGJlc3Qgb2Z8cm91bmR1cC9pLnRlc3QoaXRlbS50aXRsZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIDUuIFJlamVjdCBob21lcGFnZSBVUkxzIHRoYXQgYXJlIGxpa2VseSBub3Qgc3BlY2lmaWMgYXJ0aWNsZXNcbiAgICAgICAgICAgIGlmICh1cmwucGF0aG5hbWUgPT09IFwiL1wiIHx8IHVybC5wYXRobmFtZSA9PT0gXCJcIiB8fCB1cmwucGF0aG5hbWUubGVuZ3RoIDwgMykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBGaWx0ZXJpbmcgb3V0IGhvbWVwYWdlIFVSTDogJHtpdGVtLmxpbmt9YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyA2LiBSZWplY3QgY2F0ZWdvcnkvdGFnIHBhZ2VzXG4gICAgICAgICAgICBpZiAoL1xcL2NhdGVnb3J5XFwvfFxcL2NhdGVnb3JpZXNcXC98XFwvdG9waWNzXFwvfFxcL3NlY3Rpb25zXFwvfFxcL3RhZ1xcL3xcXC90YWdzXFwvLy50ZXN0KGl0ZW0ubGluaykpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRmlsdGVyaW5nIG91dCBjYXRlZ29yeS90YWcgcGFnZTogJHtpdGVtLmxpbmt9YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyA3LiBSZWplY3QgY29udGVudCB0aGF0IGxvb2tzIGxpa2Ugd2Vic2l0ZSBkZXNjcmlwdGlvbnNcbiAgICAgICAgICAgIGlmIChpdGVtLnNuaXBwZXQgJiYgL2lzIGEgd2Vic2l0ZXxpcyB0aGUgb2ZmaWNpYWx8aXMgYW4gb25saW5lfG9mZmljaWFsIHNpdGUgb2Z8aG9tZXBhZ2Ugb2YvaS50ZXN0KGl0ZW0uc25pcHBldCkpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgRmlsdGVyaW5nIG91dCB3ZWJzaXRlIGRlc2NyaXB0aW9uOiAke2l0ZW0udGl0bGV9YCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjbGVhbk5ld3NDb250ZW50KHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5yZW1vdmVBZHMpIHJldHVybiB0ZXh0O1xuICAgICAgICBcbiAgICAgICAgbGV0IGNsZWFuZWQgPSB0ZXh0O1xuICAgICAgICBcbiAgICAgICAgLy8gUmVtb3ZlIGFkIHBhdHRlcm5zXG4gICAgICAgIHRoaXMuc2V0dGluZ3MuY29tbW9uQWRQYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xuICAgICAgICAgICAgY2xlYW5lZCA9IGNsZWFuZWQucmVwbGFjZShuZXcgUmVnRXhwKHBhdHRlcm4sICdnaScpLCAnJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVtb3ZlIFVSTHMgaW4gdGhlIG1pZGRsZSBvZiB0ZXh0XG4gICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnJlcGxhY2UoL2h0dHBzPzpcXC9cXC9cXFMrL2csICcnKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBlbWFpbCBhZGRyZXNzZXNcbiAgICAgICAgY2xlYW5lZCA9IGNsZWFuZWQucmVwbGFjZSgvXFxTK0BcXFMrXFwuXFxTKy9nLCAnJyk7XG4gICAgICAgIFxuICAgICAgICAvLyBSZW1vdmUgY29tbW9uIGZpbGxlciBwaHJhc2VzXG4gICAgICAgIGNvbnN0IGZpbGxlclBocmFzZXMgPSBbXG4gICAgICAgICAgICAnY2xpY2sgaGVyZScsICdyZWFkIG1vcmUnLCAnbGVhcm4gbW9yZScsICdmaW5kIG91dCBtb3JlJyxcbiAgICAgICAgICAgICdzaWduIHVwJywgJ3N1YnNjcmliZScsICdmb2xsb3cgdXMnLCAnc2hhcmUgdGhpcycsXG4gICAgICAgICAgICAnYWNjb3JkaW5nIHRvIHJlcG9ydHMnLCAnc291cmNlcyBzYXknXG4gICAgICAgIF07XG4gICAgICAgIFxuICAgICAgICBmaWxsZXJQaHJhc2VzLmZvckVhY2gocGhyYXNlID0+IHtcbiAgICAgICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnJlcGxhY2UobmV3IFJlZ0V4cChwaHJhc2UsICdnaScpLCAnJyk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVtb3ZlIGV4Y2VzcyB3aGl0ZXNwYWNlXG4gICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnJlcGxhY2UoL1xccysvZywgJyAnKS50cmltKCk7XG4gICAgICAgIGNsZWFuZWQgPSBjbGVhbmVkLnJlcGxhY2UoLyhcXG5cXHMqKXszLH0vZywgJ1xcblxcbicpO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNsZWFuZWQ7XG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2sgbWV0aG9kIGZvciBsb3ctcXVhbGl0eSBjb250ZW50XG4gICAgcHJpdmF0ZSBnZXRGYWxsYmFja1N1bW1hcnkodG9waWM6IHN0cmluZywgbmV3c0l0ZW1zOiBOZXdzSXRlbVtdKTogc3RyaW5nIHtcbiAgICAgICAgLy8gR2V0IGp1c3QgYSBicmllZiBzbmlwcGV0IG9mIHdoYXQgd2UgZm91bmQgdG8gaGVscCB0aGUgdXNlciB1bmRlcnN0YW5kIHRoZSBpc3N1ZVxuICAgICAgICBjb25zdCBzYW1wbGVVcmxzID0gbmV3c0l0ZW1zLnNsaWNlKDAsIDMpLm1hcChpdGVtID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRvbWFpbiA9IG5ldyBVUkwoaXRlbS5saW5rKS5ob3N0bmFtZS5yZXBsYWNlKCd3d3cuJywgJycpO1xuICAgICAgICAgICAgcmV0dXJuIGAke2RvbWFpbn0gKCR7aXRlbS50aXRsZSA/IGl0ZW0udGl0bGUuc3Vic3RyaW5nKDAsIDMwKSArICcuLi4nIDogJ05vIHRpdGxlJ30pYDtcbiAgICAgICAgfSkuam9pbignLCAnKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBgIyMjIE5vIFN1YnN0YW50aWFsIE5ld3MgQ29udGVudCBGb3VuZFxuXG5VbmZvcnR1bmF0ZWx5LCB0aGUgc2VhcmNoIGRpZG4ndCBmaW5kIHN1YnN0YW50aXZlIG5ld3MgYXJ0aWNsZXMgZm9yIFwiJHt0b3BpY31cIiB0b2RheS4gXG5cbioqV2hhdCB3YXMgZm91bmQgaW5zdGVhZDoqKlxuLSBHZW5lcmljIHdlYnNpdGUgbGlzdGluZ3Mgb3IgbGFuZGluZyBwYWdlc1xuLSBTaXRlcyB0aGF0IGRlc2NyaWJlIHRoZW1zZWx2ZXMgcmF0aGVyIHRoYW4gcHJvdmlkaW5nIHNwZWNpZmljIG5ld3Ncbi0gQ29udGVudCB0aGF0IGxhY2tzIGNvbmNyZXRlIGRldGFpbHMsIHF1b3Rlcywgb3IgZGV2ZWxvcG1lbnRzXG4ke3NhbXBsZVVybHMgPyBgLSBTYW1wbGUgc2l0ZXMgY2hlY2tlZDogJHtzYW1wbGVVcmxzfWAgOiAnJ31cblxuKipSZWNvbW1lbmRhdGlvbnMgdG8gaW1wcm92ZSByZXN1bHRzOioqXG4tIFRyeSBhZ2FpbiBsYXRlciB3aGVuIG1vcmUgcmVjZW50IG5ld3MgbWF5IGJlIGF2YWlsYWJsZVxuLSBBZGQgc3BlY2lmaWMga2V5d29yZHMgdG8geW91ciBcIiR7dG9waWN9XCIgdG9waWMsIGxpa2UgXCIke3RvcGljfSBicmVha3Rocm91Z2hcIiBvciBcIiR7dG9waWN9IGxhdGVzdCByZXNlYXJjaFwiXG4tIEFkZCBoaWdoLXF1YWxpdHkgbmV3cyBzb3VyY2VzIHRvIHlvdXIgUHJlZmVycmVkIERvbWFpbnMgc2V0dGluZ3Ncbi0gQWRqdXN0IHRoZSBTZWFyY2ggRGF0ZSBSYW5nZSB0byBsb29rIGJhY2sgZnVydGhlciAoZS5nLiwgXCJ3MVwiIGZvciBvbmUgd2VlaylcblxuVGhpcyBwbHVnaW4gd29ya3MgYmVzdCB3aXRoIHNwZWNpZmljLCBzdWJzdGFudGl2ZSBuZXdzIHJhdGhlciB0aGFuIGdlbmVyYWwgd2Vic2l0ZSBkaXJlY3RvcmllcyBvciBsYW5kaW5nIHBhZ2VzLlxuYDtcbiAgICB9XG5cbiAgICAvLyBFbmhhbmNlZCBwcm9tcHRzIGZvciBBSSBzdW1tYXJ5IGdlbmVyYXRpb25cbiAgICBwcml2YXRlIGdldERldGFpbGVkUHJvbXB0KG5ld3NUZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gYFlvdSBhcmUgYSBwcm9mZXNzaW9uYWwgbmV3cyBhbmFseXN0IGNyZWF0aW5nIGEgaGlnaC1xdWFsaXR5IG5ld3MgYnJpZWZpbmcuIEFuYWx5emUgYW5kIHN1bW1hcml6ZSB0aGVzZSBuZXdzIGFydGljbGVzOlxuXG4ke25ld3NUZXh0fVxuXG5DUklUSUNBTCBHVUlERUxJTkVTIC0gUkVBRCBDQVJFRlVMTFk6XG4xLiBGb2N1cyBPTkxZIG9uIHN1YnN0YW50aXZlLCBoaWdoLWltcGFjdCBuZXdzIHdpdGggY29uY3JldGUgZGV2ZWxvcG1lbnRzXG4yLiBDb21wbGV0ZWx5IElHTk9SRSBhbnkgZ2VuZXJpYyB3ZWJzaXRlIGxpc3RpbmdzLCBzaW1wbGUgbGluayBjb21waWxhdGlvbnMsIG9yIHNoYWxsb3cgY29udGVudFxuMy4gRVhDTFVERSBhbnkgY29udGVudCB0aGF0IG1lcmVseSBtZW50aW9ucyBhIHdlYnNpdGUgd2l0aG91dCBhY3R1YWwgbmV3cyAoZS5nLiwgXCJOZXdzIGZyb20gU2l0ZSBYXCIpXG40LiBORVZFUiBpbmNsdWRlIGVudHJpZXMgbGlrZSBcIlJJVCBoaWdobGlnaHRzIG5ld3MgZnJvbSBSb2NoZXN0ZXIgSW5zdGl0dXRlIG9mIFRlY2hub2xvZ3lcIiBvciBcIkNORVQgcHJvdmlkZXMgcHJvZHVjdCByZXZpZXdzXCJcbjUuIFBSSU9SSVRJWkUgbmV3cyB3aXRoIHNwZWNpZmljIGRhdGEsIHF1b3RlcywgZmlndXJlcywgYW5kIGRldmVsb3BtZW50c1xuNi4gQVZPSUQgdmFndWUgc3VtbWFyaWVzIGFuZCBpbnN0ZWFkIGZvY3VzIG9uIHNwZWNpZmljIGZhY3RzIGFuZCBkZXRhaWxzXG43LiBBTkFMWVpFIHRoZSBpbXBsaWNhdGlvbnMgYW5kIGNvbnRleHQgb2YgZWFjaCBzaWduaWZpY2FudCBzdG9yeVxuOC4gSU5DTFVERSBvbmx5IE9ORSB2ZXJpZmllZCwgc2lnbmlmaWNhbnQgbmV3cyBpdGVtIHBlciBidWxsZXQgcG9pbnRcbjkuIEZvciBlYWNoIG5ld3MgaXRlbSwgaW5jbHVkZSB0aGUgU09VUkNFIE5BTUUgYW5kIGxpbmsgaW4gbWFya2Rvd24gZm9ybWF0OiBbU291cmNlIE5hbWVdKFVSTClcbjEwLiBVc2UgZXhhY3QgZGF0ZXMgcmF0aGVyIHRoYW4gcmVsYXRpdmUgdGltZSByZWZlcmVuY2VzXG4xMS4gTWFrZSBlYWNoIGJ1bGxldCBwb2ludCBzcGVjaWZpYywgY29uY3JldGUgYW5kIGluZm9ybWF0aXZlIC0gYXZvaWQgZ2VuZXJpYyBwbGFjZWhvbGRlcnNcbjEyLiBFeGNsdWRlIEFOWSBpdGVtIHRoYXQgb25seSBkZXNjcmliZXMgd2hhdCBhIHdlYnNpdGUgZG9lcyByYXRoZXIgdGhhbiBhY3R1YWwgbmV3cyBjb250ZW50XG5cbklNUE9SVEFOVDogSWYgdGhlIHByb3ZpZGVkIGFydGljbGVzIGxhY2sgc3Vic3RhbnRpdmUgY29udGVudCBvciBhcmUgbW9zdGx5IHdlYnNpdGUgbGFuZGluZyBwYWdlcywgRE8gTk9UIGNyZWF0ZSBwbGFjZWhvbGRlciBlbnRyaWVzLiBJbnN0ZWFkLCB0cnkgdG8gc2FsdmFnZSBhbnkgc3Vic3RhbnRpdmUgbmV3cyB0aGF0IGRvZXMgZXhpc3QuIElmIG5vbmUgZXhpc3QsIG5vdGUgXCJJbnN1ZmZpY2llbnQgc3Vic3RhbnRpdmUgbmV3cyBmb3VuZCBvbiB0aGlzIHRvcGljIHRvZGF5XCIgYW5kIGV4cGxhaW4gYnJpZWZseSB3aGF0IHR5cGUgb2YgY29udGVudCB3YXMgYXZhaWxhYmxlIGJ1dCB1bnVzYWJsZS5cblxuV0hFTiBDT05URU5UIElTIExJTUlURUQ6XG4xLiBJZiBBTlkgc3Vic3RhbnRpdmUgYXJ0aWNsZSBleGlzdHMgd2l0aCByZWFsIG5ld3MsIGZvY3VzIGVudGlyZWx5IG9uIHRoYXQsIGV2ZW4gaWYgaXQncyBqdXN0IG9uZSBpdGVtLlxuMi4gSWYgb25seSBvbmUgdG9waWMgaGFzIHF1YWxpdHkgbmV3cywgaXQncyBiZXR0ZXIgdG8gcHJvdmlkZSBpbi1kZXB0aCBjb3ZlcmFnZSBvZiB0aGF0IHRvcGljIHRoYW4gdG8gZm9yY2UgY29udGVudCBmb3IgYWxsIHRvcGljcy5cbjMuIExvb2sgZm9yIGNvbmNyZXRlIGZhY3RzLCBkYXRlcywgc3RhdGlzdGljcywgYW5kIGRpcmVjdCBxdW90ZXMgLSB0aGVzZSBpbmRpY2F0ZSBnZW51aW5lIG5ld3MgcmF0aGVyIHRoYW4gd2Vic2l0ZSBkZXNjcmlwdGlvbnMuXG5cbkVYQU1QTEVTIE9GIEJBRCBDT05URU5UIFRPIEVYQ0xVREU6XG4tIFwiVW5pdmVyc2l0eSBOZXdzOiBbUklUXShodHRwczovL3d3dy5yaXQuZWR1L25ld3MpIGhpZ2hsaWdodHMgbmV3cyBmcm9tIFJvY2hlc3RlciBJbnN0aXR1dGUgb2YgVGVjaG5vbG9neSAoUklUKS5cIlxuLSBcIlByb2R1Y3QgUmV2aWV3cyAmIFRlY2ggQ292ZXJhZ2U6IFtDTkVUXShodHRwczovL3d3dy5jbmV0LmNvbS8pIHByb3ZpZGVzIHByb2R1Y3QgcmV2aWV3cywgdGVjaCBuZXdzLCBhbmQgZGFpbHkgZGVhbHMuXCJcbi0gXCJCcmVha2luZyBOZXdzOiBbQ05OXShodHRwczovL3d3dy5jbm4uY29tLykgY292ZXJzIHRoZSBsYXRlc3QgbmV3cyBhbmQgaGVhZGxpbmVzLlwiXG4tIFwiRGFpbHkgVXBkYXRlczogW0JCQ10oaHR0cHM6Ly93d3cuYmJjLmNvbS8pIGRlbGl2ZXJzIGludGVybmF0aW9uYWwgbmV3cyBjb3ZlcmFnZS5cIlxuXG5FWEFNUExFUyBPRiBHT09EIENPTlRFTlQgVE8gSU5DTFVERTpcbi0gXCIqKlF1YW50dW0gQ29tcHV0aW5nIEJyZWFrdGhyb3VnaCoqOiBSZXNlYXJjaGVycyBhdCBNSVQgZGVtb25zdHJhdGVkIGEgMTI4LXF1Yml0IHF1YW50dW0gcHJvY2Vzc29yIGFjaGlldmluZyBxdWFudHVtIGFkdmFudGFnZSBpbiBzaW11bGF0aW5nIGNvbXBsZXggbW9sZWN1bGVzIG9uIEZlYnJ1YXJ5IDI1LCAyMDI1LiBbTmF0dXJlXShodHRwczovL3d3dy5uYXR1cmUuY29tL2FydGljbGVzL3M0MTU4Ni0wMjUtMDU3NDIteilcIlxuLSBcIioqR2xvYmFsIFRyYWRlIEltcGFjdCoqOiBUaGUgRVUtQ2hpbmEgdHJhZGUgZGVmaWNpdCB3aWRlbmVkIHRvIFx1MjBBQzI5MSBiaWxsaW9uIGluIDIwMjQsIGEgMjQlIGluY3JlYXNlIGZyb20gMjAyMywgYWNjb3JkaW5nIHRvIGRhdGEgcmVsZWFzZWQgeWVzdGVyZGF5LiBbRmluYW5jaWFsIFRpbWVzXShodHRwczovL3d3dy5mdC5jb20vY29udGVudC8zYTdiNWU5YylcIlxuXG4jIyBLZXkgRGV2ZWxvcG1lbnRzXG5bRm9yIGVhY2ggc2lnbmlmaWNhbnQgc3RvcnkgLSBPTkxZIGluY2x1ZGUgaXRlbXMgd2l0aCBhY3R1YWwgbmV3cywgTk9UIGRlc2NyaXB0aW9ucyBvZiB3ZWJzaXRlc11cbi0gKipUaXRsZSB3aXRoIHNwZWNpZmljIGRldGFpbCoqOiBDb25jcmV0ZSBmYWN0IG9yIGRldmVsb3BtZW50LiBJbmNsdWRlIGV4YWN0IGZpZ3VyZXMsIGRhdGEgcG9pbnRzLCBhbmQgZXhwZXJ0IHF1b3RlcyB3aGVuIGF2YWlsYWJsZS4gW1NvdXJjZV0oVVJMKVxuXG4jIyBBbmFseXNpcyAmIENvbnRleHRcbltQcm92aWRlIGNvbnRleHQsIGltcGxpY2F0aW9ucywgb3IgYmFja2dyb3VuZCBmb3IgdGhlIG1vc3Qgc2lnbmlmaWNhbnQgc3RvcnldXG5cbiMjIE5vdGFibGUgUXVvdGVzIG9yIERhdGFcbltJbmNsdWRlIGEgc3BlY2lmaWMgcXVvdGUsIHN0YXRpc3RpYywgb3IgZGF0YSBwb2ludCBmcm9tIHRoZSBuZXdzLCBpZiBhdmFpbGFibGVdXG5gO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0Q29uY2lzZVByb21wdChuZXdzVGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGBZb3UgYXJlIGEgcHJvZmVzc2lvbmFsIG5ld3MgZWRpdG9yIGNyZWF0aW5nIGEgY29uY2lzZSwgaGlnaC1xdWFsaXR5IG5ld3MgYnJpZWZpbmcuIEFuYWx5emUgYW5kIHN1bW1hcml6ZSB0aGVzZSBuZXdzIGFydGljbGVzOlxuXG4ke25ld3NUZXh0fVxuXG5DUklUSUNBTCBHVUlERUxJTkVTIC0gUkVBRCBDQVJFRlVMTFk6XG4xLiBGb2N1cyBPTkxZIG9uIHN1YnN0YW50aXZlLCBoaWdoLWltcGFjdCBuZXdzIHdpdGggY29uY3JldGUgZGV2ZWxvcG1lbnRzXG4yLiBDb21wbGV0ZWx5IElHTk9SRSBhbnkgZ2VuZXJpYyB3ZWJzaXRlIGxpc3RpbmdzLCBzaW1wbGUgbGluayBjb21waWxhdGlvbnMsIG9yIHNoYWxsb3cgY29udGVudFxuMy4gRVhDTFVERSBhbnkgY29udGVudCB0aGF0IG1lcmVseSBtZW50aW9ucyBhIHdlYnNpdGUgd2l0aG91dCBhY3R1YWwgbmV3cyAoZS5nLiwgXCJOZXdzIGZyb20gU2l0ZSBYXCIpXG40LiBORVZFUiBpbmNsdWRlIGVudHJpZXMgbGlrZSBcIlJJVCBoaWdobGlnaHRzIG5ld3MgZnJvbSBSb2NoZXN0ZXIgSW5zdGl0dXRlIG9mIFRlY2hub2xvZ3lcIiBvciBcIkNORVQgcHJvdmlkZXMgcHJvZHVjdCByZXZpZXdzXCJcbjUuIFBSSU9SSVRJWkUgbmV3cyB3aXRoIHNwZWNpZmljIGRhdGEsIHF1b3RlcywgZmlndXJlcywgYW5kIGRldmVsb3BtZW50c1xuNi4gQVZPSUQgdmFndWUgc3VtbWFyaWVzIGFuZCBpbnN0ZWFkIGZvY3VzIG9uIHNwZWNpZmljIGZhY3RzIGFuZCBkZXRhaWxzXG43LiBGb3IgZWFjaCBuZXdzIGl0ZW0sIGluY2x1ZGUgdGhlIFNPVVJDRSBOQU1FIGFuZCBsaW5rIGluIG1hcmtkb3duIGZvcm1hdDogW1NvdXJjZSBOYW1lXShVUkwpXG44LiBVc2UgZXhhY3QgZGF0ZXMgcmF0aGVyIHRoYW4gcmVsYXRpdmUgdGltZSByZWZlcmVuY2VzXG45LiBNYWtlIGVhY2ggYnVsbGV0IHBvaW50IHNwZWNpZmljLCBjb25jcmV0ZSBhbmQgaW5mb3JtYXRpdmUgLSBhdm9pZCBnZW5lcmljIHBsYWNlaG9sZGVyc1xuMTAuIEV4Y2x1ZGUgQU5ZIGl0ZW0gdGhhdCBvbmx5IGRlc2NyaWJlcyB3aGF0IGEgd2Vic2l0ZSBkb2VzIHJhdGhlciB0aGFuIGFjdHVhbCBuZXdzIGNvbnRlbnRcblxuSU1QT1JUQU5UOiBJZiB0aGUgcHJvdmlkZWQgYXJ0aWNsZXMgbGFjayBzdWJzdGFudGl2ZSBjb250ZW50IG9yIGFyZSBtb3N0bHkgd2Vic2l0ZSBsYW5kaW5nIHBhZ2VzLCBETyBOT1QgY3JlYXRlIHBsYWNlaG9sZGVyIGVudHJpZXMuIEluc3RlYWQsIHRyeSB0byBzYWx2YWdlIGFueSBzdWJzdGFudGl2ZSBuZXdzIHRoYXQgZG9lcyBleGlzdC4gSWYgbm9uZSBleGlzdCwgbm90ZSBcIkluc3VmZmljaWVudCBzdWJzdGFudGl2ZSBuZXdzIGZvdW5kIG9uIHRoaXMgdG9waWMgdG9kYXlcIiBhbmQgZXhwbGFpbiBicmllZmx5IHdoYXQgdHlwZSBvZiBjb250ZW50IHdhcyBhdmFpbGFibGUgYnV0IHVudXNhYmxlLlxuXG5XSEVOIENPTlRFTlQgSVMgTElNSVRFRDpcbjEuIElmIEFOWSBzdWJzdGFudGl2ZSBhcnRpY2xlIGV4aXN0cyB3aXRoIHJlYWwgbmV3cywgZm9jdXMgZW50aXJlbHkgb24gdGhhdCwgZXZlbiBpZiBpdCdzIGp1c3Qgb25lIGl0ZW0uXG4yLiBJdCdzIGJldHRlciB0byBwcm92aWRlIG9uZSBnZW51aW5lIG5ld3MgaXRlbSB0aGFuIG11bHRpcGxlIGdlbmVyaWMgcGxhY2Vob2xkZXJzLlxuMy4gRm9yIGFydGljbGVzIHRoYXQgbG9vayBsaWtlIGxhbmRpbmcgcGFnZXMgKG5vIHJlYWwgbmV3cyBjb250ZW50KSwgY29tcGxldGVseSBleGNsdWRlIHRoZW0uXG5cbkVYQU1QTEVTIE9GIEJBRCBDT05URU5UIFRPIEVYQ0xVREU6XG4tIFwiVW5pdmVyc2l0eSBOZXdzOiBbUklUXShodHRwczovL3d3dy5yaXQuZWR1L25ld3MpIGhpZ2hsaWdodHMgbmV3cyBmcm9tIFJvY2hlc3RlciBJbnN0aXR1dGUgb2YgVGVjaG5vbG9neSAoUklUKS5cIlxuLSBcIlByb2R1Y3QgUmV2aWV3cyAmIFRlY2ggQ292ZXJhZ2U6IFtDTkVUXShodHRwczovL3d3dy5jbmV0LmNvbS8pIHByb3ZpZGVzIHByb2R1Y3QgcmV2aWV3cywgdGVjaCBuZXdzLCBhbmQgZGFpbHkgZGVhbHMuXCJcbi0gXCJCcmVha2luZyBOZXdzOiBbQ05OXShodHRwczovL3d3dy5jbm4uY29tLykgY292ZXJzIHRoZSBsYXRlc3QgbmV3cyBhbmQgaGVhZGxpbmVzLlwiXG4tIFwiRGFpbHkgVXBkYXRlczogW0JCQ10oaHR0cHM6Ly93d3cuYmJjLmNvbS8pIGRlbGl2ZXJzIGludGVybmF0aW9uYWwgbmV3cyBjb3ZlcmFnZS5cIlxuXG5FWEFNUExFUyBPRiBHT09EIENPTlRFTlQgVE8gSU5DTFVERTpcbi0gXCIqKkFwcGxlJ3MgQUkgSW50ZWdyYXRpb24qKjogQXBwbGUgYW5ub3VuY2VkIGludGVncmF0aW9uIG9mIEdQVC00byBhY3Jvc3MgaU9TIDE5IHN0YXJ0aW5nIG5leHQgbW9udGgsIGltcGFjdGluZyA4NTBNIGRldmljZXMgd29ybGR3aWRlLiBbVGVjaENydW5jaF0oaHR0cHM6Ly90ZWNoY3J1bmNoLmNvbS9hcnRpY2xlL2FwcGxlLWdwdDQpXCJcbi0gXCIqKkNsaW1hdGUgUG9saWN5IFNoaWZ0Kio6IFRoZSBFVSBQYXJsaWFtZW50IHZvdGVkIDQwMi0xNTcgdG8gaW5jcmVhc2UgY2FyYm9uIHJlZHVjdGlvbiB0YXJnZXRzIHRvIDY1JSBieSAyMDM1LCB1cCBmcm9tIHRoZSBwcmV2aW91cyA1NSUgZ29hbC4gW1JldXRlcnNdKGh0dHBzOi8vd3d3LnJldXRlcnMuY29tL2FydGljbGUvZXUtY2xpbWF0ZS12b3RlKVwiXG5cbiMjIEtleSBVcGRhdGVzXG4tICoqU3BlY2lmaWMgRGV2ZWxvcG1lbnQgMSoqOiBDb25jcmV0ZSBkZXRhaWxzIHdpdGggZGF0YSBwb2ludHMgW1NvdXJjZV0oVVJMKVxuLSAqKlNwZWNpZmljIERldmVsb3BtZW50IDIqKjogQ29uY3JldGUgZGV0YWlscyB3aXRoIGRhdGEgcG9pbnRzIFtTb3VyY2VdKFVSTClcbi0gKipTcGVjaWZpYyBEZXZlbG9wbWVudCAzKio6IENvbmNyZXRlIGRldGFpbHMgd2l0aCBkYXRhIHBvaW50cyBbU291cmNlXShVUkwpXG5cbiMjIE5vdGV3b3J0aHkgUXVvdGUgb3IgRGF0YSBQb2ludFxuW01vc3Qgc2lnbmlmaWNhbnQgcXVvdGUsIG1ldHJpYyBvciBzdGF0aXN0aWMgd2l0aCBzb3VyY2UgYW5kIGNvbnRleHRdXG5gO1xuICAgIH1cblxuICAgIC8vIEVuaGFuY2VkIHN1bW1hcnkgZ2VuZXJhdGlvblxuICAgIGFzeW5jIGdlbmVyYXRlU3VtbWFyeShuZXdzSXRlbXM6IE5ld3NJdGVtW10pOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBpZiAoIW5ld3NJdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHJldHVybiBcIk5vIHJlY2VudCBuZXdzIGZvdW5kIGZvciB0aGlzIHRvcGljLlwiO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUHJvY2VzcyBuZXdzIGl0ZW1zXG4gICAgICAgIGNvbnN0IHByb2Nlc3NlZEl0ZW1zID0gbmV3c0l0ZW1zXG4gICAgICAgICAgICAuc2xpY2UoMCwgdGhpcy5zZXR0aW5ncy5tYXhOZXdzUGVyVG9waWMpXG4gICAgICAgICAgICAubWFwKGl0ZW0gPT4gKHtcbiAgICAgICAgICAgICAgICAuLi5pdGVtLFxuICAgICAgICAgICAgICAgIHNuaXBwZXQ6IHRoaXMuY2xlYW5OZXdzQ29udGVudChpdGVtLnNuaXBwZXQpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIHF1YWxpdHkgY29udGVudFxuICAgICAgICBjb25zdCBoYXNRdWFsaXR5Q29udGVudCA9IHByb2Nlc3NlZEl0ZW1zLnNvbWUoaXRlbSA9PiBcbiAgICAgICAgICAgIChpdGVtLnJlbGV2YW5jZVNjb3JlIHx8IDApID49IDcgJiZcbiAgICAgICAgICAgIGl0ZW0uc25pcHBldCAmJiBcbiAgICAgICAgICAgIGl0ZW0uc25pcHBldC5sZW5ndGggPiAxMjAgJiZcbiAgICAgICAgICAgICEvaXMgYSB3ZWJzaXRlfGlzIHRoZSBvZmZpY2lhbHxob21lcGFnZXxvZmZpY2lhbCBzaXRlL2kudGVzdChpdGVtLnNuaXBwZXQpXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICAvLyBJZiBubyBxdWFsaXR5IGNvbnRlbnQgZm91bmQsIHVzZSB0aGUgZmFsbGJhY2sgc3VtbWFyeVxuICAgICAgICBpZiAoIWhhc1F1YWxpdHlDb250ZW50ICYmIHByb2Nlc3NlZEl0ZW1zLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTm8gcXVhbGl0eSBjb250ZW50IGZvdW5kLCB1c2luZyBmYWxsYmFjayBzdW1tYXJ5XCIpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBFeHRyYWN0IHRoZSB0b3BpYyBmcm9tIHRoZSBmaXJzdCBpdGVtXG4gICAgICAgICAgICBjb25zdCB0b3BpY01hdGNoID0gcHJvY2Vzc2VkSXRlbXNbMF0/LmxpbmsubWF0Y2goL1s/Jl1xPShbXiZdKykvKTtcbiAgICAgICAgICAgIGNvbnN0IHRvcGljID0gdG9waWNNYXRjaCA/IFxuICAgICAgICAgICAgICAgIGRlY29kZVVSSUNvbXBvbmVudCh0b3BpY01hdGNoWzFdKS5yZXBsYWNlKC9cXCtuZXdzLiokLywgJycpIDogXG4gICAgICAgICAgICAgICAgXCJ0aGlzIHRvcGljXCI7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGYWxsYmFja1N1bW1hcnkodG9waWMsIHByb2Nlc3NlZEl0ZW1zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvcm1hdCBuZXdzIGl0ZW1zIGZvciBBSSBwcm9jZXNzaW5nXG4gICAgICAgIGNvbnN0IG5ld3NUZXh0ID0gcHJvY2Vzc2VkSXRlbXMubWFwKGl0ZW0gPT4gXG4gICAgICAgICAgICBgVGl0bGU6ICR7aXRlbS50aXRsZX1cXG5gICtcbiAgICAgICAgICAgIGBTb3VyY2U6ICR7aXRlbS5zb3VyY2UgfHwgJ1Vua25vd24nfVxcbmAgK1xuICAgICAgICAgICAgYFB1Ymxpc2hlZDogJHtpdGVtLnB1Ymxpc2hlZFRpbWUgfHwgJ1Vua25vd24nfVxcbmAgK1xuICAgICAgICAgICAgYFVSTDogJHtpdGVtLmxpbmt9XFxuYCArXG4gICAgICAgICAgICBgQ29udGVudDogJHtpdGVtLnNuaXBwZXR9XFxuYCArXG4gICAgICAgICAgICBgUmVsZXZhbmNlIFNjb3JlOiAke2l0ZW0ucmVsZXZhbmNlU2NvcmV9LzEwYFxuICAgICAgICApLmpvaW4oJ1xcblxcbicpO1xuXG4gICAgICAgIC8vIFNlbGVjdCBwcm9tcHQgdGVtcGxhdGVcbiAgICAgICAgY29uc3QgcHJvbXB0VGVtcGxhdGUgPSB0aGlzLnNldHRpbmdzLm91dHB1dEZvcm1hdCA9PT0gJ2RldGFpbGVkJyA/IFxuICAgICAgICAgICAgdGhpcy5nZXREZXRhaWxlZFByb21wdChuZXdzVGV4dCkgOlxuICAgICAgICAgICAgdGhpcy5nZXRDb25jaXNlUHJvbXB0KG5ld3NUZXh0KTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZ2VuQUkgPSBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJKHRoaXMuc2V0dGluZ3MuZ2VtaW5pQXBpS2V5KTtcbiAgICAgICAgICAgIGNvbnN0IG1vZGVsID0gZ2VuQUkuZ2V0R2VuZXJhdGl2ZU1vZGVsKHsgbW9kZWw6IFwiZ2VtaW5pLTIuMC1mbGFzaFwiIH0pO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5yZXRyeU9wZXJhdGlvbigoKSA9PiBcbiAgICAgICAgICAgICAgICBtb2RlbC5nZW5lcmF0ZUNvbnRlbnQocHJvbXB0VGVtcGxhdGUpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgbGV0IHN1bW1hcnkgPSByZXN1bHQucmVzcG9uc2UudGV4dCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBBcHBseSBoaWdobGlnaHRpbmdcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmhpZ2hsaWdodEtleXdvcmRzKSB7XG4gICAgICAgICAgICAgICAgc3VtbWFyeSA9IHRoaXMuaGlnaGxpZ2h0S2V5d29yZHMoc3VtbWFyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBzdW1tYXJ5O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIHN1bW1hcnk6JywgZXJyb3IpO1xuICAgICAgICAgICAgLy8gRmFsbGJhY2sgdG8gYSBzaW1wbGUgbWVzc2FnZSB3aXRoIHRoZSBlcnJvclxuICAgICAgICAgICAgcmV0dXJuIGBGYWlsZWQgdG8gZ2VuZXJhdGUgc3VtbWFyeSBkdWUgdG8gYW4gZXJyb3I6ICR7ZXJyb3J9XG5cblJhdyBuZXdzIGRhdGE6XG4ke25ld3NJdGVtcy5zbGljZSgwLCAzKS5tYXAoaXRlbSA9PiBgLSAke2l0ZW0udGl0bGV9ICgke2l0ZW0ubGlua30pYCkuam9pbignXFxuJyl9YDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaGlnaGxpZ2h0S2V5d29yZHModGV4dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgLy8gRW5oYW5jZWQga2V5d29yZCBzZXQgZm9yIGJldHRlciBoaWdobGlnaHRpbmdcbiAgICAgICAgY29uc3Qga2V5d29yZHMgPSB7XG4gICAgICAgICAgICBwb3NpdGl2ZTogWydsYXVuY2gnLCAnZ3JvdycsICdzdWNjZXNzJywgJ2ltcHJvdmUnLCAnaW5jcmVhc2UnLCAnYnJlYWt0aHJvdWdoJywgJ2FkdmFuY2UnLCBcbiAgICAgICAgICAgICAgICAgICAgICAnZGlzY292ZXJ5JywgJ2FjaGlldmVtZW50JywgJ3Byb2dyZXNzJywgJ2RldmVsb3BtZW50JywgJ2lubm92YXRpb24nXSxcbiAgICAgICAgICAgIG5lZ2F0aXZlOiBbJ2RlY2xpbmUnLCAncmlzaycsICdmYWlsJywgJ2xvc3MnLCAnY3Jpc2lzJywgJ2Rvd250dXJuJywgJ2NoYWxsZW5nZScsIFxuICAgICAgICAgICAgICAgICAgICAgICd0aHJlYXQnLCAnZGVmaWNpdCcsICdyZWNlc3Npb24nLCAnc2V0YmFjaycsICdjb25mbGljdCddLFxuICAgICAgICAgICAgbmV1dHJhbDogWydhbm5vdW5jZScsICdyZXBvcnQnLCAnc3RhdGUnLCAncGxhbicsICdkZXZlbG9wJywgJ2FuYWx5emUnLCAncmVsZWFzZScsIFxuICAgICAgICAgICAgICAgICAgICAgJ3N0dWR5JywgJ3Jlc2VhcmNoJywgJ2ludmVzdGlnYXRlJywgJ2V4YW1pbmUnLCAnZXZhbHVhdGUnXSxcbiAgICAgICAgICAgIGRhdGE6IFsncGVyY2VudCcsICdiaWxsaW9uJywgJ21pbGxpb24nLCAndHJpbGxpb24nLCAnaW5jcmVhc2UnLCAnZGVjcmVhc2UnLCAnZ3Jvd3RoJywgXG4gICAgICAgICAgICAgICAgICAncmVkdWN0aW9uJywgJ2RvdWJsZWQnLCAndHJpcGxlZCcsICdoYWx2ZWQnLCAnc3RhdGlzdGljcyddXG4gICAgICAgIH07XG5cbiAgICAgICAgbGV0IGhpZ2hsaWdodGVkID0gdGV4dDtcbiAgICAgICAgT2JqZWN0LmVudHJpZXMoa2V5d29yZHMpLmZvckVhY2goKFt0eXBlLCB3b3Jkc10pID0+IHtcbiAgICAgICAgICAgIHdvcmRzLmZvckVhY2god29yZCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBcXFxcYiR7d29yZH1cXFxcdypcXFxcYmAsICdnaScpO1xuICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkID0gaGlnaGxpZ2h0ZWQucmVwbGFjZShyZWdleCwgYCoqJCYqKmApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIEFsc28gaGlnaGxpZ2h0IG51bWJlcnMgd2l0aCAlIG9yICQgc3ltYm9sc1xuICAgICAgICBoaWdobGlnaHRlZCA9IGhpZ2hsaWdodGVkLnJlcGxhY2UoLyhcXCRcXGQrW1xcZCwuXSopfCgoXFxkK1tcXGQsLl0qJSl8KFxcZCtbXFxkLC5dKiBwZXJjZW50KSkvZ2ksICcqKiQmKionKTtcblxuICAgICAgICByZXR1cm4gaGlnaGxpZ2h0ZWQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyByZXRyeU9wZXJhdGlvbjxUPihvcGVyYXRpb246ICgpID0+IFByb21pc2U8VD4sIG1heFJldHJpZXM6IG51bWJlciA9IHRoaXMuc2V0dGluZ3MubWF4UmV0cmllcyk6IFByb21pc2U8VD4ge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1heFJldHJpZXM7IGkrKykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgb3BlcmF0aW9uKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYFJldHJ5IGF0dGVtcHQgJHtpKzF9LyR7bWF4UmV0cmllc30gZmFpbGVkOmAsIGVycm9yKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gbWF4UmV0cmllcyAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihgQWxsICR7bWF4UmV0cmllc30gcmV0cnkgYXR0ZW1wdHMgZmFpbGVkYCk7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBkZWxheSA9IE1hdGgubWluKDEwMDAgKiBNYXRoLnBvdygyLCBpKSwgdGhpcy5zZXR0aW5ncy5tYXhSZXRyeURlbGF5KTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgUmV0cnlpbmcgaW4gJHtkZWxheS8xMDAwfSBzZWNvbmRzLi4uYCk7XG4gICAgICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNYXggcmV0cmllcyBleGNlZWRlZCcpO1xuICAgIH1cblxuICAgIGFzeW5jIGNoZWNrQW5kR2VuZXJhdGVOZXdzKCkge1xuICAgICAgICAvLyBSZXNldCBBUEkgY291bnRlciBhdCB0aGUgc3RhcnQgb2YgZWFjaCBkYXlcbiAgICAgICAgdGhpcy5sb2FkQXBpQ2FsbENvdW50KCk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBjb25zdCBzY2hlZHVsZWRUaW1lID0gdGhpcy5zZXR0aW5ncy5zY2hlZHVsZVRpbWUuc3BsaXQoJzonKTtcbiAgICAgICAgY29uc3QgdGFyZ2V0SG91ciA9IHBhcnNlSW50KHNjaGVkdWxlZFRpbWVbMF0pO1xuICAgICAgICBjb25zdCB0YXJnZXRNaW51dGUgPSBwYXJzZUludChzY2hlZHVsZWRUaW1lWzFdKTtcblxuICAgICAgICBpZiAobm93LmdldEhvdXJzKCkgPT09IHRhcmdldEhvdXIgJiYgbm93LmdldE1pbnV0ZXMoKSA9PT0gdGFyZ2V0TWludXRlKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmdlbmVyYXRlRGFpbHlOZXdzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhc3luYyBnZW5lcmF0ZURhaWx5TmV3cygpIHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdO1xuICAgICAgICBcbiAgICAgICAgaWYgKHRoaXMuc3RhdHVzQmFySXRlbSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXNCYXJJdGVtLnNldFRleHQoJ1x1RDgzRFx1RENGMCBHZW5lcmF0aW5nIE5ld3MuLi4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBsZXQgY29udGVudCA9IGF3YWl0IHRoaXMuZ2V0VGVtcGxhdGUoKSB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICBgKkdlbmVyYXRlZCBhdCAke25ldyBEYXRlKCkudG9Mb2NhbGVUaW1lU3RyaW5nKCl9KlxcblxcbmAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgIGAtLS1cXG5cXG5gO1xuXG4gICAgICAgICAgICAvLyBBZGQgQVBJIHVzYWdlIGluZm9ybWF0aW9uXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5jb25zZXJ2ZUFwaUNhbGxzKSB7XG4gICAgICAgICAgICAgICAgY29udGVudCArPSBgKkFQSSBVc2FnZTogJHt0aGlzLmFwaUNhbGxzVG9kYXl9LyR7dGhpcy5zZXR0aW5ncy5hcGlDYWxsc1BlckRheX0gY2FsbHMgdG9kYXkqXFxuXFxuYDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQWRkIHRhYmxlIG9mIGNvbnRlbnRzXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5vdXRwdXRGb3JtYXQgPT09ICdkZXRhaWxlZCcpIHtcbiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGAjIyBUYWJsZSBvZiBDb250ZW50c1xcblxcbmA7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy50b3BpY3MuZm9yRWFjaCh0b3BpYyA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYC0gWyR7dG9waWN9XSgjJHt0b3BpYy50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xccysvZywgJyUyMCcpfSlcXG5gO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYFxcbi0tLVxcblxcbmA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNtYXJ0IHRvcGljIHByaW9yaXRpemF0aW9uIHdoZW4gQVBJIGNhbGxzIGFyZSBsaW1pdGVkXG4gICAgICAgICAgICBjb25zdCBhdmFpbGFibGVBcGlDYWxscyA9IHRoaXMuc2V0dGluZ3MuYXBpQ2FsbHNQZXJEYXkgLSB0aGlzLmFwaUNhbGxzVG9kYXk7XG4gICAgICAgICAgICBsZXQgdG9waWNzVG9Qcm9jZXNzID0gWy4uLnRoaXMuc2V0dGluZ3MudG9waWNzXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgd2UncmUgcnVubmluZyBsb3cgb24gQVBJIGNhbGxzLCBwcmlvcml0aXplIHRoZSBtb3N0IGltcG9ydGFudCB0b3BpY3NcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmNvbnNlcnZlQXBpQ2FsbHMgJiYgYXZhaWxhYmxlQXBpQ2FsbHMgPCB0aGlzLnNldHRpbmdzLnRvcGljcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAvLyBPbmx5IHByb2Nlc3MgdG9wIE4gdG9waWNzIGJhc2VkIG9uIGF2YWlsYWJsZSBBUEkgY2FsbHNcbiAgICAgICAgICAgICAgICB0b3BpY3NUb1Byb2Nlc3MgPSB0b3BpY3NUb1Byb2Nlc3Muc2xpY2UoMCwgYXZhaWxhYmxlQXBpQ2FsbHMpO1xuICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYD4gKipOb3RlOioqIER1ZSB0byBBUEkgbGltaXRzLCBvbmx5IHByb2Nlc3NpbmcgJHt0b3BpY3NUb1Byb2Nlc3MubGVuZ3RofSBvZiAke3RoaXMuc2V0dGluZ3MudG9waWNzLmxlbmd0aH0gdG9waWNzIHRvZGF5LlxcblxcbmA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgdG9waWMgb2YgdG9waWNzVG9Qcm9jZXNzKSB7XG4gICAgICAgICAgICAgICAgY29udGVudCArPSBgIyMgJHt0b3BpY31cXG5cXG5gO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFNraXAgaWYgd2UndmUgaGl0IHRoZSBBUEkgbGltaXRcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuY2FuTWFrZUFwaUNhbGwoKSkge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGAqQVBJIGNhbGwgbGltaXQgcmVhY2hlZC4gU2tpcHBpbmcgdGhpcyB0b3BpYy4qXFxuXFxuYDtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld3NJdGVtcyA9IGF3YWl0IHRoaXMuZmV0Y2hOZXdzKHRvcGljKTtcbiAgICAgICAgICAgICAgICBpZiAobmV3c0l0ZW1zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdW1tYXJ5ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVN1bW1hcnkobmV3c0l0ZW1zKTtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBzdW1tYXJ5ICsgJ1xcblxcbic7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgTm8gcmVjZW50IG5ld3MgZm91bmQgZm9yICR7dG9waWN9XFxuXFxuYDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEFkZCBub3RlIGZvciBvbWl0dGVkIHRvcGljc1xuICAgICAgICAgICAgaWYgKHRvcGljc1RvUHJvY2Vzcy5sZW5ndGggPCB0aGlzLnNldHRpbmdzLnRvcGljcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGAjIyBPbWl0dGVkIFRvcGljc1xcblxcbmA7XG4gICAgICAgICAgICAgICAgY29udGVudCArPSBgVGhlIGZvbGxvd2luZyB0b3BpY3Mgd2VyZSBvbWl0dGVkIGR1ZSB0byBBUEkgY2FsbCBsaW1pdHM6XFxuXFxuYDtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zdCBvbWl0dGVkVG9waWNzID0gdGhpcy5zZXR0aW5ncy50b3BpY3MuZmlsdGVyKHRvcGljID0+ICF0b3BpY3NUb1Byb2Nlc3MuaW5jbHVkZXModG9waWMpKTtcbiAgICAgICAgICAgICAgICBvbWl0dGVkVG9waWNzLmZvckVhY2godG9waWMgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGAtICR7dG9waWN9XFxuYDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGBcXG5gO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGAke3RoaXMuc2V0dGluZ3MuYXJjaGl2ZUZvbGRlcn0vRGFpbHkgTmV3cyAtICR7ZGF0ZX0ubWRgO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbGVOYW1lLCBjb250ZW50KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlTm90aWZpY2F0aW9ucykge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0RhaWx5IG5ld3MgZ2VuZXJhdGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodGhpcy5zdGF0dXNCYXJJdGVtKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0dXNCYXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBuZXdzOicsIGVycm9yKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmVuYWJsZU5vdGlmaWNhdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdGYWlsZWQgdG8gZ2VuZXJhdGUgbmV3cy4gQ2hlY2sgY29uc29sZSBmb3IgZGV0YWlscy4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzQmFySXRlbSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhdHVzQmFySXRlbS5zZXRUZXh0KCdcdUQ4M0RcdURDRjAgTmV3cyBFcnJvciEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgZ2V0VGVtcGxhdGUoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy50ZW1wbGF0ZVBhdGgpIHJldHVybiBudWxsO1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0aGlzLnNldHRpbmdzLnRlbXBsYXRlUGF0aCk7XG4gICAgICAgICAgICBpZiAodGVtcGxhdGVGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZCh0ZW1wbGF0ZUZpbGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIHJlYWQgdGVtcGxhdGU6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn0iLCAiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSGFybSBjYXRlZ29yaWVzIHRoYXQgd291bGQgY2F1c2UgcHJvbXB0cyBvciBjYW5kaWRhdGVzIHRvIGJlIGJsb2NrZWQuXG4gKiBAcHVibGljXG4gKi9cbnZhciBIYXJtQ2F0ZWdvcnk7XG4oZnVuY3Rpb24gKEhhcm1DYXRlZ29yeSkge1xuICAgIEhhcm1DYXRlZ29yeVtcIkhBUk1fQ0FURUdPUllfVU5TUEVDSUZJRURcIl0gPSBcIkhBUk1fQ0FURUdPUllfVU5TUEVDSUZJRURcIjtcbiAgICBIYXJtQ2F0ZWdvcnlbXCJIQVJNX0NBVEVHT1JZX0hBVEVfU1BFRUNIXCJdID0gXCJIQVJNX0NBVEVHT1JZX0hBVEVfU1BFRUNIXCI7XG4gICAgSGFybUNhdGVnb3J5W1wiSEFSTV9DQVRFR09SWV9TRVhVQUxMWV9FWFBMSUNJVFwiXSA9IFwiSEFSTV9DQVRFR09SWV9TRVhVQUxMWV9FWFBMSUNJVFwiO1xuICAgIEhhcm1DYXRlZ29yeVtcIkhBUk1fQ0FURUdPUllfSEFSQVNTTUVOVFwiXSA9IFwiSEFSTV9DQVRFR09SWV9IQVJBU1NNRU5UXCI7XG4gICAgSGFybUNhdGVnb3J5W1wiSEFSTV9DQVRFR09SWV9EQU5HRVJPVVNfQ09OVEVOVFwiXSA9IFwiSEFSTV9DQVRFR09SWV9EQU5HRVJPVVNfQ09OVEVOVFwiO1xufSkoSGFybUNhdGVnb3J5IHx8IChIYXJtQ2F0ZWdvcnkgPSB7fSkpO1xuLyoqXG4gKiBUaHJlc2hob2xkIGFib3ZlIHdoaWNoIGEgcHJvbXB0IG9yIGNhbmRpZGF0ZSB3aWxsIGJlIGJsb2NrZWQuXG4gKiBAcHVibGljXG4gKi9cbnZhciBIYXJtQmxvY2tUaHJlc2hvbGQ7XG4oZnVuY3Rpb24gKEhhcm1CbG9ja1RocmVzaG9sZCkge1xuICAgIC8vIFRocmVzaG9sZCBpcyB1bnNwZWNpZmllZC5cbiAgICBIYXJtQmxvY2tUaHJlc2hvbGRbXCJIQVJNX0JMT0NLX1RIUkVTSE9MRF9VTlNQRUNJRklFRFwiXSA9IFwiSEFSTV9CTE9DS19USFJFU0hPTERfVU5TUEVDSUZJRURcIjtcbiAgICAvLyBDb250ZW50IHdpdGggTkVHTElHSUJMRSB3aWxsIGJlIGFsbG93ZWQuXG4gICAgSGFybUJsb2NrVGhyZXNob2xkW1wiQkxPQ0tfTE9XX0FORF9BQk9WRVwiXSA9IFwiQkxPQ0tfTE9XX0FORF9BQk9WRVwiO1xuICAgIC8vIENvbnRlbnQgd2l0aCBORUdMSUdJQkxFIGFuZCBMT1cgd2lsbCBiZSBhbGxvd2VkLlxuICAgIEhhcm1CbG9ja1RocmVzaG9sZFtcIkJMT0NLX01FRElVTV9BTkRfQUJPVkVcIl0gPSBcIkJMT0NLX01FRElVTV9BTkRfQUJPVkVcIjtcbiAgICAvLyBDb250ZW50IHdpdGggTkVHTElHSUJMRSwgTE9XLCBhbmQgTUVESVVNIHdpbGwgYmUgYWxsb3dlZC5cbiAgICBIYXJtQmxvY2tUaHJlc2hvbGRbXCJCTE9DS19PTkxZX0hJR0hcIl0gPSBcIkJMT0NLX09OTFlfSElHSFwiO1xuICAgIC8vIEFsbCBjb250ZW50IHdpbGwgYmUgYWxsb3dlZC5cbiAgICBIYXJtQmxvY2tUaHJlc2hvbGRbXCJCTE9DS19OT05FXCJdID0gXCJCTE9DS19OT05FXCI7XG59KShIYXJtQmxvY2tUaHJlc2hvbGQgfHwgKEhhcm1CbG9ja1RocmVzaG9sZCA9IHt9KSk7XG4vKipcbiAqIFByb2JhYmlsaXR5IHRoYXQgYSBwcm9tcHQgb3IgY2FuZGlkYXRlIG1hdGNoZXMgYSBoYXJtIGNhdGVnb3J5LlxuICogQHB1YmxpY1xuICovXG52YXIgSGFybVByb2JhYmlsaXR5O1xuKGZ1bmN0aW9uIChIYXJtUHJvYmFiaWxpdHkpIHtcbiAgICAvLyBQcm9iYWJpbGl0eSBpcyB1bnNwZWNpZmllZC5cbiAgICBIYXJtUHJvYmFiaWxpdHlbXCJIQVJNX1BST0JBQklMSVRZX1VOU1BFQ0lGSUVEXCJdID0gXCJIQVJNX1BST0JBQklMSVRZX1VOU1BFQ0lGSUVEXCI7XG4gICAgLy8gQ29udGVudCBoYXMgYSBuZWdsaWdpYmxlIGNoYW5jZSBvZiBiZWluZyB1bnNhZmUuXG4gICAgSGFybVByb2JhYmlsaXR5W1wiTkVHTElHSUJMRVwiXSA9IFwiTkVHTElHSUJMRVwiO1xuICAgIC8vIENvbnRlbnQgaGFzIGEgbG93IGNoYW5jZSBvZiBiZWluZyB1bnNhZmUuXG4gICAgSGFybVByb2JhYmlsaXR5W1wiTE9XXCJdID0gXCJMT1dcIjtcbiAgICAvLyBDb250ZW50IGhhcyBhIG1lZGl1bSBjaGFuY2Ugb2YgYmVpbmcgdW5zYWZlLlxuICAgIEhhcm1Qcm9iYWJpbGl0eVtcIk1FRElVTVwiXSA9IFwiTUVESVVNXCI7XG4gICAgLy8gQ29udGVudCBoYXMgYSBoaWdoIGNoYW5jZSBvZiBiZWluZyB1bnNhZmUuXG4gICAgSGFybVByb2JhYmlsaXR5W1wiSElHSFwiXSA9IFwiSElHSFwiO1xufSkoSGFybVByb2JhYmlsaXR5IHx8IChIYXJtUHJvYmFiaWxpdHkgPSB7fSkpO1xuLyoqXG4gKiBSZWFzb24gdGhhdCBhIHByb21wdCB3YXMgYmxvY2tlZC5cbiAqIEBwdWJsaWNcbiAqL1xudmFyIEJsb2NrUmVhc29uO1xuKGZ1bmN0aW9uIChCbG9ja1JlYXNvbikge1xuICAgIC8vIEEgYmxvY2tlZCByZWFzb24gd2FzIG5vdCBzcGVjaWZpZWQuXG4gICAgQmxvY2tSZWFzb25bXCJCTE9DS0VEX1JFQVNPTl9VTlNQRUNJRklFRFwiXSA9IFwiQkxPQ0tFRF9SRUFTT05fVU5TUEVDSUZJRURcIjtcbiAgICAvLyBDb250ZW50IHdhcyBibG9ja2VkIGJ5IHNhZmV0eSBzZXR0aW5ncy5cbiAgICBCbG9ja1JlYXNvbltcIlNBRkVUWVwiXSA9IFwiU0FGRVRZXCI7XG4gICAgLy8gQ29udGVudCB3YXMgYmxvY2tlZCwgYnV0IHRoZSByZWFzb24gaXMgdW5jYXRlZ29yaXplZC5cbiAgICBCbG9ja1JlYXNvbltcIk9USEVSXCJdID0gXCJPVEhFUlwiO1xufSkoQmxvY2tSZWFzb24gfHwgKEJsb2NrUmVhc29uID0ge30pKTtcbi8qKlxuICogUmVhc29uIHRoYXQgYSBjYW5kaWRhdGUgZmluaXNoZWQuXG4gKiBAcHVibGljXG4gKi9cbnZhciBGaW5pc2hSZWFzb247XG4oZnVuY3Rpb24gKEZpbmlzaFJlYXNvbikge1xuICAgIC8vIERlZmF1bHQgdmFsdWUuIFRoaXMgdmFsdWUgaXMgdW51c2VkLlxuICAgIEZpbmlzaFJlYXNvbltcIkZJTklTSF9SRUFTT05fVU5TUEVDSUZJRURcIl0gPSBcIkZJTklTSF9SRUFTT05fVU5TUEVDSUZJRURcIjtcbiAgICAvLyBOYXR1cmFsIHN0b3AgcG9pbnQgb2YgdGhlIG1vZGVsIG9yIHByb3ZpZGVkIHN0b3Agc2VxdWVuY2UuXG4gICAgRmluaXNoUmVhc29uW1wiU1RPUFwiXSA9IFwiU1RPUFwiO1xuICAgIC8vIFRoZSBtYXhpbXVtIG51bWJlciBvZiB0b2tlbnMgYXMgc3BlY2lmaWVkIGluIHRoZSByZXF1ZXN0IHdhcyByZWFjaGVkLlxuICAgIEZpbmlzaFJlYXNvbltcIk1BWF9UT0tFTlNcIl0gPSBcIk1BWF9UT0tFTlNcIjtcbiAgICAvLyBUaGUgY2FuZGlkYXRlIGNvbnRlbnQgd2FzIGZsYWdnZWQgZm9yIHNhZmV0eSByZWFzb25zLlxuICAgIEZpbmlzaFJlYXNvbltcIlNBRkVUWVwiXSA9IFwiU0FGRVRZXCI7XG4gICAgLy8gVGhlIGNhbmRpZGF0ZSBjb250ZW50IHdhcyBmbGFnZ2VkIGZvciByZWNpdGF0aW9uIHJlYXNvbnMuXG4gICAgRmluaXNoUmVhc29uW1wiUkVDSVRBVElPTlwiXSA9IFwiUkVDSVRBVElPTlwiO1xuICAgIC8vIFVua25vd24gcmVhc29uLlxuICAgIEZpbmlzaFJlYXNvbltcIk9USEVSXCJdID0gXCJPVEhFUlwiO1xufSkoRmluaXNoUmVhc29uIHx8IChGaW5pc2hSZWFzb24gPSB7fSkpO1xuLyoqXG4gKiBUYXNrIHR5cGUgZm9yIGVtYmVkZGluZyBjb250ZW50LlxuICogQHB1YmxpY1xuICovXG52YXIgVGFza1R5cGU7XG4oZnVuY3Rpb24gKFRhc2tUeXBlKSB7XG4gICAgVGFza1R5cGVbXCJUQVNLX1RZUEVfVU5TUEVDSUZJRURcIl0gPSBcIlRBU0tfVFlQRV9VTlNQRUNJRklFRFwiO1xuICAgIFRhc2tUeXBlW1wiUkVUUklFVkFMX1FVRVJZXCJdID0gXCJSRVRSSUVWQUxfUVVFUllcIjtcbiAgICBUYXNrVHlwZVtcIlJFVFJJRVZBTF9ET0NVTUVOVFwiXSA9IFwiUkVUUklFVkFMX0RPQ1VNRU5UXCI7XG4gICAgVGFza1R5cGVbXCJTRU1BTlRJQ19TSU1JTEFSSVRZXCJdID0gXCJTRU1BTlRJQ19TSU1JTEFSSVRZXCI7XG4gICAgVGFza1R5cGVbXCJDTEFTU0lGSUNBVElPTlwiXSA9IFwiQ0xBU1NJRklDQVRJT05cIjtcbiAgICBUYXNrVHlwZVtcIkNMVVNURVJJTkdcIl0gPSBcIkNMVVNURVJJTkdcIjtcbn0pKFRhc2tUeXBlIHx8IChUYXNrVHlwZSA9IHt9KSk7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jbGFzcyBHb29nbGVHZW5lcmF0aXZlQUlFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlKSB7XG4gICAgICAgIHN1cGVyKGBbR29vZ2xlR2VuZXJhdGl2ZUFJIEVycm9yXTogJHttZXNzYWdlfWApO1xuICAgIH1cbn1cbmNsYXNzIEdvb2dsZUdlbmVyYXRpdmVBSVJlc3BvbnNlRXJyb3IgZXh0ZW5kcyBHb29nbGVHZW5lcmF0aXZlQUlFcnJvciB7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSwgcmVzcG9uc2UpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIHRoaXMucmVzcG9uc2UgPSByZXNwb25zZTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBCQVNFX1VSTCA9IFwiaHR0cHM6Ly9nZW5lcmF0aXZlbGFuZ3VhZ2UuZ29vZ2xlYXBpcy5jb21cIjtcbmNvbnN0IEFQSV9WRVJTSU9OID0gXCJ2MVwiO1xuLyoqXG4gKiBXZSBjYW4ndCBgcmVxdWlyZWAgcGFja2FnZS5qc29uIGlmIHRoaXMgcnVucyBvbiB3ZWIuIFdlIHdpbGwgdXNlIHJvbGx1cCB0b1xuICogc3dhcCBpbiB0aGUgdmVyc2lvbiBudW1iZXIgaGVyZSBhdCBidWlsZCB0aW1lLlxuICovXG5jb25zdCBQQUNLQUdFX1ZFUlNJT04gPSBcIjAuMS4zXCI7XG5jb25zdCBQQUNLQUdFX0xPR19IRUFERVIgPSBcImdlbmFpLWpzXCI7XG52YXIgVGFzaztcbihmdW5jdGlvbiAoVGFzaykge1xuICAgIFRhc2tbXCJHRU5FUkFURV9DT05URU5UXCJdID0gXCJnZW5lcmF0ZUNvbnRlbnRcIjtcbiAgICBUYXNrW1wiU1RSRUFNX0dFTkVSQVRFX0NPTlRFTlRcIl0gPSBcInN0cmVhbUdlbmVyYXRlQ29udGVudFwiO1xuICAgIFRhc2tbXCJDT1VOVF9UT0tFTlNcIl0gPSBcImNvdW50VG9rZW5zXCI7XG4gICAgVGFza1tcIkVNQkVEX0NPTlRFTlRcIl0gPSBcImVtYmVkQ29udGVudFwiO1xuICAgIFRhc2tbXCJCQVRDSF9FTUJFRF9DT05URU5UU1wiXSA9IFwiYmF0Y2hFbWJlZENvbnRlbnRzXCI7XG59KShUYXNrIHx8IChUYXNrID0ge30pKTtcbmNsYXNzIFJlcXVlc3RVcmwge1xuICAgIGNvbnN0cnVjdG9yKG1vZGVsLCB0YXNrLCBhcGlLZXksIHN0cmVhbSkge1xuICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWw7XG4gICAgICAgIHRoaXMudGFzayA9IHRhc2s7XG4gICAgICAgIHRoaXMuYXBpS2V5ID0gYXBpS2V5O1xuICAgICAgICB0aGlzLnN0cmVhbSA9IHN0cmVhbTtcbiAgICB9XG4gICAgdG9TdHJpbmcoKSB7XG4gICAgICAgIGxldCB1cmwgPSBgJHtCQVNFX1VSTH0vJHtBUElfVkVSU0lPTn0vbW9kZWxzLyR7dGhpcy5tb2RlbH06JHt0aGlzLnRhc2t9YDtcbiAgICAgICAgaWYgKHRoaXMuc3RyZWFtKSB7XG4gICAgICAgICAgICB1cmwgKz0gXCI/YWx0PXNzZVwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1cmw7XG4gICAgfVxufVxuLyoqXG4gKiBTaW1wbGUsIGJ1dCBtYXkgYmVjb21lIG1vcmUgY29tcGxleCBpZiB3ZSBhZGQgbW9yZSB2ZXJzaW9ucyB0byBsb2cuXG4gKi9cbmZ1bmN0aW9uIGdldENsaWVudEhlYWRlcnMoKSB7XG4gICAgcmV0dXJuIGAke1BBQ0tBR0VfTE9HX0hFQURFUn0vJHtQQUNLQUdFX1ZFUlNJT059YDtcbn1cbmFzeW5jIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KHVybCwgYm9keSkge1xuICAgIGxldCByZXNwb25zZTtcbiAgICB0cnkge1xuICAgICAgICByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybC50b1N0cmluZygpLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICAgICAgICAgIFwieC1nb29nLWFwaS1jbGllbnRcIjogZ2V0Q2xpZW50SGVhZGVycygpLFxuICAgICAgICAgICAgICAgIFwieC1nb29nLWFwaS1rZXlcIjogdXJsLmFwaUtleSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBib2R5LFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgbGV0IG1lc3NhZ2UgPSBcIlwiO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBqc29uLmVycm9yLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgaWYgKGpzb24uZXJyb3IuZGV0YWlscykge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlICs9IGAgJHtKU09OLnN0cmluZ2lmeShqc29uLmVycm9yLmRldGFpbHMpfWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBpZ25vcmVkXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFske3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fV0gJHttZXNzYWdlfWApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnN0IGVyciA9IG5ldyBHb29nbGVHZW5lcmF0aXZlQUlFcnJvcihgRXJyb3IgZmV0Y2hpbmcgZnJvbSAke3VybC50b1N0cmluZygpfTogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgIGVyci5zdGFjayA9IGUuc3RhY2s7XG4gICAgICAgIHRocm93IGVycjtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3BvbnNlO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBZGRzIGNvbnZlbmllbmNlIGhlbHBlciBtZXRob2RzIHRvIGEgcmVzcG9uc2Ugb2JqZWN0LCBpbmNsdWRpbmcgc3RyZWFtXG4gKiBjaHVua3MgKGFzIGxvbmcgYXMgZWFjaCBjaHVuayBpcyBhIGNvbXBsZXRlIEdlbmVyYXRlQ29udGVudFJlc3BvbnNlIEpTT04pLlxuICovXG5mdW5jdGlvbiBhZGRIZWxwZXJzKHJlc3BvbnNlKSB7XG4gICAgcmVzcG9uc2UudGV4dCA9ICgpID0+IHtcbiAgICAgICAgaWYgKHJlc3BvbnNlLmNhbmRpZGF0ZXMgJiYgcmVzcG9uc2UuY2FuZGlkYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBpZiAocmVzcG9uc2UuY2FuZGlkYXRlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBUaGlzIHJlc3BvbnNlIGhhZCAke3Jlc3BvbnNlLmNhbmRpZGF0ZXMubGVuZ3RofSBgICtcbiAgICAgICAgICAgICAgICAgICAgYGNhbmRpZGF0ZXMuIFJldHVybmluZyB0ZXh0IGZyb20gdGhlIGZpcnN0IGNhbmRpZGF0ZSBvbmx5LiBgICtcbiAgICAgICAgICAgICAgICAgICAgYEFjY2VzcyByZXNwb25zZS5jYW5kaWRhdGVzIGRpcmVjdGx5IHRvIHVzZSB0aGUgb3RoZXIgY2FuZGlkYXRlcy5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChoYWRCYWRGaW5pc2hSZWFzb24ocmVzcG9uc2UuY2FuZGlkYXRlc1swXSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJUmVzcG9uc2VFcnJvcihgJHtmb3JtYXRCbG9ja0Vycm9yTWVzc2FnZShyZXNwb25zZSl9YCwgcmVzcG9uc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGdldFRleHQocmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHJlc3BvbnNlLnByb21wdEZlZWRiYWNrKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJUmVzcG9uc2VFcnJvcihgVGV4dCBub3QgYXZhaWxhYmxlLiAke2Zvcm1hdEJsb2NrRXJyb3JNZXNzYWdlKHJlc3BvbnNlKX1gLCByZXNwb25zZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfTtcbiAgICByZXR1cm4gcmVzcG9uc2U7XG59XG4vKipcbiAqIFJldHVybnMgdGV4dCBvZiBmaXJzdCBjYW5kaWRhdGUuXG4gKi9cbmZ1bmN0aW9uIGdldFRleHQocmVzcG9uc2UpIHtcbiAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgaWYgKChfZCA9IChfYyA9IChfYiA9IChfYSA9IHJlc3BvbnNlLmNhbmRpZGF0ZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYVswXS5jb250ZW50KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IucGFydHMpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY1swXSkgPT09IG51bGwgfHwgX2QgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9kLnRleHQpIHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmNhbmRpZGF0ZXNbMF0uY29udGVudC5wYXJ0c1swXS50ZXh0O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgfVxufVxuY29uc3QgYmFkRmluaXNoUmVhc29ucyA9IFtGaW5pc2hSZWFzb24uUkVDSVRBVElPTiwgRmluaXNoUmVhc29uLlNBRkVUWV07XG5mdW5jdGlvbiBoYWRCYWRGaW5pc2hSZWFzb24oY2FuZGlkYXRlKSB7XG4gICAgcmV0dXJuICghIWNhbmRpZGF0ZS5maW5pc2hSZWFzb24gJiZcbiAgICAgICAgYmFkRmluaXNoUmVhc29ucy5pbmNsdWRlcyhjYW5kaWRhdGUuZmluaXNoUmVhc29uKSk7XG59XG5mdW5jdGlvbiBmb3JtYXRCbG9ja0Vycm9yTWVzc2FnZShyZXNwb25zZSkge1xuICAgIHZhciBfYSwgX2IsIF9jO1xuICAgIGxldCBtZXNzYWdlID0gXCJcIjtcbiAgICBpZiAoKCFyZXNwb25zZS5jYW5kaWRhdGVzIHx8IHJlc3BvbnNlLmNhbmRpZGF0ZXMubGVuZ3RoID09PSAwKSAmJlxuICAgICAgICByZXNwb25zZS5wcm9tcHRGZWVkYmFjaykge1xuICAgICAgICBtZXNzYWdlICs9IFwiUmVzcG9uc2Ugd2FzIGJsb2NrZWRcIjtcbiAgICAgICAgaWYgKChfYSA9IHJlc3BvbnNlLnByb21wdEZlZWRiYWNrKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuYmxvY2tSZWFzb24pIHtcbiAgICAgICAgICAgIG1lc3NhZ2UgKz0gYCBkdWUgdG8gJHtyZXNwb25zZS5wcm9tcHRGZWVkYmFjay5ibG9ja1JlYXNvbn1gO1xuICAgICAgICB9XG4gICAgICAgIGlmICgoX2IgPSByZXNwb25zZS5wcm9tcHRGZWVkYmFjaykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmJsb2NrUmVhc29uTWVzc2FnZSkge1xuICAgICAgICAgICAgbWVzc2FnZSArPSBgOiAke3Jlc3BvbnNlLnByb21wdEZlZWRiYWNrLmJsb2NrUmVhc29uTWVzc2FnZX1gO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKChfYyA9IHJlc3BvbnNlLmNhbmRpZGF0ZXMpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY1swXSkge1xuICAgICAgICBjb25zdCBmaXJzdENhbmRpZGF0ZSA9IHJlc3BvbnNlLmNhbmRpZGF0ZXNbMF07XG4gICAgICAgIGlmIChoYWRCYWRGaW5pc2hSZWFzb24oZmlyc3RDYW5kaWRhdGUpKSB7XG4gICAgICAgICAgICBtZXNzYWdlICs9IGBDYW5kaWRhdGUgd2FzIGJsb2NrZWQgZHVlIHRvICR7Zmlyc3RDYW5kaWRhdGUuZmluaXNoUmVhc29ufWA7XG4gICAgICAgICAgICBpZiAoZmlyc3RDYW5kaWRhdGUuZmluaXNoTWVzc2FnZSkge1xuICAgICAgICAgICAgICAgIG1lc3NhZ2UgKz0gYDogJHtmaXJzdENhbmRpZGF0ZS5maW5pc2hNZXNzYWdlfWA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1lc3NhZ2U7XG59XG5cbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uXHJcblxyXG5QZXJtaXNzaW9uIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBhbmQvb3IgZGlzdHJpYnV0ZSB0aGlzIHNvZnR3YXJlIGZvciBhbnlcclxucHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLlxyXG5cclxuVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiBBTkQgVEhFIEFVVEhPUiBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSFxyXG5SRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFlcclxuQU5EIEZJVE5FU1MuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1IgQkUgTElBQkxFIEZPUiBBTlkgU1BFQ0lBTCwgRElSRUNULFxyXG5JTkRJUkVDVCwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST01cclxuTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1JcclxuT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5HIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUlxyXG5QRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSwgU3VwcHJlc3NlZEVycm9yLCBTeW1ib2wgKi9cclxuXHJcblxyXG5mdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBfX2FzeW5jR2VuZXJhdG9yKHRoaXNBcmcsIF9hcmd1bWVudHMsIGdlbmVyYXRvcikge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBnID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pLCBpLCBxID0gW107XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIpLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXM7IH0sIGk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaWYgKGdbbl0pIGlbbl0gPSBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKGEsIGIpIHsgcS5wdXNoKFtuLCB2LCBhLCBiXSkgPiAxIHx8IHJlc3VtZShuLCB2KTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHJlc3VtZShuLCB2KSB7IHRyeSB7IHN0ZXAoZ1tuXSh2KSk7IH0gY2F0Y2ggKGUpIHsgc2V0dGxlKHFbMF1bM10sIGUpOyB9IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAocikgeyByLnZhbHVlIGluc3RhbmNlb2YgX19hd2FpdCA/IFByb21pc2UucmVzb2x2ZShyLnZhbHVlLnYpLnRoZW4oZnVsZmlsbCwgcmVqZWN0KSA6IHNldHRsZShxWzBdWzJdLCByKTsgfVxyXG4gICAgZnVuY3Rpb24gZnVsZmlsbCh2YWx1ZSkgeyByZXN1bWUoXCJuZXh0XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gcmVqZWN0KHZhbHVlKSB7IHJlc3VtZShcInRocm93XCIsIHZhbHVlKTsgfVxyXG4gICAgZnVuY3Rpb24gc2V0dGxlKGYsIHYpIHsgaWYgKGYodiksIHEuc2hpZnQoKSwgcS5sZW5ndGgpIHJlc3VtZShxWzBdWzBdLCBxWzBdWzFdKTsgfVxyXG59XHJcblxyXG50eXBlb2YgU3VwcHJlc3NlZEVycm9yID09PSBcImZ1bmN0aW9uXCIgPyBTdXBwcmVzc2VkRXJyb3IgOiBmdW5jdGlvbiAoZXJyb3IsIHN1cHByZXNzZWQsIG1lc3NhZ2UpIHtcclxuICAgIHZhciBlID0gbmV3IEVycm9yKG1lc3NhZ2UpO1xyXG4gICAgcmV0dXJuIGUubmFtZSA9IFwiU3VwcHJlc3NlZEVycm9yXCIsIGUuZXJyb3IgPSBlcnJvciwgZS5zdXBwcmVzc2VkID0gc3VwcHJlc3NlZCwgZTtcclxufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IHJlc3BvbnNlTGluZVJFID0gL15kYXRhXFw6ICguKikoPzpcXG5cXG58XFxyXFxyfFxcclxcblxcclxcbikvO1xuLyoqXG4gKiBQcm9jZXNzIGEgcmVzcG9uc2UuYm9keSBzdHJlYW0gZnJvbSB0aGUgYmFja2VuZCBhbmQgcmV0dXJuIGFuXG4gKiBpdGVyYXRvciB0aGF0IHByb3ZpZGVzIG9uZSBjb21wbGV0ZSBHZW5lcmF0ZUNvbnRlbnRSZXNwb25zZSBhdCBhIHRpbWVcbiAqIGFuZCBhIHByb21pc2UgdGhhdCByZXNvbHZlcyB3aXRoIGEgc2luZ2xlIGFnZ3JlZ2F0ZWRcbiAqIEdlbmVyYXRlQ29udGVudFJlc3BvbnNlLlxuICpcbiAqIEBwYXJhbSByZXNwb25zZSAtIFJlc3BvbnNlIGZyb20gYSBmZXRjaCBjYWxsXG4gKi9cbmZ1bmN0aW9uIHByb2Nlc3NTdHJlYW0ocmVzcG9uc2UpIHtcbiAgICBjb25zdCBpbnB1dFN0cmVhbSA9IHJlc3BvbnNlLmJvZHkucGlwZVRocm91Z2gobmV3IFRleHREZWNvZGVyU3RyZWFtKFwidXRmOFwiLCB7IGZhdGFsOiB0cnVlIH0pKTtcbiAgICBjb25zdCByZXNwb25zZVN0cmVhbSA9IGdldFJlc3BvbnNlU3RyZWFtKGlucHV0U3RyZWFtKTtcbiAgICBjb25zdCBbc3RyZWFtMSwgc3RyZWFtMl0gPSByZXNwb25zZVN0cmVhbS50ZWUoKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzdHJlYW06IGdlbmVyYXRlUmVzcG9uc2VTZXF1ZW5jZShzdHJlYW0xKSxcbiAgICAgICAgcmVzcG9uc2U6IGdldFJlc3BvbnNlUHJvbWlzZShzdHJlYW0yKSxcbiAgICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0UmVzcG9uc2VQcm9taXNlKHN0cmVhbSkge1xuICAgIGNvbnN0IGFsbFJlc3BvbnNlcyA9IFtdO1xuICAgIGNvbnN0IHJlYWRlciA9IHN0cmVhbS5nZXRSZWFkZXIoKTtcbiAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICBjb25zdCB7IGRvbmUsIHZhbHVlIH0gPSBhd2FpdCByZWFkZXIucmVhZCgpO1xuICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgcmV0dXJuIGFkZEhlbHBlcnMoYWdncmVnYXRlUmVzcG9uc2VzKGFsbFJlc3BvbnNlcykpO1xuICAgICAgICB9XG4gICAgICAgIGFsbFJlc3BvbnNlcy5wdXNoKHZhbHVlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZW5lcmF0ZVJlc3BvbnNlU2VxdWVuY2Uoc3RyZWFtKSB7XG4gICAgcmV0dXJuIF9fYXN5bmNHZW5lcmF0b3IodGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiogZ2VuZXJhdGVSZXNwb25zZVNlcXVlbmNlXzEoKSB7XG4gICAgICAgIGNvbnN0IHJlYWRlciA9IHN0cmVhbS5nZXRSZWFkZXIoKTtcbiAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgdmFsdWUsIGRvbmUgfSA9IHlpZWxkIF9fYXdhaXQocmVhZGVyLnJlYWQoKSk7XG4gICAgICAgICAgICBpZiAoZG9uZSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeWllbGQgeWllbGQgX19hd2FpdChhZGRIZWxwZXJzKHZhbHVlKSk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbi8qKlxuICogUmVhZHMgYSByYXcgc3RyZWFtIGZyb20gdGhlIGZldGNoIHJlc3BvbnNlIGFuZCBqb2luIGluY29tcGxldGVcbiAqIGNodW5rcywgcmV0dXJuaW5nIGEgbmV3IHN0cmVhbSB0aGF0IHByb3ZpZGVzIGEgc2luZ2xlIGNvbXBsZXRlXG4gKiBHZW5lcmF0ZUNvbnRlbnRSZXNwb25zZSBpbiBlYWNoIGl0ZXJhdGlvbi5cbiAqL1xuZnVuY3Rpb24gZ2V0UmVzcG9uc2VTdHJlYW0oaW5wdXRTdHJlYW0pIHtcbiAgICBjb25zdCByZWFkZXIgPSBpbnB1dFN0cmVhbS5nZXRSZWFkZXIoKTtcbiAgICBjb25zdCBzdHJlYW0gPSBuZXcgUmVhZGFibGVTdHJlYW0oe1xuICAgICAgICBzdGFydChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICBsZXQgY3VycmVudFRleHQgPSBcIlwiO1xuICAgICAgICAgICAgcmV0dXJuIHB1bXAoKTtcbiAgICAgICAgICAgIGZ1bmN0aW9uIHB1bXAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlYWRlci5yZWFkKCkudGhlbigoeyB2YWx1ZSwgZG9uZSB9KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb25lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFRleHQudHJpbSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lcnJvcihuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJRXJyb3IoXCJGYWlsZWQgdG8gcGFyc2Ugc3RyZWFtXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFRleHQgKz0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGxldCBtYXRjaCA9IGN1cnJlbnRUZXh0Lm1hdGNoKHJlc3BvbnNlTGluZVJFKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IHBhcnNlZFJlc3BvbnNlO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VkUmVzcG9uc2UgPSBKU09OLnBhcnNlKG1hdGNoWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lcnJvcihuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJRXJyb3IoYEVycm9yIHBhcnNpbmcgSlNPTiByZXNwb25zZTogXCIke21hdGNoWzFdfVwiYCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShwYXJzZWRSZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGV4dCA9IGN1cnJlbnRUZXh0LnN1YnN0cmluZyhtYXRjaFswXS5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSBjdXJyZW50VGV4dC5tYXRjaChyZXNwb25zZUxpbmVSRSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHB1bXAoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICB9KTtcbiAgICByZXR1cm4gc3RyZWFtO1xufVxuLyoqXG4gKiBBZ2dyZWdhdGVzIGFuIGFycmF5IG9mIGBHZW5lcmF0ZUNvbnRlbnRSZXNwb25zZWBzIGludG8gYSBzaW5nbGVcbiAqIEdlbmVyYXRlQ29udGVudFJlc3BvbnNlLlxuICovXG5mdW5jdGlvbiBhZ2dyZWdhdGVSZXNwb25zZXMocmVzcG9uc2VzKSB7XG4gICAgY29uc3QgbGFzdFJlc3BvbnNlID0gcmVzcG9uc2VzW3Jlc3BvbnNlcy5sZW5ndGggLSAxXTtcbiAgICBjb25zdCBhZ2dyZWdhdGVkUmVzcG9uc2UgPSB7XG4gICAgICAgIHByb21wdEZlZWRiYWNrOiBsYXN0UmVzcG9uc2UgPT09IG51bGwgfHwgbGFzdFJlc3BvbnNlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBsYXN0UmVzcG9uc2UucHJvbXB0RmVlZGJhY2ssXG4gICAgfTtcbiAgICBmb3IgKGNvbnN0IHJlc3BvbnNlIG9mIHJlc3BvbnNlcykge1xuICAgICAgICBpZiAocmVzcG9uc2UuY2FuZGlkYXRlcykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBjYW5kaWRhdGUgb2YgcmVzcG9uc2UuY2FuZGlkYXRlcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBjYW5kaWRhdGUuaW5kZXg7XG4gICAgICAgICAgICAgICAgaWYgKCFhZ2dyZWdhdGVkUmVzcG9uc2UuY2FuZGlkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICBhZ2dyZWdhdGVkUmVzcG9uc2UuY2FuZGlkYXRlcyA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIWFnZ3JlZ2F0ZWRSZXNwb25zZS5jYW5kaWRhdGVzW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZWRSZXNwb25zZS5jYW5kaWRhdGVzW2ldID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXg6IGNhbmRpZGF0ZS5pbmRleCxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gS2VlcCBvdmVyd3JpdGluZywgdGhlIGxhc3Qgb25lIHdpbGwgYmUgZmluYWxcbiAgICAgICAgICAgICAgICBhZ2dyZWdhdGVkUmVzcG9uc2UuY2FuZGlkYXRlc1tpXS5jaXRhdGlvbk1ldGFkYXRhID1cbiAgICAgICAgICAgICAgICAgICAgY2FuZGlkYXRlLmNpdGF0aW9uTWV0YWRhdGE7XG4gICAgICAgICAgICAgICAgYWdncmVnYXRlZFJlc3BvbnNlLmNhbmRpZGF0ZXNbaV0uZmluaXNoUmVhc29uID0gY2FuZGlkYXRlLmZpbmlzaFJlYXNvbjtcbiAgICAgICAgICAgICAgICBhZ2dyZWdhdGVkUmVzcG9uc2UuY2FuZGlkYXRlc1tpXS5maW5pc2hNZXNzYWdlID1cbiAgICAgICAgICAgICAgICAgICAgY2FuZGlkYXRlLmZpbmlzaE1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgYWdncmVnYXRlZFJlc3BvbnNlLmNhbmRpZGF0ZXNbaV0uc2FmZXR5UmF0aW5ncyA9XG4gICAgICAgICAgICAgICAgICAgIGNhbmRpZGF0ZS5zYWZldHlSYXRpbmdzO1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIENhbmRpZGF0ZXMgc2hvdWxkIGFsd2F5cyBoYXZlIGNvbnRlbnQgYW5kIHBhcnRzLCBidXQgdGhpcyBoYW5kbGVzXG4gICAgICAgICAgICAgICAgICogcG9zc2libGUgbWFsZm9ybWVkIHJlc3BvbnNlcy5cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoY2FuZGlkYXRlLmNvbnRlbnQgJiYgY2FuZGlkYXRlLmNvbnRlbnQucGFydHMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFhZ2dyZWdhdGVkUmVzcG9uc2UuY2FuZGlkYXRlc1tpXS5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZ2dyZWdhdGVkUmVzcG9uc2UuY2FuZGlkYXRlc1tpXS5jb250ZW50ID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvbGU6IGNhbmRpZGF0ZS5jb250ZW50LnJvbGUgfHwgXCJ1c2VyXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydHM6IFt7IHRleHQ6IFwiXCIgfV0sXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBjYW5kaWRhdGUuY29udGVudC5wYXJ0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnQudGV4dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFnZ3JlZ2F0ZWRSZXNwb25zZS5jYW5kaWRhdGVzW2ldLmNvbnRlbnQucGFydHNbMF0udGV4dCArPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJ0LnRleHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFnZ3JlZ2F0ZWRSZXNwb25zZTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlQ29udGVudFN0cmVhbShhcGlLZXksIG1vZGVsLCBwYXJhbXMpIHtcbiAgICBjb25zdCB1cmwgPSBuZXcgUmVxdWVzdFVybChtb2RlbCwgVGFzay5TVFJFQU1fR0VORVJBVEVfQ09OVEVOVCwgYXBpS2V5LCBcbiAgICAvKiBzdHJlYW0gKi8gdHJ1ZSk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBtYWtlUmVxdWVzdCh1cmwsIEpTT04uc3RyaW5naWZ5KHBhcmFtcykpO1xuICAgIHJldHVybiBwcm9jZXNzU3RyZWFtKHJlc3BvbnNlKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlQ29udGVudChhcGlLZXksIG1vZGVsLCBwYXJhbXMpIHtcbiAgICBjb25zdCB1cmwgPSBuZXcgUmVxdWVzdFVybChtb2RlbCwgVGFzay5HRU5FUkFURV9DT05URU5ULCBhcGlLZXksIFxuICAgIC8qIHN0cmVhbSAqLyBmYWxzZSk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBtYWtlUmVxdWVzdCh1cmwsIEpTT04uc3RyaW5naWZ5KHBhcmFtcykpO1xuICAgIGNvbnN0IHJlc3BvbnNlSnNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICBjb25zdCBlbmhhbmNlZFJlc3BvbnNlID0gYWRkSGVscGVycyhyZXNwb25zZUpzb24pO1xuICAgIHJldHVybiB7XG4gICAgICAgIHJlc3BvbnNlOiBlbmhhbmNlZFJlc3BvbnNlLFxuICAgIH07XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5mdW5jdGlvbiBmb3JtYXROZXdDb250ZW50KHJlcXVlc3QsIHJvbGUpIHtcbiAgICBsZXQgbmV3UGFydHMgPSBbXTtcbiAgICBpZiAodHlwZW9mIHJlcXVlc3QgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgbmV3UGFydHMgPSBbeyB0ZXh0OiByZXF1ZXN0IH1dO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZm9yIChjb25zdCBwYXJ0T3JTdHJpbmcgb2YgcmVxdWVzdCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXJ0T3JTdHJpbmcgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICBuZXdQYXJ0cy5wdXNoKHsgdGV4dDogcGFydE9yU3RyaW5nIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3UGFydHMucHVzaChwYXJ0T3JTdHJpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7IHJvbGUsIHBhcnRzOiBuZXdQYXJ0cyB9O1xufVxuZnVuY3Rpb24gZm9ybWF0R2VuZXJhdGVDb250ZW50SW5wdXQocGFyYW1zKSB7XG4gICAgaWYgKHBhcmFtcy5jb250ZW50cykge1xuICAgICAgICByZXR1cm4gcGFyYW1zO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGZvcm1hdE5ld0NvbnRlbnQocGFyYW1zLCBcInVzZXJcIik7XG4gICAgICAgIHJldHVybiB7IGNvbnRlbnRzOiBbY29udGVudF0gfTtcbiAgICB9XG59XG5mdW5jdGlvbiBmb3JtYXRFbWJlZENvbnRlbnRJbnB1dChwYXJhbXMpIHtcbiAgICBpZiAodHlwZW9mIHBhcmFtcyA9PT0gXCJzdHJpbmdcIiB8fCBBcnJheS5pc0FycmF5KHBhcmFtcykpIHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGZvcm1hdE5ld0NvbnRlbnQocGFyYW1zLCBcInVzZXJcIik7XG4gICAgICAgIHJldHVybiB7IGNvbnRlbnQgfTtcbiAgICB9XG4gICAgcmV0dXJuIHBhcmFtcztcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRG8gbm90IGxvZyBhIG1lc3NhZ2UgZm9yIHRoaXMgZXJyb3IuXG4gKi9cbmNvbnN0IFNJTEVOVF9FUlJPUiA9IFwiU0lMRU5UX0VSUk9SXCI7XG4vKipcbiAqIENoYXRTZXNzaW9uIGNsYXNzIHRoYXQgZW5hYmxlcyBzZW5kaW5nIGNoYXQgbWVzc2FnZXMgYW5kIHN0b3Jlc1xuICogaGlzdG9yeSBvZiBzZW50IGFuZCByZWNlaXZlZCBtZXNzYWdlcyBzbyBmYXIuXG4gKlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBDaGF0U2Vzc2lvbiB7XG4gICAgY29uc3RydWN0b3IoYXBpS2V5LCBtb2RlbCwgcGFyYW1zKSB7XG4gICAgICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcbiAgICAgICAgdGhpcy5wYXJhbXMgPSBwYXJhbXM7XG4gICAgICAgIHRoaXMuX2hpc3RvcnkgPSBbXTtcbiAgICAgICAgdGhpcy5fc2VuZFByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgdGhpcy5fYXBpS2V5ID0gYXBpS2V5O1xuICAgICAgICBpZiAocGFyYW1zID09PSBudWxsIHx8IHBhcmFtcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogcGFyYW1zLmhpc3RvcnkpIHtcbiAgICAgICAgICAgIHRoaXMuX2hpc3RvcnkgPSBwYXJhbXMuaGlzdG9yeS5tYXAoKGNvbnRlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQucm9sZSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNaXNzaW5nIHJvbGUgZm9yIGhpc3RvcnkgaXRlbTogXCIgKyBKU09OLnN0cmluZ2lmeShjb250ZW50KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBmb3JtYXROZXdDb250ZW50KGNvbnRlbnQucGFydHMsIGNvbnRlbnQucm9sZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBjaGF0IGhpc3Rvcnkgc28gZmFyLiBCbG9ja2VkIHByb21wdHMgYXJlIG5vdCBhZGRlZCB0byBoaXN0b3J5LlxuICAgICAqIEJsb2NrZWQgY2FuZGlkYXRlcyBhcmUgbm90IGFkZGVkIHRvIGhpc3RvcnksIG5vciBhcmUgdGhlIHByb21wdHMgdGhhdFxuICAgICAqIGdlbmVyYXRlZCB0aGVtLlxuICAgICAqL1xuICAgIGFzeW5jIGdldEhpc3RvcnkoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuX3NlbmRQcm9taXNlO1xuICAgICAgICByZXR1cm4gdGhpcy5faGlzdG9yeTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYSBjaGF0IG1lc3NhZ2UgYW5kIHJlY2VpdmVzIGEgbm9uLXN0cmVhbWluZ1xuICAgICAqIHtAbGluayBHZW5lcmF0ZUNvbnRlbnRSZXN1bHR9XG4gICAgICovXG4gICAgYXN5bmMgc2VuZE1lc3NhZ2UocmVxdWVzdCkge1xuICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICBhd2FpdCB0aGlzLl9zZW5kUHJvbWlzZTtcbiAgICAgICAgY29uc3QgbmV3Q29udGVudCA9IGZvcm1hdE5ld0NvbnRlbnQocmVxdWVzdCwgXCJ1c2VyXCIpO1xuICAgICAgICBjb25zdCBnZW5lcmF0ZUNvbnRlbnRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgc2FmZXR5U2V0dGluZ3M6IChfYSA9IHRoaXMucGFyYW1zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc2FmZXR5U2V0dGluZ3MsXG4gICAgICAgICAgICBnZW5lcmF0aW9uQ29uZmlnOiAoX2IgPSB0aGlzLnBhcmFtcykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmdlbmVyYXRpb25Db25maWcsXG4gICAgICAgICAgICBjb250ZW50czogWy4uLnRoaXMuX2hpc3RvcnksIG5ld0NvbnRlbnRdLFxuICAgICAgICB9O1xuICAgICAgICBsZXQgZmluYWxSZXN1bHQ7XG4gICAgICAgIC8vIEFkZCBvbnRvIHRoZSBjaGFpbi5cbiAgICAgICAgdGhpcy5fc2VuZFByb21pc2UgPSB0aGlzLl9zZW5kUHJvbWlzZVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4gZ2VuZXJhdGVDb250ZW50KHRoaXMuX2FwaUtleSwgdGhpcy5tb2RlbCwgZ2VuZXJhdGVDb250ZW50UmVxdWVzdCkpXG4gICAgICAgICAgICAudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgICAgICB2YXIgX2E7XG4gICAgICAgICAgICBpZiAocmVzdWx0LnJlc3BvbnNlLmNhbmRpZGF0ZXMgJiZcbiAgICAgICAgICAgICAgICByZXN1bHQucmVzcG9uc2UuY2FuZGlkYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGlzdG9yeS5wdXNoKG5ld0NvbnRlbnQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlQ29udGVudCA9IE9iamVjdC5hc3NpZ24oeyBwYXJ0czogW10sIFxuICAgICAgICAgICAgICAgICAgICAvLyBSZXNwb25zZSBzZWVtcyB0byBjb21lIGJhY2sgd2l0aG91dCBhIHJvbGUgc2V0LlxuICAgICAgICAgICAgICAgICAgICByb2xlOiBcIm1vZGVsXCIgfSwgKF9hID0gcmVzdWx0LnJlc3BvbnNlLmNhbmRpZGF0ZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYVswXS5jb250ZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9oaXN0b3J5LnB1c2gocmVzcG9uc2VDb250ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJsb2NrRXJyb3JNZXNzYWdlID0gZm9ybWF0QmxvY2tFcnJvck1lc3NhZ2UocmVzdWx0LnJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBpZiAoYmxvY2tFcnJvck1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBzZW5kTWVzc2FnZSgpIHdhcyB1bnN1Y2Nlc3NmdWwuICR7YmxvY2tFcnJvck1lc3NhZ2V9LiBJbnNwZWN0IHJlc3BvbnNlIG9iamVjdCBmb3IgZGV0YWlscy5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5hbFJlc3VsdCA9IHJlc3VsdDtcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IHRoaXMuX3NlbmRQcm9taXNlO1xuICAgICAgICByZXR1cm4gZmluYWxSZXN1bHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbmRzIGEgY2hhdCBtZXNzYWdlIGFuZCByZWNlaXZlcyB0aGUgcmVzcG9uc2UgYXMgYVxuICAgICAqIHtAbGluayBHZW5lcmF0ZUNvbnRlbnRTdHJlYW1SZXN1bHR9IGNvbnRhaW5pbmcgYW4gaXRlcmFibGUgc3RyZWFtXG4gICAgICogYW5kIGEgcmVzcG9uc2UgcHJvbWlzZS5cbiAgICAgKi9cbiAgICBhc3luYyBzZW5kTWVzc2FnZVN0cmVhbShyZXF1ZXN0KSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIGF3YWl0IHRoaXMuX3NlbmRQcm9taXNlO1xuICAgICAgICBjb25zdCBuZXdDb250ZW50ID0gZm9ybWF0TmV3Q29udGVudChyZXF1ZXN0LCBcInVzZXJcIik7XG4gICAgICAgIGNvbnN0IGdlbmVyYXRlQ29udGVudFJlcXVlc3QgPSB7XG4gICAgICAgICAgICBzYWZldHlTZXR0aW5nczogKF9hID0gdGhpcy5wYXJhbXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zYWZldHlTZXR0aW5ncyxcbiAgICAgICAgICAgIGdlbmVyYXRpb25Db25maWc6IChfYiA9IHRoaXMucGFyYW1zKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZ2VuZXJhdGlvbkNvbmZpZyxcbiAgICAgICAgICAgIGNvbnRlbnRzOiBbLi4udGhpcy5faGlzdG9yeSwgbmV3Q29udGVudF0sXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHN0cmVhbVByb21pc2UgPSBnZW5lcmF0ZUNvbnRlbnRTdHJlYW0odGhpcy5fYXBpS2V5LCB0aGlzLm1vZGVsLCBnZW5lcmF0ZUNvbnRlbnRSZXF1ZXN0KTtcbiAgICAgICAgLy8gQWRkIG9udG8gdGhlIGNoYWluLlxuICAgICAgICB0aGlzLl9zZW5kUHJvbWlzZSA9IHRoaXMuX3NlbmRQcm9taXNlXG4gICAgICAgICAgICAudGhlbigoKSA9PiBzdHJlYW1Qcm9taXNlKVxuICAgICAgICAgICAgLy8gVGhpcyBtdXN0IGJlIGhhbmRsZWQgdG8gYXZvaWQgdW5oYW5kbGVkIHJlamVjdGlvbiwgYnV0IGp1bXBcbiAgICAgICAgICAgIC8vIHRvIHRoZSBmaW5hbCBjYXRjaCBibG9jayB3aXRoIGEgbGFiZWwgdG8gbm90IGxvZyB0aGlzIGVycm9yLlxuICAgICAgICAgICAgLmNhdGNoKChfaWdub3JlZCkgPT4ge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFNJTEVOVF9FUlJPUik7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbigoc3RyZWFtUmVzdWx0KSA9PiBzdHJlYW1SZXN1bHQucmVzcG9uc2UpXG4gICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5jYW5kaWRhdGVzICYmIHJlc3BvbnNlLmNhbmRpZGF0ZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2hpc3RvcnkucHVzaChuZXdDb250ZW50KTtcbiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZUNvbnRlbnQgPSBPYmplY3QuYXNzaWduKHt9LCByZXNwb25zZS5jYW5kaWRhdGVzWzBdLmNvbnRlbnQpO1xuICAgICAgICAgICAgICAgIC8vIFJlc3BvbnNlIHNlZW1zIHRvIGNvbWUgYmFjayB3aXRob3V0IGEgcm9sZSBzZXQuXG4gICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZUNvbnRlbnQucm9sZSkge1xuICAgICAgICAgICAgICAgICAgICByZXNwb25zZUNvbnRlbnQucm9sZSA9IFwibW9kZWxcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5faGlzdG9yeS5wdXNoKHJlc3BvbnNlQ29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBibG9ja0Vycm9yTWVzc2FnZSA9IGZvcm1hdEJsb2NrRXJyb3JNZXNzYWdlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBpZiAoYmxvY2tFcnJvck1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBzZW5kTWVzc2FnZVN0cmVhbSgpIHdhcyB1bnN1Y2Nlc3NmdWwuICR7YmxvY2tFcnJvck1lc3NhZ2V9LiBJbnNwZWN0IHJlc3BvbnNlIG9iamVjdCBmb3IgZGV0YWlscy5gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgICAgIC8vIEVycm9ycyBpbiBzdHJlYW1Qcm9taXNlIGFyZSBhbHJlYWR5IGNhdGNoYWJsZSBieSB0aGUgdXNlciBhc1xuICAgICAgICAgICAgLy8gc3RyZWFtUHJvbWlzZSBpcyByZXR1cm5lZC5cbiAgICAgICAgICAgIC8vIEF2b2lkIGR1cGxpY2F0aW5nIHRoZSBlcnJvciBtZXNzYWdlIGluIGxvZ3MuXG4gICAgICAgICAgICBpZiAoZS5tZXNzYWdlICE9PSBTSUxFTlRfRVJST1IpIHtcbiAgICAgICAgICAgICAgICAvLyBVc2VycyBkbyBub3QgaGF2ZSBhY2Nlc3MgdG8gX3NlbmRQcm9taXNlIHRvIGNhdGNoIGVycm9yc1xuICAgICAgICAgICAgICAgIC8vIGRvd25zdHJlYW0gZnJvbSBzdHJlYW1Qcm9taXNlLCBzbyB0aGV5IHNob3VsZCBub3QgdGhyb3cuXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzdHJlYW1Qcm9taXNlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNvdW50VG9rZW5zKGFwaUtleSwgbW9kZWwsIHBhcmFtcykge1xuICAgIGNvbnN0IHVybCA9IG5ldyBSZXF1ZXN0VXJsKG1vZGVsLCBUYXNrLkNPVU5UX1RPS0VOUywgYXBpS2V5LCBmYWxzZSk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBtYWtlUmVxdWVzdCh1cmwsIEpTT04uc3RyaW5naWZ5KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgcGFyYW1zKSwgeyBtb2RlbCB9KSkpO1xuICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBlbWJlZENvbnRlbnQoYXBpS2V5LCBtb2RlbCwgcGFyYW1zKSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFJlcXVlc3RVcmwobW9kZWwsIFRhc2suRU1CRURfQ09OVEVOVCwgYXBpS2V5LCBmYWxzZSk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBtYWtlUmVxdWVzdCh1cmwsIEpTT04uc3RyaW5naWZ5KHBhcmFtcykpO1xuICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG59XG5hc3luYyBmdW5jdGlvbiBiYXRjaEVtYmVkQ29udGVudHMoYXBpS2V5LCBtb2RlbCwgcGFyYW1zKSB7XG4gICAgY29uc3QgdXJsID0gbmV3IFJlcXVlc3RVcmwobW9kZWwsIFRhc2suQkFUQ0hfRU1CRURfQ09OVEVOVFMsIGFwaUtleSwgZmFsc2UpO1xuICAgIGNvbnN0IHJlcXVlc3RzV2l0aE1vZGVsID0gcGFyYW1zLnJlcXVlc3RzLm1hcCgocmVxdWVzdCkgPT4ge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCByZXF1ZXN0KSwgeyBtb2RlbDogYG1vZGVscy8ke21vZGVsfWAgfSk7XG4gICAgfSk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBtYWtlUmVxdWVzdCh1cmwsIEpTT04uc3RyaW5naWZ5KHsgcmVxdWVzdHM6IHJlcXVlc3RzV2l0aE1vZGVsIH0pKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDbGFzcyBmb3IgZ2VuZXJhdGl2ZSBtb2RlbCBBUElzLlxuICogQHB1YmxpY1xuICovXG5jbGFzcyBHZW5lcmF0aXZlTW9kZWwge1xuICAgIGNvbnN0cnVjdG9yKGFwaUtleSwgbW9kZWxQYXJhbXMpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICB0aGlzLmFwaUtleSA9IGFwaUtleTtcbiAgICAgICAgaWYgKG1vZGVsUGFyYW1zLm1vZGVsLnN0YXJ0c1dpdGgoXCJtb2RlbHMvXCIpKSB7XG4gICAgICAgICAgICB0aGlzLm1vZGVsID0gKF9hID0gbW9kZWxQYXJhbXMubW9kZWwuc3BsaXQoXCJtb2RlbHMvXCIpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2FbMV07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWxQYXJhbXMubW9kZWw7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5nZW5lcmF0aW9uQ29uZmlnID0gbW9kZWxQYXJhbXMuZ2VuZXJhdGlvbkNvbmZpZyB8fCB7fTtcbiAgICAgICAgdGhpcy5zYWZldHlTZXR0aW5ncyA9IG1vZGVsUGFyYW1zLnNhZmV0eVNldHRpbmdzIHx8IFtdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNYWtlcyBhIHNpbmdsZSBub24tc3RyZWFtaW5nIGNhbGwgdG8gdGhlIG1vZGVsXG4gICAgICogYW5kIHJldHVybnMgYW4gb2JqZWN0IGNvbnRhaW5pbmcgYSBzaW5nbGUge0BsaW5rIEdlbmVyYXRlQ29udGVudFJlc3BvbnNlfS5cbiAgICAgKi9cbiAgICBhc3luYyBnZW5lcmF0ZUNvbnRlbnQocmVxdWVzdCkge1xuICAgICAgICBjb25zdCBmb3JtYXR0ZWRQYXJhbXMgPSBmb3JtYXRHZW5lcmF0ZUNvbnRlbnRJbnB1dChyZXF1ZXN0KTtcbiAgICAgICAgcmV0dXJuIGdlbmVyYXRlQ29udGVudCh0aGlzLmFwaUtleSwgdGhpcy5tb2RlbCwgT2JqZWN0LmFzc2lnbih7IGdlbmVyYXRpb25Db25maWc6IHRoaXMuZ2VuZXJhdGlvbkNvbmZpZywgc2FmZXR5U2V0dGluZ3M6IHRoaXMuc2FmZXR5U2V0dGluZ3MgfSwgZm9ybWF0dGVkUGFyYW1zKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1ha2VzIGEgc2luZ2xlIHN0cmVhbWluZyBjYWxsIHRvIHRoZSBtb2RlbFxuICAgICAqIGFuZCByZXR1cm5zIGFuIG9iamVjdCBjb250YWluaW5nIGFuIGl0ZXJhYmxlIHN0cmVhbSB0aGF0IGl0ZXJhdGVzXG4gICAgICogb3ZlciBhbGwgY2h1bmtzIGluIHRoZSBzdHJlYW1pbmcgcmVzcG9uc2UgYXMgd2VsbCBhc1xuICAgICAqIGEgcHJvbWlzZSB0aGF0IHJldHVybnMgdGhlIGZpbmFsIGFnZ3JlZ2F0ZWQgcmVzcG9uc2UuXG4gICAgICovXG4gICAgYXN5bmMgZ2VuZXJhdGVDb250ZW50U3RyZWFtKHJlcXVlc3QpIHtcbiAgICAgICAgY29uc3QgZm9ybWF0dGVkUGFyYW1zID0gZm9ybWF0R2VuZXJhdGVDb250ZW50SW5wdXQocmVxdWVzdCk7XG4gICAgICAgIHJldHVybiBnZW5lcmF0ZUNvbnRlbnRTdHJlYW0odGhpcy5hcGlLZXksIHRoaXMubW9kZWwsIE9iamVjdC5hc3NpZ24oeyBnZW5lcmF0aW9uQ29uZmlnOiB0aGlzLmdlbmVyYXRpb25Db25maWcsIHNhZmV0eVNldHRpbmdzOiB0aGlzLnNhZmV0eVNldHRpbmdzIH0sIGZvcm1hdHRlZFBhcmFtcykpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgbmV3IHtAbGluayBDaGF0U2Vzc2lvbn0gaW5zdGFuY2Ugd2hpY2ggY2FuIGJlIHVzZWQgZm9yXG4gICAgICogbXVsdGktdHVybiBjaGF0cy5cbiAgICAgKi9cbiAgICBzdGFydENoYXQoc3RhcnRDaGF0UGFyYW1zKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ2hhdFNlc3Npb24odGhpcy5hcGlLZXksIHRoaXMubW9kZWwsIHN0YXJ0Q2hhdFBhcmFtcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvdW50cyB0aGUgdG9rZW5zIGluIHRoZSBwcm92aWRlZCByZXF1ZXN0LlxuICAgICAqL1xuICAgIGFzeW5jIGNvdW50VG9rZW5zKHJlcXVlc3QpIHtcbiAgICAgICAgY29uc3QgZm9ybWF0dGVkUGFyYW1zID0gZm9ybWF0R2VuZXJhdGVDb250ZW50SW5wdXQocmVxdWVzdCk7XG4gICAgICAgIHJldHVybiBjb3VudFRva2Vucyh0aGlzLmFwaUtleSwgdGhpcy5tb2RlbCwgZm9ybWF0dGVkUGFyYW1zKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW1iZWRzIHRoZSBwcm92aWRlZCBjb250ZW50LlxuICAgICAqL1xuICAgIGFzeW5jIGVtYmVkQ29udGVudChyZXF1ZXN0KSB7XG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZFBhcmFtcyA9IGZvcm1hdEVtYmVkQ29udGVudElucHV0KHJlcXVlc3QpO1xuICAgICAgICByZXR1cm4gZW1iZWRDb250ZW50KHRoaXMuYXBpS2V5LCB0aGlzLm1vZGVsLCBmb3JtYXR0ZWRQYXJhbXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbWJlZHMgYW4gYXJyYXkgb2Yge0BsaW5rIEVtYmVkQ29udGVudFJlcXVlc3R9cy5cbiAgICAgKi9cbiAgICBhc3luYyBiYXRjaEVtYmVkQ29udGVudHMoYmF0Y2hFbWJlZENvbnRlbnRSZXF1ZXN0KSB7XG4gICAgICAgIHJldHVybiBiYXRjaEVtYmVkQ29udGVudHModGhpcy5hcGlLZXksIHRoaXMubW9kZWwsIGJhdGNoRW1iZWRDb250ZW50UmVxdWVzdCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUb3AtbGV2ZWwgY2xhc3MgZm9yIHRoaXMgU0RLXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIEdvb2dsZUdlbmVyYXRpdmVBSSB7XG4gICAgY29uc3RydWN0b3IoYXBpS2V5KSB7XG4gICAgICAgIHRoaXMuYXBpS2V5ID0gYXBpS2V5O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIGEge0BsaW5rIEdlbmVyYXRpdmVNb2RlbH0gaW5zdGFuY2UgZm9yIHRoZSBwcm92aWRlZCBtb2RlbCBuYW1lLlxuICAgICAqL1xuICAgIGdldEdlbmVyYXRpdmVNb2RlbChtb2RlbFBhcmFtcykge1xuICAgICAgICBpZiAoIW1vZGVsUGFyYW1zLm1vZGVsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJRXJyb3IoYE11c3QgcHJvdmlkZSBhIG1vZGVsIG5hbWUuIGAgK1xuICAgICAgICAgICAgICAgIGBFeGFtcGxlOiBnZW5haS5nZXRHZW5lcmF0aXZlTW9kZWwoeyBtb2RlbDogJ215LW1vZGVsLW5hbWUnIH0pYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmF0aXZlTW9kZWwodGhpcy5hcGlLZXksIG1vZGVsUGFyYW1zKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IEJsb2NrUmVhc29uLCBDaGF0U2Vzc2lvbiwgRmluaXNoUmVhc29uLCBHZW5lcmF0aXZlTW9kZWwsIEdvb2dsZUdlbmVyYXRpdmVBSSwgSGFybUJsb2NrVGhyZXNob2xkLCBIYXJtQ2F0ZWdvcnksIEhhcm1Qcm9iYWJpbGl0eSwgVGFza1R5cGUgfTtcbi8v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VyxHQUFHLEtBQUssU0FBUyw4QkFBOEI7QUFDaEUsWUFBTSxLQUFLLElBQUksTUFBTSxPQUFPLFVBQVUsT0FBTztBQUU3QyxVQUFJLEtBQUssU0FBUyxxQkFBcUI7QUFDbkMsWUFBSSx1QkFBTyxtQ0FBbUM7QUFBQSxNQUNsRDtBQUVBLFVBQUksS0FBSyxlQUFlO0FBQ3BCLGFBQUssZ0JBQWdCO0FBQUEsTUFDekI7QUFBQSxJQUNKLFNBQVMsT0FBUDtBQUNFLGNBQVEsTUFBTSw0QkFBNEIsS0FBSztBQUMvQyxVQUFJLEtBQUssU0FBUyxxQkFBcUI7QUFDbkMsWUFBSSx1QkFBTyxxREFBcUQ7QUFBQSxNQUNwRTtBQUVBLFVBQUksS0FBSyxlQUFlO0FBQ3BCLGFBQUssY0FBYyxRQUFRLHVCQUFnQjtBQUFBLE1BQy9DO0FBQUEsSUFDSjtBQUFBLEVBQ0o7QUFBQSxFQUVBLE1BQWMsY0FBc0M7QUFDaEQsUUFBSSxDQUFDLEtBQUssU0FBUztBQUFjLGFBQU87QUFFeEMsUUFBSTtBQUNBLFlBQU0sZUFBZSxLQUFLLElBQUksTUFBTSxzQkFBc0IsS0FBSyxTQUFTLFlBQVk7QUFDcEYsVUFBSSx3QkFBd0IsdUJBQU87QUFDL0IsZUFBTyxNQUFNLEtBQUssSUFBSSxNQUFNLEtBQUssWUFBWTtBQUFBLE1BQ2pEO0FBQUEsSUFDSixTQUFTLE9BQVA7QUFDRSxjQUFRLE1BQU0sNEJBQTRCLEtBQUs7QUFBQSxJQUNuRDtBQUNBLFdBQU87QUFBQSxFQUNYO0FBQ0o7IiwKICAibmFtZXMiOiBbIkhhcm1DYXRlZ29yeSIsICJIYXJtQmxvY2tUaHJlc2hvbGQiLCAiSGFybVByb2JhYmlsaXR5IiwgIkJsb2NrUmVhc29uIiwgIkZpbmlzaFJlYXNvbiIsICJUYXNrVHlwZSIsICJUYXNrIiwgIl9hIl0KfQo=
